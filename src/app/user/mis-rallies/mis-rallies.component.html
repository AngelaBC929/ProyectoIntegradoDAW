<h2>Mis Rallies</h2>
<div *ngFor="let rally of misRallies" class="rally-card">
  <div class="card-body">
    <h5 class="card-title">{{ rally.title }}</h5>

    <!-- Miniaturas de fotos subidas por rally -->
    <ng-container *ngIf="fotosPorRally && fotosPorRally[rally.id] as fotos">
      <div class="miniaturas-container" *ngIf="fotos.length > 0">
        <h6>Mis fotos subidas:</h6>
        <div class="miniaturas">
          <div *ngFor="let foto of fotos" class="foto-preview">
            <img [src]="foto.photo_url" alt="Foto subida" />
            <p>{{ foto.title || 'Sin título' }}</p>
          </div>
        </div>
      </div>
    </ng-container>

    <br />
    <button (click)="openModal(rally)" class="btn btn-primary">Subir Foto</button>
  </div>
</div>

<!-- Modal de carga de fotos -->
<div *ngIf="isModalOpen" class="modal-overlay">
  <div class="modal-content">
    <h5>Subir foto para el rally: {{ rallySeleccionado?.title }}</h5>

    <input type="file" (change)="onFileSelected($event)" />
    <div *ngIf="imagePreview">
      <img [src]="imagePreview" alt="Vista previa" class="preview-img" />
    </div>

    <button (click)="onSubmit()">Subir Foto</button>
    <button (click)="closeModal()">Cerrar</button>
  </div>
</div>

<!-- Botón para volver -->
<div class="button-container">
  <button (click)="goBackToUserPanel()" class="back-button">Volver</button>
</div>
