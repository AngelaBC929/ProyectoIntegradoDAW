<h2 class="mb-4 text-center text-uppercase text-brown">Rallies Actuales</h2>


<ul *ngIf="ralliesActuales.length > 0; else sinRallies">
<li *ngFor="let rally of ralliesActuales" class="card p-4 mb-4 shadow-sm rounded-4 border-0 bg-light">
  <div class="d-flex flex-column flex-md-row align-items-start align-items-md-center gap-3">
    <i [class]="getIconClassByTheme(rally.theme) + ' icono-tema-preview fs-2 text-primary'"></i>

    <div class="flex-grow-1">
      <h3 class="mb-2 text-dark">{{ rally.title }}</h3>
      <p class="mb-1 text-muted">{{ rally.description }}</p>
      <p class="mb-0">
        <strong>Inicio:</strong> {{ rally.start_date | date:'dd/MM/yyyy' }} &nbsp;|&nbsp;
        <strong>Fin:</strong> {{ rally.end_date | date:'dd/MM/yyyy' }}
      </p>
    </div>
  </div>

  <div class="button-wrapper mt-3 text-end">
  <ng-container *ngIf="estaInscrito(rally.id); else noInscrito">
    <button 
      class="btn btn-outline-danger px-4 rounded-pill"
      (click)="alternarInscripcion(rally.id)"
      [disabled]="haCompletadoRally(rally.id)">
      {{ haCompletadoRally(rally.id) ? 'Inscripción completada' : 'Anular Inscripción' }}
    </button>
  </ng-container>

  <ng-template #noInscrito>
    <button 
      class="btn btn-primary px-4 rounded-pill"
      (click)="alternarInscripcion(rally.id)"
      [disabled]="haCompletadoRally(rally.id)">
      {{ haCompletadoRally(rally.id) ? 'Inscripción completada' : 'Inscribirse' }}
    </button>
  </ng-template>
</div>

</li>

</ul>

<ng-template #sinRallies>
  <p>No hay rallies actualmente.</p>
</ng-template>

<div class="button-container text-center mt-4">
  <button (click)="volverAlPanelUsuario()" class="btn btn-secondary px-4 rounded-pill">Volver</button>
</div>
