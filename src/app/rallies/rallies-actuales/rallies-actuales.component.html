<h2>Rallies Actuales</h2>

<ul *ngIf="ralliesActuales.length > 0; else sinRallies">
<li *ngFor="let rally of ralliesActuales" class="card horizontal-card p-3 mb-3">
  <div class="d-flex flex-column flex-md-row align-items-start align-items-md-center gap-3">
    
    <i [class]="getIconClassByTheme(rally.theme) + ' icono-tema-preview'"></i>

    <div class="flex-grow-1">
      <h3>{{ rally.title }}</h3>
      <p>{{ rally.description }}</p>
      <p>
        Inicio: <span>{{ rally.start_date | date:'dd/MM/yyyy' }}</span> - 
        Fin: <span>{{ rally.end_date | date:'dd/MM/yyyy' }}</span>
      </p>
    </div>

  </div>

  <div class="button-wrapper mt-2">
    <ng-container *ngIf="estaInscrito(rally.id); else noInscrito">
      <button 
        class="cancelar-btn btn" 
        (click)="alternarInscripcion(rally.id)"
        [disabled]="haCompletadoRally(rally.id)">
        {{ haCompletadoRally(rally.id) ? 'Inscripción completada' : 'Anular Inscripción' }}
      </button>
    </ng-container>

    <ng-template #noInscrito>
      <button 
        class="apuntarme-btn btn" 
        (click)="alternarInscripcion(rally.id)"
        [disabled]="haCompletadoRally(rally.id)">
        {{ haCompletadoRally(rally.id) ? 'Inscripción completada' : 'Inscribirse' }}
      </button>
    </ng-template>
  </div>
</li>

</ul>

<ng-template #sinRallies>
  <p>No hay rallies actualmente.</p>
</ng-template>

<div class="button-container">
  <button (click)="volverAlPanelUsuario()" class="btn">Volver</button>
</div>
