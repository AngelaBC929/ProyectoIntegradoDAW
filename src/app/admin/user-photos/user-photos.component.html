<div class="photo-list">
  <h2>Fotos de usuarios</h2>
  <table border="1" cellspacing="0" cellpadding="8">
    <thead>
      <tr>
        <th>Foto</th>
        <th>Usuario</th>
        <th>Nombre de la foto</th>  
        <th>Rally</th>
        <th>Estado</th>
        <th>Acciones</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let photo of allPhotos">
        <td><img [src]="photo.photo_url" alt="Foto" width="100" /></td>
        <td>{{ photo.user_name || 'Sin nombre' }}</td>
        <td>{{ photo.title || 'Sin título' }}</td>
        <td>{{ photo.rally_name || 'Sin rally' }}</td>
        <td>{{ photo.status }}</td>
        <td>
          <!-- Desactivar el botón si la foto ya ha sido revisada -->
          <button (click)="openModal(photo)" [disabled]="photo.status === 'aprobada' || photo.status === 'rechazada'">
            Revisar
          </button>
        </td>
      </tr>
    </tbody>
  </table>
</div>

<!-- Modal -->
<div class="modal" *ngIf="isModalOpen">
  <div class="modal-content">
    <span class="close" (click)="closeModal()">&times;</span>
    <h3>Revisar Foto</h3>
    <img [src]="selectedPhoto.photo_url" alt="Foto seleccionada" width="300" />
    <p>Usuario: {{ selectedPhoto.user_name || 'Desconocido' }}</p>
    <p>Nombre de la foto: {{ selectedPhoto.title || 'Desconocido' }}</p>
    <p>Rally: {{ selectedPhoto.rally_name || 'Desconocido' }}</p>
    <p>Estado actual: {{ selectedPhoto.status }}</p>

    <!-- Botones de aprobar o rechazar -->
    <button (click)="updatePhotoStatus('aprobada')" [disabled]="selectedPhoto.status !== 'pendiente'">Aprobar</button>
    <button (click)="updatePhotoStatus('rechazada')" [disabled]="selectedPhoto.status !== 'pendiente'">Rechazar</button>

    <!-- Mensaje si la foto ya fue revisada -->
    <p *ngIf="selectedPhoto.status === 'aprobada' || selectedPhoto.status === 'rechazada'">
      Esta foto ya ha sido revisada.
    </p>
  </div>
</div>
