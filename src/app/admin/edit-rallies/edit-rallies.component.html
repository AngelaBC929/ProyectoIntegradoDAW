<div class="container mt-5 mb-5">
  <h2 class="text-center mb-4" style="color:#4b2e2e; font-family: 'Georgia', serif;">Editar Rally</h2>

  <form [formGroup]="rallyForm" (ngSubmit)="onSubmit()">
    <div class="row g-3">

      <!-- TÃ­tulo -->
      <div class="col-md-6">
        <label for="title" class="form-label fw-bold" style="color:#3e2b2b;">TÃ­tulo</label>
        <input id="title" formControlName="title" type="text" class="form-control custom-input" placeholder="TÃ­tulo del rally" />
        <div *ngIf="rallyForm.get('title')?.touched && rallyForm.get('title')?.invalid" class="text-danger small mt-1">
          <small *ngIf="rallyForm.get('title')?.hasError('required')">El tÃ­tulo es obligatorio.</small>
          <small *ngIf="rallyForm.get('title')?.hasError('minlength')">El tÃ­tulo debe tener al menos 5 caracteres.</small>
          <small *ngIf="rallyForm.get('title')?.hasError('maxlength')">El tÃ­tulo no puede superar los 100 caracteres.</small>
        </div>
      </div>

      <!-- UbicaciÃ³n -->
      <div class="col-md-6">
        <label for="location" class="form-label fw-bold" style="color:#3e2b2b;">UbicaciÃ³n</label>
        <input id="location" formControlName="location" type="text" class="form-control custom-input" placeholder="UbicaciÃ³n del rally" />
        <div *ngIf="rallyForm.get('location')?.touched && rallyForm.get('location')?.invalid" class="text-danger small mt-1">
          <small *ngIf="rallyForm.get('location')?.hasError('required')">La ubicaciÃ³n es obligatoria.</small>
          <small *ngIf="rallyForm.get('location')?.hasError('minlength')">La ubicaciÃ³n debe tener al menos 3 caracteres.</small>
          <small *ngIf="rallyForm.get('location')?.hasError('maxlength')">La ubicaciÃ³n no puede superar los 100 caracteres.</small>
        </div>
      </div>

      <!-- DescripciÃ³n -->
      <div class="col-12">
        <label for="description" class="form-label fw-bold" style="color:#3e2b2b;">DescripciÃ³n</label>
        <textarea id="description" formControlName="description" rows="4" class="form-control custom-input" placeholder="DescripciÃ³n del rally"></textarea>
        <div *ngIf="rallyForm.get('description')?.touched && rallyForm.get('description')?.invalid" class="text-danger small mt-1">
          <small *ngIf="rallyForm.get('description')?.hasError('required')">La descripciÃ³n es obligatoria.</small>
          <small *ngIf="rallyForm.get('description')?.hasError('minlength')">La descripciÃ³n debe tener al menos 10 caracteres.</small>
          <small *ngIf="rallyForm.get('description')?.hasError('maxlength')">La descripciÃ³n no puede superar los 500 caracteres.</small>
        </div>
      </div>

      <!-- Fecha de inicio -->
      <div class="col-md-6">
        <label for="start_date" class="form-label fw-bold" style="color:#3e2b2b;">Fecha de inicio</label>
        <input id="start_date" type="date" formControlName="start_date" class="form-control custom-input" />
        <div *ngIf="rallyForm.get('start_date')?.touched && rallyForm.get('start_date')?.invalid" class="text-danger small mt-1">
          <small *ngIf="rallyForm.get('start_date')?.hasError('required')">La fecha de inicio es obligatoria.</small>
        </div>
      </div>

      <!-- Fecha de finalizaciÃ³n -->
      <div class="col-md-6">
        <label for="end_date" class="form-label fw-bold" style="color:#3e2b2b;">Fecha de finalizaciÃ³n</label>
        <input id="end_date" type="date" formControlName="end_date" class="form-control custom-input" />
        <div *ngIf="rallyForm.get('end_date')?.touched && rallyForm.get('end_date')?.invalid" class="text-danger small mt-1">
          <small *ngIf="rallyForm.get('end_date')?.hasError('required')">La fecha de finalizaciÃ³n es obligatoria.</small>
        </div>
        <div *ngIf="rallyForm.errors?.['dateMismatch'] && rallyForm.get('end_date')?.touched" class="text-danger small mt-1">
          <small>La fecha de finalizaciÃ³n no puede ser anterior a la de inicio.</small>
        </div>
      </div>

      <!-- Tema -->
      <div class="col-12">
        <label for="theme" class="form-label fw-bold" style="color:#3e2b2b;">Tema</label>
        <select id="theme" formControlName="theme" class="form-select custom-input">
          <option value="">Selecciona un tema</option>
          <option value="Fotografia">ğŸ“¸ FotografÃ­a general</option>
          <option value="Naturaleza">ğŸŒ¿ Naturaleza</option>
          <option value="Deporte">ğŸƒâ€â™‚ï¸ Deporte</option>
          <option value="Animales">ğŸ¾ Animales</option>
          <option value="Comida">ğŸ½ï¸ Comida</option>
          <option value="Mar y playa">ğŸ–ï¸ Mar y Playa</option>
          <option value="Paisaje urbano">ğŸŒ† Paisaje Urbano</option>
        </select>
        <div *ngIf="rallyForm.get('theme')?.touched && rallyForm.get('theme')?.invalid" class="text-danger small mt-1">
          <small *ngIf="rallyForm.get('theme')?.hasError('required')">El tema es obligatorio.</small>
        </div>
      </div>

    </div>

    <!-- Mensaje de error general -->
    <div *ngIf="rallyForm.invalid && rallyForm.touched" class="text-danger mt-3" style="font-family: 'Georgia', serif;">
      Por favor, completa todos los campos correctamente.
    </div>

    <!-- Botones -->
    <div class="mt-4 d-flex gap-3">
      <button type="submit" class="btn btn-guardar flex-grow-1" [disabled]="rallyForm.invalid || isLoading">Actualizar</button>
      <button type="button" class="btn btn-cancel flex-grow-1" (click)="cancel()">Cancelar</button>
    </div>
  </form>

  <!-- Fechas actuales -->
  <div *ngIf="rallyForm.get('start_date')?.value || rallyForm.get('end_date')?.value" class="mt-4" style="font-family: 'Georgia', serif; color: #4b2e05;">
    <h5><strong>Inicio actual:</strong> {{ rallyForm.get('start_date')?.value | date }}</h5>
    <h5><strong>Fin actual:</strong> {{ rallyForm.get('end_date')?.value | date }}</h5>
  </div>
</div>
