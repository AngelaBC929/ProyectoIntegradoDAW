<div class="container">
  <h2>Crear Rally</h2>
  <form [formGroup]="rallyForm" (ngSubmit)="onSubmit()">
    
    <!-- Título -->
    <div class="form-group">
      <label for="title">Título</label>
      <input id="title" formControlName="title" class="form-control" />
      <div *ngIf="rallyForm.get('title')?.invalid && rallyForm.get('title')?.touched" class="text-danger">
        <small *ngIf="rallyForm.get('title')?.hasError('required')">El título es obligatorio.</small>
        <small *ngIf="rallyForm.get('title')?.hasError('minlength')">El título debe tener al menos 6 caracteres.</small>
      </div>
    </div>

    <!-- Descripción -->
    <div class="form-group">
      <label for="description">Descripción</label>
      <textarea id="description" formControlName="description" class="form-control"></textarea>
      <div *ngIf="rallyForm.get('description')?.invalid && rallyForm.get('description')?.touched" class="text-danger">
        <small *ngIf="rallyForm.get('description')?.hasError('required')">La descripción es obligatoria.</small>
        <small *ngIf="rallyForm.get('description')?.hasError('minlength')">La descripción debe tener al menos 10 caracteres.</small>
        <small *ngIf="rallyForm.get('description')?.hasError('maxlength')">La descripción no puede tener más de 250 caracteres.</small>
      </div>
    </div>

    <!-- Fecha de inicio -->
    <div class="form-group">
      <label for="start_date">Fecha de inicio</label>
      <input id="start_date" type="date" formControlName="start_date" class="form-control" />
      <div *ngIf="rallyForm.get('start_date')?.invalid && rallyForm.get('start_date')?.touched" class="text-danger">
        La fecha de inicio es obligatoria.
      </div>
    </div>

    <!-- Fecha de finalización -->
    <div class="form-group">
      <label for="end_date">Fecha de finalización</label>
      <input id="end_date" type="date" formControlName="end_date" class="form-control" />
      <div *ngIf="rallyForm.get('end_date')?.invalid && rallyForm.get('end_date')?.touched" class="text-danger">
        La fecha de finalización es obligatoria.
      </div>
    </div>

    <!-- Mostrar error de validación de fecha si existe -->
    <div *ngIf="dateRangeError" class="text-danger">
      {{ dateRangeError }}
    </div>

    <!-- Ubicación -->
    <div class="form-group">
      <label for="location">Ubicación</label>
      <input id="location" formControlName="location" class="form-control" />
      <div *ngIf="rallyForm.get('location')?.invalid && rallyForm.get('location')?.touched" class="text-danger">
        La ubicación es obligatoria.
      </div>
    </div>

    <!-- Tema -->
    <div class="form-group">
      <label for="theme">Tema</label>
      <input id="theme" formControlName="theme" class="form-control" />
      <div *ngIf="rallyForm.get('theme')?.invalid && rallyForm.get('theme')?.touched" class="text-danger">
        El tema es obligatorio.
      </div>
    </div>

    <!-- Botón para enviar el formulario -->
    <div class="form-group">
      <button type="submit" class="btn btn-primary" [disabled]="isLoading">
        Crear Rally
      </button>
    </div>

    <!-- Mensajes de estado -->
    <div *ngIf="message" class="alert alert-info">
      {{ message }}
    </div>
  </form>

  <!-- Lista de rallies -->
  <div *ngIf="rallies.length > 0">
    <h3>Rallies creados</h3>
    <ul class="list-group">
      <li class="list-group-item" *ngFor="let rally of rallies">
        <strong>{{ rally.title }}</strong><br>
        Fecha de inicio: {{ rally.start_date | date }}<br>
        Fecha de finalización: {{ rally.end_date | date }}<br>
        Ubicación: {{ rally.location }}<br>
        Tema: {{ rally.theme }}
      </li>
    </ul>
  </div>
<!-- 
  Si no hay rallies, mostramos un mensaje
  <div *ngIf="!rallies.length">
    <p>No hay rallies disponibles.</p>
  </div> -->
</div>
