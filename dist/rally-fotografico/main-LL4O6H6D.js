import{a as He}from"./chunk-A4WZEE76.js";import{a as Ae}from"./chunk-A32AXAJB.js";import{a as mr,b as ye,c as L,d as Ce,e as qe,f as dn,g as nt,h as Ge,i as xt,j as wt,k as St,l as Et,m as Mt,n as mn,o as ur,p as pr,q as fr,r as gr,s as hr,t as it,u as Q,v as rt}from"./chunk-F5A45TTZ.js";import{$ as jt,$a as A,A as w,Aa as an,Ba as W,C as en,Ca as yt,D as $i,Da as _e,E as zt,Ea as ti,Fa as ir,G as Lt,H as ei,I as Qi,J as Wi,Ja as qt,K as Vt,L as De,La as Be,M as tn,Ma as $,N as m,Na as K,O as Yi,Oa as sn,P as Zi,Pa as ln,Qa as ve,R as y,Ra as U,S as k,Sa as rr,Ta as or,Ua as et,Va as ar,W as h,Wa as sr,Xa as cn,Y as nn,Ya as lr,Z as Bt,Za as tt,_ as u,_a as cr,a as B,aa as X,ab as Ct,b as fe,ba as he,bb as dr,c as ji,ca as s,cb as je,da as a,db as oe,ea as O,eb as Pt,f as qi,fa as Pe,g as Le,ga as Oe,h as bt,ha as V,ia as Xi,j as Nt,ja as _,k as Fe,ka as g,l as vt,la as Ji,ma as er,n as ge,na as tr,o as Ve,oa as nr,p as z,pa as re,qa as c,r as Y,ra as D,sa as R,t as Gi,ta as rn,u as q,ua as le,v as Je,va as ce,w as Hi,wa as de,x as Ki,ya as Ye,z as x,za as on}from"./chunk-BWXDRC3P.js";var ne=class i{constructor(t){this.http=t}apiUrl=oe.apiUrl;roleSubject=new bt(localStorage.getItem("role"));role$=this.roleSubject.asObservable();usernameSubject=new bt(localStorage.getItem("username"));username$=this.usernameSubject.asObservable();timeout;TIMEOUT_LIMIT=15*60*1e3;sessionExpiredSubject=new Le;sessionExpired$=this.sessionExpiredSubject.asObservable();login(t,e){return this.http.post(`${this.apiUrl}/login.php`,{username:t,password:e}).pipe(Ve(n=>{localStorage.setItem("authToken",n.token),this.setRole(n.role),this.setUsername(n.username),localStorage.setItem("userId",n.id),this.startTimeout()}),ge(n=>Fe(()=>n)))}logout(){localStorage.removeItem("authToken"),this.setRole(null),this.setUsername(null),localStorage.removeItem("userId"),clearTimeout(this.timeout)}isAuthenticated(){return!!localStorage.getItem("authToken")}startTimeout(){clearTimeout(this.timeout),this.timeout=setTimeout(()=>{this.logout(),this.sessionExpiredSubject.next()},this.TIMEOUT_LIMIT)}resetTimeout(){this.isAuthenticated()&&this.startTimeout()}getUserRole(){return localStorage.getItem("role")}getUserId(){let t=localStorage.getItem("userId");return t?parseInt(t,10):null}setUsername(t){t?localStorage.setItem("username",t):localStorage.removeItem("username"),this.usernameSubject.next(t)}getUsername(){return this.usernameSubject.getValue()}register(t,e,n,r,o,l){let d={action:"create",email:t,username:e,password:n,name:r,lastName:o,birthdate:l};return this.http.post(`${this.apiUrl}/usuarios.php`,d).pipe(Ve(p=>console.log("Usuario registrado con \xE9xito:",p)),ge(p=>Fe(()=>new Error(p.error?.error||"Error al registrar usuario"))))}setRole(t){t?localStorage.setItem("role",t):localStorage.removeItem("role"),this.roleSubject.next(t)}sessionExpiredLogin=!1;setLoginAfterSessionExpired(t){this.sessionExpiredLogin=t}getLoginAfterSessionExpired(){return this.sessionExpiredLogin}getRole(){return this.roleSubject.getValue()}getToken(){return localStorage.getItem("authToken")}static \u0275fac=function(e){return new(e||i)(q(et))};static \u0275prov=Y({token:i,factory:i.\u0275fac,providedIn:"root"})};var un=class i{constructor(t,e,n){this.router=t;this.userService=e;this.authenticationService=n}userName="Invitado";userId=0;ngOnInit(){this.userId=+localStorage.getItem("userId"),this.userId&&this.userService.getUserById(this.userId).subscribe(t=>{this.userName=t.name,console.log("Nombre del usuario:",this.userName)})}logout(){localStorage.removeItem("authToken"),localStorage.removeItem("userRole"),localStorage.removeItem("userId"),this.authenticationService.setRole(null),this.router.navigate(["/home"])}static \u0275fac=function(e){return new(e||i)(y(A),y(Pt),y(ne))};static \u0275cmp=k({type:i,selectors:[["app-navbar"]],decls:16,vars:1,consts:[[1,"urban-navbar","container-fluid","py-3"],[1,"row","w-100","align-items-center"],[1,"col-12","col-md-6","text-center","text-md-start","urban-navbar-left","mb-3","mb-md-0","d-flex","align-items-center","gap-3"],["src","/images/logo5.png","alt","Logo ExpressCaptureVz",1,"urban-navbar-logo"],[1,"urban-brand-group"],[1,"urban-navbar-brand"],[2,"font-size","0.6em","vertical-align","super"],[1,"urban-navbar-subtitle"],[1,"col-12","col-md-6","d-flex","justify-content-center","justify-content-md-end","align-items-center","flex-wrap","gap-2","urban-navbar-right"],[1,"user-name"],[1,"urban-btn",3,"click"]],template:function(e,n){e&1&&(s(0,"header",0)(1,"div",1)(2,"div",2),O(3,"img",3),s(4,"div",4)(5,"div",5),c(6,"ExpressCaptureVz"),s(7,"span",6),c(8,"\xAE"),a()(),s(9,"div",7),c(10,"Rally Fotogr\xE1fico"),a()()(),s(11,"div",8)(12,"span",9),c(13),a(),s(14,"button",10),_("click",function(){return n.logout()}),c(15,"Cerrar sesi\xF3n"),a()()()()),e&2&&(m(13),D(n.userName))},dependencies:[U,Q],styles:[".urban-navbar[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;background-color:#5c2c10;color:#fdf3e7;padding:1rem 2rem;border-bottom:2px solid #8d3c1f;font-family:Segoe UI,sans-serif;position:sticky;top:0;z-index:100;flex-wrap:wrap}.urban-navbar-left[_ngcontent-%COMP%]{font-size:3rem;font-weight:400;color:#fef5e4;text-shadow:1px 1px 4px #3d1c0f}.urban-brand-group[_ngcontent-%COMP%]{line-height:1.1}.urban-navbar-brand[_ngcontent-%COMP%]{font-family:Rye,cursive;font-size:2.6rem;margin-bottom:.2rem;color:#fef5e4}.urban-navbar-subtitle[_ngcontent-%COMP%]{font-size:1.1rem;text-transform:uppercase;letter-spacing:.5px;color:#f4d6b5}.urban-navbar-right[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;flex-wrap:wrap;justify-content:center}.user-name[_ngcontent-%COMP%]{font-weight:700;font-size:1.3rem;color:#fff0e0;background-color:#5a280a66;padding:.4rem .8rem;border-radius:8px}.urban-navbar-logo[_ngcontent-%COMP%]{height:8rem;width:auto;object-fit:contain;-webkit-user-select:none;user-select:none}.urban-btn[_ngcontent-%COMP%]{background-color:#8d3c1f;color:#fff2e0;border:none;padding:.5rem 1.3rem;font-size:1.3rem;font-weight:700;border-radius:6px;transition:background-color .3s ease;cursor:pointer}.urban-btn[_ngcontent-%COMP%]:hover{background-color:#a54825}@media (max-width: 768px){.urban-navbar[_ngcontent-%COMP%]{flex-direction:column;align-items:center;padding:1rem;text-align:center}.urban-navbar-left[_ngcontent-%COMP%]{font-size:2.2rem;margin-bottom:.3rem}.urban-navbar-brand[_ngcontent-%COMP%]{font-size:1.8rem}.urban-navbar-subtitle[_ngcontent-%COMP%]{font-size:.95rem}.urban-navbar-right[_ngcontent-%COMP%]{flex-direction:column;gap:.6rem;margin-top:.8rem}.user-name[_ngcontent-%COMP%]{font-size:1.1rem;padding:.3rem .7rem}.urban-btn[_ngcontent-%COMP%]{font-size:1.1rem;padding:.6rem 1.2rem;width:100%;max-width:200px}.urban-navbar-logo[_ngcontent-%COMP%]{height:40px}}"]})};function Eo(i,t){i&1&&O(0,"app-navbar")}function Mo(i,t){if(i&1){let e=V();s(0,"div",5)(1,"div",6)(2,"div",7)(3,"h5",8),c(4,"Sesi\xF3n expirada"),a(),s(5,"div",9)(6,"p"),c(7,"Tu sesi\xF3n ha caducado por inactividad. Por favor, inicia sesi\xF3n nuevamente."),a()(),s(8,"div",10)(9,"button",11),_("click",function(){x(e);let r=g();return w(r.handleLogin())}),c(10,"Iniciar sesi\xF3n"),a(),s(11,"button",12),_("click",function(){x(e);let r=g();return w(r.handleCancel())}),c(12,"Cancelar"),a()()()()()}}function Po(i,t){i&1&&O(0,"div",13)}var pn=class i{constructor(t,e){this.authService=t;this.router=e}title="rallyFotografico";role=null;showModal=!1;isLoggedIn=!1;ngOnInit(){this.authService.role$.subscribe(t=>{this.role=t}),this.authService.sessionExpired$.subscribe(()=>{this.showSessionExpiredModal()}),this.isLoggedIn=this.authService.isAuthenticated(),this.isLoggedIn||this.router.navigate(["/home"])}onUserActivity(){this.authService.resetTimeout()}showSessionExpiredModal(){this.showModal=!0}handleLogin(){this.showModal=!1,this.authService.logout(),this.authService.setLoginAfterSessionExpired(!0),this.router.navigate(["/login"])}handleCancel(){this.authService.logout(),this.showModal=!1,this.router.navigate(["/home"])}static \u0275fac=function(e){return new(e||i)(y(ne),y(A))};static \u0275cmp=k({type:i,selectors:[["app-root"]],hostBindings:function(e,n){e&1&&_("mousemove",function(o){return n.onUserActivity(o)},!1,tn)("keydown",function(o){return n.onUserActivity(o)},!1,tn)("click",function(o){return n.onUserActivity(o)},!1,tn)},decls:8,vars:3,consts:[[4,"ngIf"],["class","modal fade show session-expired-modal","tabindex","-1","role","dialog","style","display: block;",4,"ngIf"],["class","modal-backdrop fade show",4,"ngIf"],[1,"main-container"],[1,"urban-footer"],["tabindex","-1","role","dialog",1,"modal","fade","show","session-expired-modal",2,"display","block"],["role","document",1,"modal-dialog"],[1,"modal-content"],[1,"session-expired-title"],[1,"session-expired-content"],[1,"session-expired-actions"],[1,"btn","btn-session-login",3,"click"],[1,"btn","btn-session-cancel",3,"click"],[1,"modal-backdrop","fade","show"]],template:function(e,n){e&1&&(h(0,Eo,1,0,"app-navbar",0)(1,Mo,13,0,"div",1)(2,Po,1,0,"div",2),s(3,"main",3),O(4,"router-outlet"),a(),s(5,"footer",4)(6,"p"),c(7,"\xA9 2025 ExpressCaptureVz - Rally Fotogr\xE1fico. Todos los derechos reservados."),a()()),e&2&&(u("ngIf",n.role),m(),u("ngIf",n.showModal),m(),u("ngIf",n.showModal))},dependencies:[cr,U,K,Q,un],styles:["*[_ngcontent-%COMP%]{margin:0;padding:0;box-sizing:border-box}html[_ngcontent-%COMP%], body[_ngcontent-%COMP%]{height:100%;width:100%;margin:0;padding:0}body[_ngcontent-%COMP%]{display:flex;flex-direction:column;min-height:100vh}app-root[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column}main.main-container[_ngcontent-%COMP%]{flex:1}.urban-footer[_ngcontent-%COMP%]{background-color:#2b160a;color:#d5c4aa;text-align:center;padding:.8rem;font-size:.7rem;border-top:.6px solid #5b3c26;margin-top:auto}.modal-backdrop.show[_ngcontent-%COMP%]{background:#0009;-webkit-backdrop-filter:blur(3px);backdrop-filter:blur(3px);z-index:1040}.modal.session-expired-modal[_ngcontent-%COMP%]{display:flex!important;align-items:center;justify-content:center;background:linear-gradient(135deg,#6d3b1e,#2a1507);-webkit-backdrop-filter:blur(3px);backdrop-filter:blur(3px);overflow:hidden;z-index:1050}.session-expired-modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]{width:90%;max-width:420px;animation:_ngcontent-%COMP%_fadeIn .3s ease}.session-expired-modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]{background:linear-gradient(145deg,#4e2b12,#3a1d0b);border-radius:14px;padding:2rem;border:1px solid #c97b4d;box-shadow:0 0 25px #c8783c66;color:#fdf3e7;text-align:center}.session-expired-title[_ngcontent-%COMP%]{font-size:1.8rem;font-weight:700;margin-bottom:1rem;color:#fc9;text-shadow:1px 1px 3px #000}.session-expired-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1rem;color:#ffd9b3;margin-bottom:1.5rem}.session-expired-actions[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:1rem;flex-wrap:wrap;margin-top:1.5rem}.btn-session-login[_ngcontent-%COMP%], .btn-session-cancel[_ngcontent-%COMP%]{padding:.6rem 1.6rem;font-size:1.1rem;border-radius:50px;font-weight:700;transition:.3s ease;border:none;cursor:pointer}.btn-session-login[_ngcontent-%COMP%]{background-color:#f4a261;color:#2b160a}.btn-session-login[_ngcontent-%COMP%]:hover{background-color:#ffa366}.btn-session-cancel[_ngcontent-%COMP%]{background-color:#5c3b28;color:#fbe9d0}.btn-session-cancel[_ngcontent-%COMP%]:hover{background-color:#7a4a30}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:scale(.96)}to{opacity:1;transform:scale(1)}}@media (max-width: 500px){.session-expired-modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]{padding:1.2rem 1.5rem;width:95%}.session-expired-actions[_ngcontent-%COMP%]{flex-direction:column;gap:.8rem}.btn-session-login[_ngcontent-%COMP%], .btn-session-cancel[_ngcontent-%COMP%]{width:100%}}"]})};var Oo=i=>({"is-invalid":i});function To(i,t){i&1&&(s(0,"div",23),c(1," El usuario es requerido. "),a())}function Fo(i,t){i&1&&(s(0,"div",23),c(1," La contrase\xF1a debe tener entre 8 y 12 caracteres, incluir may\xFAsculas, min\xFAsculas y un car\xE1cter especial. "),a())}function Ao(i,t){i&1&&(s(0,"div",23),c(1," La contrase\xF1a es requerida. "),a())}function Io(i,t){if(i&1&&(s(0,"div",24),c(1),a()),i&2){let e=g();m(),R(" ",e.errorMessage," ")}}var Ot=class i{constructor(t,e){this.authService=t;this.router=e}cerrar=new $i;username="";password="";submitted=!1;passwordVisible=!1;errorMessage="";passwordRegex=/^(?=.*[a-z])(?=.*[A-Z])(?=.*[\W_]).{8,12}$/;passwordValid(){return this.passwordRegex.test(this.password)}togglePasswordVisibility(){this.passwordVisible=!this.passwordVisible}onSubmit(){this.submitted=!0,this.passwordValid()&&this.authService.login(this.username,this.password).subscribe({next:t=>{t.token&&t.role&&t.username&&t.id&&(localStorage.setItem("authToken",t.token),localStorage.setItem("userRole",t.role),localStorage.setItem("username",t.username),localStorage.setItem("userId",t.id.toString()),t.role==="admin"?this.router.navigate(["/admin"]):this.router.navigate(["/user/dashboard"]),this.cerrar.emit())},error:t=>{console.log("Error de login:",t),t.status===404?this.errorMessage=t.error.error||"Este usuario no est\xE1 registrado. \xBFDeseas registrarte?":t.status===401?this.errorMessage=t.error.error||"Contrase\xF1a incorrecta. Intenta de nuevo.":this.errorMessage="Hubo un problema al intentar iniciar sesi\xF3n. Por favor, intenta de nuevo m\xE1s tarde."}})}goHome(){this.authService.getLoginAfterSessionExpired()?(this.authService.setLoginAfterSessionExpired(!1),this.router.navigate(["/home"])):this.cerrar.emit()}static \u0275fac=function(e){return new(e||i)(y(ne),y(A))};static \u0275cmp=k({type:i,selectors:[["app-login"]],outputs:{cerrar:"cerrar"},decls:31,vars:12,consts:[["loginForm","ngForm"],["usernameField","ngModel"],["passwordField","ngModel"],[1,"login-modal"],[1,"login-modal-dialog"],[1,"login-modal-content"],["novalidate","",1,"login-form",3,"ngSubmit"],[1,"login-modal-header"],[1,"login-modal-title"],[1,"login-modal-body"],[1,"login-form-group"],["for","username",1,"login-form-label"],["type","text","id","username","name","username","autocomplete","username","required","","placeholder","Ingresa tu usuario",1,"login-form-control",3,"ngModelChange","ngModel"],["class","login-invalid-feedback",4,"ngIf"],["for","password",1,"login-form-label"],[1,"input-wrapper"],["id","password","name","password","autocomplete","current-password","required","","placeholder","Ingresa tu contrase\xF1a",1,"login-form-control",3,"ngModelChange","type","ngModel","ngClass"],[1,"login-password-toggle",3,"click"],[1,"fa",3,"ngClass"],["class","login-error-message",4,"ngIf"],[1,"login-modal-footer"],["type","submit",1,"login-btn-login",3,"disabled"],["type","button",1,"login-btn-cancel",3,"click"],[1,"login-invalid-feedback"],[1,"login-error-message"]],template:function(e,n){if(e&1){let r=V();s(0,"div",3)(1,"div",4)(2,"div",5)(3,"form",6,0),_("ngSubmit",function(){return x(r),w(n.onSubmit())}),s(5,"div",7)(6,"h5",8),c(7,"Iniciar sesi\xF3n"),a()(),s(8,"div",9)(9,"div",10)(10,"label",11),c(11,"Usuario"),a(),s(12,"input",12,1),de("ngModelChange",function(l){return x(r),ce(n.username,l)||(n.username=l),w(l)}),a(),h(14,To,2,0,"div",13),a(),s(15,"div",10)(16,"label",14),c(17,"Contrase\xF1a"),a(),s(18,"div",15)(19,"input",16,2),de("ngModelChange",function(l){return x(r),ce(n.password,l)||(n.password=l),w(l)}),a(),s(21,"span",17),_("click",function(){return x(r),w(n.togglePasswordVisibility())}),O(22,"i",18),a()(),h(23,Fo,2,0,"div",13)(24,Ao,2,0,"div",13),a(),h(25,Io,2,1,"div",19),a(),s(26,"div",20)(27,"button",21),c(28," Iniciar sesi\xF3n "),a(),s(29,"button",22),_("click",function(){return x(r),w(n.goHome())}),c(30," Cancelar "),a()()()()()()}if(e&2){let r=re(4),o=re(13),l=re(20);m(12),le("ngModel",n.username),m(2),u("ngIf",n.submitted&&o.invalid),m(5),u("type",n.passwordVisible?"text":"password"),le("ngModel",n.password),u("ngClass",on(10,Oo,n.submitted&&l.invalid||n.password&&!n.passwordValid())),m(3),u("ngClass",n.passwordVisible?"fa-eye":"fa-eye-slash"),m(),u("ngIf",n.password&&!n.passwordValid()),m(),u("ngIf",n.submitted&&l.invalid),m(),u("ngIf",n.errorMessage),m(2),u("disabled",!r.form.valid)}},dependencies:[U,Be,K,Q,Ge,ye,Ce,qe,mn,nt,dn],styles:["[_nghost-%COMP%]{display:block}.login-modal[_ngcontent-%COMP%]{background-color:#0009;z-index:1050}.login-modal-dialog[_ngcontent-%COMP%]{max-width:600px;margin:auto}.login-modal-content[_ngcontent-%COMP%]{background:linear-gradient(145deg,#4e2b12,#3a1d0b);color:#fdf3e7;border-radius:15px;border:1px solid #c97b4d;box-shadow:0 0 30px #c8783c4d}.login-modal-header[_ngcontent-%COMP%], .login-modal-footer[_ngcontent-%COMP%]{border:none;background:transparent;padding:1rem 2rem}.login-modal-title[_ngcontent-%COMP%]{font-size:2.2rem;font-weight:700;color:#fc9;text-shadow:1px 1px 4px #000;text-align:center;width:100%}.login-btn-close[_ngcontent-%COMP%]{background:none;border:none;color:#fff;font-size:1.5rem;margin-left:auto}.login-modal-body[_ngcontent-%COMP%]{padding:2rem 2.5rem}.login-form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;text-align:center;position:relative;margin-bottom:1.5rem}.login-form-label[_ngcontent-%COMP%]{display:inline-block;width:100%;max-width:300px;margin-bottom:.4rem;color:#ffcc80;font-weight:500;text-align:center}.input-wrapper[_ngcontent-%COMP%]{position:relative;width:100%;max-width:300px}.login-form-control[_ngcontent-%COMP%]{width:100%;max-width:300px;padding:.8rem 2.5rem .8rem .8rem;background-color:#2e1a0f;border:1px solid #6a3a21;color:#fff6e5;border-radius:8px;font-size:1.2rem}.login-form-control[_ngcontent-%COMP%]::placeholder{color:#cba98b;font-style:italic}.login-form-control[_ngcontent-%COMP%]:focus{border-color:#ffa366;box-shadow:0 0 10px #ff996680}.login-password-toggle[_ngcontent-%COMP%]{position:absolute;top:50%;right:.8rem;transform:translateY(-50%);cursor:pointer;z-index:10;color:#ffddb3;font-size:1.5rem;transition:color .3s ease}.login-password-toggle[_ngcontent-%COMP%]:hover{color:#ffb366}.login-invalid-feedback[_ngcontent-%COMP%]{font-size:.9rem;color:#ff5e5e;margin-top:.4rem;max-width:300px;word-wrap:break-word;text-align:center}.login-error-message[_ngcontent-%COMP%]{border:1px solid #ff4d4d;background-color:#ff4d4d1a;color:#faa;font-weight:700;margin-top:1rem;padding:.6rem 1rem;border-radius:6px}.login-modal-footer[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:1rem;flex-wrap:wrap}@media (max-width: 576px){.login-modal-footer[_ngcontent-%COMP%]{flex-direction:column;align-items:center}}.login-btn-login[_ngcontent-%COMP%], .login-btn-cancel[_ngcontent-%COMP%]{padding:.8rem 2.2rem;font-size:1.2rem;border-radius:50px;font-weight:700;transition:.3s ease;border:none}.login-btn-login[_ngcontent-%COMP%]{background-color:#f4a261;color:#2b160a}.login-btn-login[_ngcontent-%COMP%]:hover{background-color:#ffa366}.login-btn-cancel[_ngcontent-%COMP%]{background-color:#5c3b28;color:#fbe9d0}.login-btn-cancel[_ngcontent-%COMP%]:hover{background-color:#7a4a30}"]})};function ko(i,t){if(i&1){let e=V();s(0,"div",21)(1,"div",22)(2,"h2"),c(3),a(),s(4,"button",23),_("click",function(){x(e);let r=g();return w(r.closeSuccessMessage())}),c(5,"Cerrar"),a()()()}if(i&2){let e=g();m(3),D(e.successMessage)}}function Do(i,t){if(i&1&&(s(0,"div",24),O(1,"img",25),a()),i&2){let e=t.$implicit;m(),u("src",e.photo_url,De)("alt",e.title||"Foto subida")}}function Ro(i,t){if(i&1){let e=V();s(0,"div",26)(1,"app-login",27),_("cerrar",function(){x(e);let r=g();return w(r.cerrarLogin())}),a()()}}var fn=class i{constructor(t,e,n,r){this.router=t;this.route=e;this.http=n;this.photoService=r}showLoginModal=!1;successMessage=null;isLoginVisible=!1;recentPhotos=[];ngOnInit(){let t=history.state;t?.message&&(this.successMessage=t.message),this.loadRecentPhotos()}loadRecentPhotos(){this.photoService.getFotosAprobadasPaginated(1,6).subscribe({next:t=>{let e=t.photos||[];e.forEach(n=>{n.photo_url=`${oe.apiUrl}/${n.photo_url}`}),this.recentPhotos=e.slice(0,4)},error:t=>{console.error("Error al cargar las fotos recientes",t)}})}closeSuccessMessage(){this.successMessage=null}mostrarLogin(){this.isLoginVisible=!0}cerrarLogin(){this.isLoginVisible=!1}goToGallery(){this.router.navigate(["/gallery"])}goToRegister(){this.router.navigate(["/register"])}static \u0275fac=function(e){return new(e||i)(y(A),y(tt),y(et),y(He))};static \u0275cmp=k({type:i,selectors:[["app-home"]],decls:31,vars:3,consts:[[1,"urban-hero","container-fluid","position-relative","py-5"],[1,"urban-buttons-top","d-flex","justify-content-end","gap-2","px-4","position-absolute","top-0","end-0","mt-4","z-3"],[1,"urban-btn","urban-login",3,"click"],[1,"urban-btn","urban-register",3,"click"],[1,"urban-hero-text-wrapper"],[1,"urban-hero-text","mx-auto","px-3"],[1,"urban-brand-text"],[1,"urban-brand-title","mt-4"],[2,"font-size","0.6em","vertical-align","super"],[1,"urban-title"],[1,"urban-subtitle"],[1,"urban-instructions-container","py-5"],[1,"container","text-center"],[1,"urban-instructions-text"],["class","urban-success-overlay",4,"ngIf"],[1,"urban-gallery","py-4"],[1,"urban-section-title"],[1,"urban-gallery-grid"],["class","urban-gallery-item",4,"ngFor","ngForOf"],[1,"urban-btn","gallery-btn","mt-3",3,"click"],["class","urban-login-overlay",4,"ngIf"],[1,"urban-success-overlay"],[1,"urban-success-box"],[1,"urban-btn","close-btn",3,"click"],[1,"urban-gallery-item"],[3,"src","alt"],[1,"urban-login-overlay"],[3,"cerrar"]],template:function(e,n){e&1&&(s(0,"section",0)(1,"div",1)(2,"button",2),_("click",function(){return n.mostrarLogin()}),c(3,"Iniciar sesi\xF3n"),a(),s(4,"button",3),_("click",function(){return n.goToRegister()}),c(5,"Registrarse"),a()(),s(6,"div",4)(7,"div",5)(8,"div",6)(9,"h1",7),c(10,"ExpressCaptureVz"),s(11,"span",8),c(12,"\xAE"),a()(),s(13,"h2",9),c(14,"Rally Fotogr\xE1fico"),a()(),s(15,"p",10),c(16,' "Captura lo extraordinario en lo cotidiano. Comparte tu visi\xF3n \xFAnica con el mundo." '),a()()()(),s(17,"section",11)(18,"div",12)(19,"p",13),c(20," Para unirte al Rally Fotogr\xE1fico debes registrarte como participante y completar tu perfil. Una vez dentro, podr\xE1s acceder a los rallies activos y subir tus fotos dentro del plazo. Cada imagen ser\xE1 revisada antes de publicarse en la galer\xEDa. \xA1No olvides votar tus favoritas! "),a()()(),h(21,ko,6,1,"div",14),s(22,"section",15)(23,"div",12)(24,"h2",16),c(25,"Galer\xEDa destacada"),a(),s(26,"div",17),h(27,Do,2,2,"div",18),a(),s(28,"button",19),_("click",function(){return n.goToGallery()}),c(29,"Ver m\xE1s"),a()()(),h(30,Ro,2,0,"div",20)),e&2&&(m(21),u("ngIf",n.successMessage),m(6),u("ngForOf",n.recentPhotos),m(3),u("ngIf",n.isLoginVisible))},dependencies:[U,$,K,je,cn,Ot],styles:["[_nghost-%COMP%]{display:block}body[_ngcontent-%COMP%]{font-family:Segoe UI,sans-serif;background-color:#5c2c10;color:#fdf3e7;margin:0}img[_ngcontent-%COMP%]{max-width:100%;display:block}.urban-hero[_ngcontent-%COMP%]{background:url(/images/portada2.png) no-repeat center top;background-size:cover;min-height:100vh;display:flex;justify-content:center;align-items:flex-start;position:relative;text-align:center;color:#fef5e4;padding:2rem 1rem}.urban-buttons-top[_ngcontent-%COMP%]{position:absolute;top:2rem;right:2rem;display:flex;gap:1rem;z-index:10;flex-wrap:wrap}.urban-hero-text[_ngcontent-%COMP%]{max-width:800px;padding:1rem;margin:0 auto;text-align:center}.urban-brand-title[_ngcontent-%COMP%]{font-family:Rye,cursive;font-size:4rem;color:#fef5e4;margin:0;line-height:1;margin-bottom:2rem}.urban-title[_ngcontent-%COMP%]{font-size:1.8rem;color:#fef5e4;margin-bottom:2rem;font-weight:500;text-transform:uppercase;text-shadow:2px 2px 5px #3d1c0f;line-height:1.1}.urban-subtitle[_ngcontent-%COMP%]{font-size:1.6rem;color:#fbe9d0;font-style:italic;margin-bottom:1.5rem}.urban-instructions-container[_ngcontent-%COMP%]{background-color:#8d3c1f;color:#fef5e4;padding:2rem 1rem;text-align:center}.urban-instructions-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1.2rem;max-width:900px;margin:0 auto;line-height:1.6}.urban-btn[_ngcontent-%COMP%]{background-color:#8d3c1f;color:#fff2e0;border:none;padding:.7rem 1.8rem;font-size:1.1rem;font-weight:700;border-radius:6px;transition:.3s ease;cursor:pointer}.urban-btn[_ngcontent-%COMP%]:hover{background-color:#a54825}.urban-register[_ngcontent-%COMP%], .urban-login[_ngcontent-%COMP%]{background-color:#9e4d24;color:#fff6eb}.urban-register[_ngcontent-%COMP%]{margin-right:.5rem}.urban-login[_ngcontent-%COMP%]:hover, .urban-register[_ngcontent-%COMP%]:hover{background-color:#b55b30}.urban-section-title[_ngcontent-%COMP%]{font-size:2rem;font-weight:700;text-shadow:#3d1c0f 1px 1px 3px;margin:1.8rem 0 1rem;color:#a54825;text-align:center}.urban-gallery-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:16px;margin:0 auto 3rem;padding:0 1rem;max-width:1200px}.urban-gallery-item[_ngcontent-%COMP%]{border-radius:10px;overflow:hidden;box-shadow:0 2px 8px #0000001a;height:200px;transition:transform .3s}.urban-gallery-item[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.urban-gallery-item[_ngcontent-%COMP%]:hover{transform:scale(1.05)}.gallery-btn[_ngcontent-%COMP%]{background-color:#a54103;color:#fff;font-size:.9rem;padding:.5rem 1.2rem}.gallery-btn[_ngcontent-%COMP%]:hover{background-color:#572201}.urban-login-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#000c;display:flex;justify-content:center;align-items:center;z-index:1000}.urban-success-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#000000e6;display:flex;justify-content:center;align-items:center}.urban-success-box[_ngcontent-%COMP%]{background-color:#f8e4c4;padding:2.5rem 3rem;border-radius:12px;text-align:center;box-shadow:0 0 15px #000000b3}.close-btn[_ngcontent-%COMP%]{margin-top:1.5rem;background-color:#6b3d1c;color:#fff0d9}@media (max-width: 768px){.urban-hero[_ngcontent-%COMP%]{padding-top:1rem;padding-bottom:2rem;align-items:center;background-position:center 60%}.urban-buttons-top[_ngcontent-%COMP%]{flex-direction:column;gap:.8rem;align-items:flex-end}.urban-buttons-top[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:140px;font-size:1.1rem;padding:.9rem 1.2rem}.urban-hero-text[_ngcontent-%COMP%]{padding:.1rem;position:relative;top:-5rem}.urban-brand-title[_ngcontent-%COMP%]{font-size:2.6rem;margin-bottom:.5rem}.urban-title[_ngcontent-%COMP%]{font-size:1.4rem;margin-bottom:.5rem}.urban-subtitle[_ngcontent-%COMP%]{font-size:1rem;margin-bottom:.8rem}.urban-instructions-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1rem;padding:0 .5rem}.urban-gallery-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.gallery-btn[_ngcontent-%COMP%]{font-size:.85rem;padding:.4rem 1rem}.urban-buttons-top[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:0}}@media (max-width: 480px){.urban-hero-text[_ngcontent-%COMP%]{padding:.5rem;position:relative;top:-5rem;background-position:center 60%}.urban-brand-title[_ngcontent-%COMP%]{margin-top:2rem;font-size:2.2rem}.urban-title[_ngcontent-%COMP%]{font-size:1.2rem;margin-bottom:.4rem}.urban-subtitle[_ngcontent-%COMP%]{font-size:.95rem;margin-bottom:.6rem}.urban-instructions-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.95rem}.urban-btn[_ngcontent-%COMP%]{font-size:1rem;padding:.6rem 1.2rem}.urban-buttons-top[_ngcontent-%COMP%]{align-items:center;top:1.5rem;left:0;right:0;margin:0 auto;flex-direction:column;gap:1rem}.urban-buttons-top[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:80%;max-width:250px;font-size:1.2rem;padding:1rem 1.4rem}}"]})};function Uo(i,t){if(i&1&&(s(0,"li"),c(1),a()),i&2){let e=t.$implicit;m(),D(e)}}function No(i,t){if(i&1&&(s(0,"div",35)(1,"ul"),h(2,Uo,2,1,"li",36),a()()),i&2){let e=g();m(2),u("ngForOf",e.errorMessages)}}function zo(i,t){i&1&&(s(0,"div",37),c(1," El nombre debe tener al menos 3 caracteres. "),a())}function Lo(i,t){i&1&&(s(0,"div",37),c(1," Los apellidos deben tener al menos 3 caracteres. "),a())}function Vo(i,t){if(i&1&&(s(0,"div",37),c(1),a()),i&2){let e=g();m(),R(" ",e.backendFieldErrors.email," ")}}function Bo(i,t){i&1&&(s(0,"div",37),c(1," Ingresa un correo v\xE1lido. "),a())}function jo(i,t){i&1&&(s(0,"div",37),c(1," La fecha de nacimiento es obligatoria. "),a())}function qo(i,t){i&1&&(s(0,"div",37),c(1," Debes tener al menos 18 a\xF1os para registrarte. "),a())}function Go(i,t){if(i&1&&(s(0,"div",37),c(1),a()),i&2){let e=g();m(),R(" ",e.backendFieldErrors.username," ")}}function Ho(i,t){i&1&&(s(0,"div",37),c(1," El nombre de usuario debe tener al menos 4 caracteres. "),a())}function Ko(i,t){i&1&&(s(0,"div"),c(1,"La contrase\xF1a es requerida."),a())}function $o(i,t){i&1&&(s(0,"div"),c(1,"La contrase\xF1a debe tener al menos 8 caracteres."),a())}function Qo(i,t){i&1&&(s(0,"div"),c(1,"La contrase\xF1a no puede tener m\xE1s de 12 caracteres."),a())}function Wo(i,t){i&1&&(s(0,"div"),c(1," La contrase\xF1a debe tener entre 8 y 12 caracteres, incluir may\xFAsculas, min\xFAsculas, un n\xFAmero y uno de los siguientes caracteres especiales: !@#$%&* . "),a())}function Yo(i,t){if(i&1&&(s(0,"div",37),h(1,Ko,2,0,"div",38)(2,$o,2,0,"div",38)(3,Qo,2,0,"div",38)(4,Wo,2,0,"div",38),a()),i&2){g();let e=re(44);m(),u("ngIf",e.errors==null?null:e.errors.required),m(),u("ngIf",e.errors==null?null:e.errors.minlength),m(),u("ngIf",e.errors==null?null:e.errors.maxlength),m(),u("ngIf",e.errors==null?null:e.errors.pattern)}}function Zo(i,t){i&1&&(s(0,"div",37),c(1," Las contrase\xF1as no coinciden. "),a())}function Xo(i,t){i&1&&(s(0,"div",37),c(1," Debes aceptar los t\xE9rminos y condiciones para registrarte. "),a())}var hn=class i{constructor(t,e){this.router=t;this.authenticationService=e}username="";password="";confirmPassword="";email="";name="";lastName="";birthdate="";errorMessages=[];userAge=0;backendFieldErrors={};acceptTerms=!1;formSubmitted=!1;passwordVisible=!1;confirmPasswordVisible=!1;isSubmitting=!1;passwordRegex=/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[!@#$%&*]).{8,12}$/;validatePasswords(){this.errorMessages=[],this.password!==this.confirmPassword&&this.errorMessages.push("Las contrase\xF1as no coinciden."),this.passwordRegex.test(this.password)||this.errorMessages.push("La contrase\xF1a debe tener entre 8 y 12 caracteres, incluir may\xFAsculas, min\xFAsculas, un n\xFAmero y uno de los siguientes caracteres especiales: !@#$%^&*.")}onBirthdateChange(){let t=new Date(this.birthdate),e=new Date;this.userAge=e.getFullYear()-t.getFullYear();let n=e.getMonth()-t.getMonth();(n<0||n===0&&e.getDate()<t.getDate())&&this.userAge--,this.userAge<18&&this.errorMessages.push("Debes tener al menos 18 a\xF1os para registrarte.")}togglePasswordVisibility(){this.passwordVisible=!this.passwordVisible}toggleConfirmPasswordVisibility(){this.confirmPasswordVisible=!this.confirmPasswordVisible}get isFormValid(){return this.password===this.confirmPassword&&this.password.length>=8&&this.username.length>=3&&this.name.length>=2&&this.lastName.length>=2&&this.userAge>=18&&this.acceptTerms}cancel(){this.router.navigate(["/home"])}onSubmit(t){if(this.isSubmitting=!0,this.formSubmitted=!0,this.errorMessages=[],this.backendFieldErrors={},!t.valid||!this.acceptTerms){this.isSubmitting=!1;return}if(this.validatePasswords(),this.errorMessages.length>0){this.isSubmitting=!1;return}this.authenticationService.register(this.email,this.username,this.password,this.name,this.lastName,this.birthdate).subscribe(e=>{if(this.isSubmitting=!1,console.log("Respuesta del backend:",e),typeof e?.error=="string"){e.error.includes("correo")?this.backendFieldErrors.email=e.error:e.error.includes("usuario")?this.backendFieldErrors.username=e.error:this.errorMessages.push(e.error);return}e.message==="Usuario creado correctamente"&&this.router.navigate(["/"],{state:{message:"Usuario registrado con \xE9xito. Puedes iniciar sesi\xF3n cuando quieras."}})},e=>{this.isSubmitting=!1,this.errorMessages.push("Ocurri\xF3 un error al registrar el usuario. Int\xE9ntalo m\xE1s tarde."),console.error(e)})}static \u0275fac=function(e){return new(e||i)(y(A),y(ne))};static \u0275cmp=k({type:i,selectors:[["app-register"]],decls:65,vars:25,consts:[["registerForm","ngForm"],["nameField","ngModel"],["lastNameField","ngModel"],["emailField","ngModel"],["birthdateField","ngModel"],["usernameField","ngModel"],["passwordField","ngModel"],["confirmPasswordField","ngModel"],[1,"register-container"],[3,"ngSubmit"],["class","error-summary",4,"ngIf"],[1,"form-group"],["for","name"],["type","text","id","name","name","name","required","","minlength","3",3,"ngModelChange","ngModel"],["class","error-message",4,"ngIf"],["for","lastName"],["type","text","id","lastName","name","lastName","required","","minlength","3",3,"ngModelChange","ngModel"],["for","email"],["type","email","id","email","name","email","required","","email","",3,"ngModelChange","ngModel"],["for","birthdate"],["type","date","id","birthdate","name","birthdate","required","",3,"ngModelChange","change","ngModel"],["for","username"],["type","text","id","username","name","username","required","","minlength","4",3,"ngModelChange","ngModel"],[1,"form-group","password-group"],["for","password"],[1,"input-with-icon"],["id","password","name","password","required","","minlength","8","maxlength","12","pattern","^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[!@#$%^&*]).{8,12}$",3,"ngModelChange","type","ngModel"],[1,"fa",3,"click","ngClass"],["for","confirmPassword"],["id","confirmPassword","name","confirmPassword","required","",3,"ngModelChange","type","ngModel"],[1,"form-group","checkbox-group"],[1,"checkbox-label"],["type","checkbox","name","acceptTerms","required","",3,"ngModelChange","ngModel"],["type","submit",3,"disabled"],["type","button",1,"cancel-button",3,"click"],[1,"error-summary"],[4,"ngFor","ngForOf"],[1,"error-message"],[4,"ngIf"]],template:function(e,n){if(e&1){let r=V();s(0,"div",8)(1,"form",9,0),_("ngSubmit",function(){x(r);let l=re(2);return w(n.onSubmit(l))}),s(3,"h2"),c(4,"Registro de Usuario"),a(),h(5,No,3,1,"div",10),s(6,"div",11)(7,"label",12),c(8,"Nombre"),a(),s(9,"input",13,1),de("ngModelChange",function(l){return x(r),ce(n.name,l)||(n.name=l),w(l)}),a(),h(11,zo,2,0,"div",14),a(),s(12,"div",11)(13,"label",15),c(14,"Apellidos"),a(),s(15,"input",16,2),de("ngModelChange",function(l){return x(r),ce(n.lastName,l)||(n.lastName=l),w(l)}),a(),h(17,Lo,2,0,"div",14),a(),s(18,"div",11)(19,"label",17),c(20,"Correo electr\xF3nico"),a(),s(21,"input",18,3),de("ngModelChange",function(l){return x(r),ce(n.email,l)||(n.email=l),w(l)}),a(),h(23,Vo,2,1,"div",14)(24,Bo,2,0,"div",14),a(),s(25,"div",11)(26,"label",19),c(27,"Fecha de nacimiento"),a(),s(28,"input",20,4),de("ngModelChange",function(l){return x(r),ce(n.birthdate,l)||(n.birthdate=l),w(l)}),_("change",function(){return x(r),w(n.onBirthdateChange())}),a(),h(30,jo,2,0,"div",14)(31,qo,2,0,"div",14),a(),s(32,"div",11)(33,"label",21),c(34,"Usuario"),a(),s(35,"input",22,5),de("ngModelChange",function(l){return x(r),ce(n.username,l)||(n.username=l),w(l)}),a(),h(37,Go,2,1,"div",14)(38,Ho,2,0,"div",14),a(),s(39,"div",23)(40,"label",24),c(41,"Contrase\xF1a"),a(),s(42,"div",25)(43,"input",26,6),de("ngModelChange",function(l){return x(r),ce(n.password,l)||(n.password=l),w(l)}),a(),s(45,"i",27),_("click",function(){return x(r),w(n.togglePasswordVisibility())}),a()(),h(46,Yo,5,4,"div",14),a(),s(47,"div",23)(48,"label",28),c(49,"Confirmar Contrase\xF1a"),a(),s(50,"div",25)(51,"input",29,7),de("ngModelChange",function(l){return x(r),ce(n.confirmPassword,l)||(n.confirmPassword=l),w(l)}),a(),s(53,"i",27),_("click",function(){return x(r),w(n.toggleConfirmPasswordVisibility())}),a()(),h(54,Zo,2,0,"div",14),a(),s(55,"div",30)(56,"label",31)(57,"input",32),de("ngModelChange",function(l){return x(r),ce(n.acceptTerms,l)||(n.acceptTerms=l),w(l)}),a(),s(58,"span"),c(59," Acepto los t\xE9rminos y condiciones. "),a()(),h(60,Xo,2,0,"div",14),a(),s(61,"button",33),c(62,"Registrar"),a(),s(63,"button",34),_("click",function(){return x(r),w(n.cancel())}),c(64,"Cancelar"),a()()()}if(e&2){let r=re(10),o=re(16),l=re(22),d=re(29),p=re(36),f=re(44),b=re(52);m(5),u("ngIf",n.errorMessages.length),m(4),le("ngModel",n.name),m(2),u("ngIf",r.invalid&&r.touched),m(4),le("ngModel",n.lastName),m(2),u("ngIf",o.invalid&&o.touched),m(4),le("ngModel",n.email),m(2),u("ngIf",n.backendFieldErrors.email),m(),u("ngIf",l.invalid&&l.touched),m(4),le("ngModel",n.birthdate),m(2),u("ngIf",d.invalid&&d.touched),m(),u("ngIf",n.userAge>0&&n.userAge<18&&d.touched),m(4),le("ngModel",n.username),m(2),u("ngIf",n.backendFieldErrors.username),m(),u("ngIf",p.invalid&&p.touched),m(5),u("type",n.passwordVisible?"text":"password"),le("ngModel",n.password),m(2),u("ngClass",n.passwordVisible?"fa-eye":"fa-eye-slash"),m(),u("ngIf",f.touched&&f.invalid),m(5),u("type",n.confirmPasswordVisible?"text":"password"),le("ngModel",n.confirmPassword),m(2),u("ngClass",n.confirmPasswordVisible?"fa-eye":"fa-eye-slash"),m(),u("ngIf",b.touched&&n.confirmPassword!==n.password),m(3),le("ngModel",n.acceptTerms),m(3),u("ngIf",!n.acceptTerms&&n.formSubmitted),m(),u("disabled",!n.isFormValid)}},dependencies:[U,Be,$,K,Q,Ge,ye,mr,Ce,qe,mn,fr,gr,hr,ur,pr,nt,dn],styles:[`body{background-color:#ecd0a2!important;margin:0;padding:0}h2{color:#4e2b12;text-align:center;font-size:2rem;margin-bottom:1rem;text-shadow:1px 1px 3px #f4efef}.urban-login-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#000c;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px);display:flex;justify-content:center;align-items:center;z-index:1000}.register-modal-container{background:linear-gradient(145deg,#4e2b12,#3a1d0b);padding:2.5rem;border-radius:16px;width:90%;max-width:300px;color:#fff6e5;box-shadow:0 0 30px #0006}.register-modal-container{background:linear-gradient(145deg,#4e2b12,#3a1d0b);padding:2.5rem;border-radius:16px;width:90%;max-width:600px;color:#fff6e5;box-shadow:0 0 30px #0006}.register-container{max-width:480px;margin:2rem auto;padding:1.5rem 2rem;background-color:#3a1d0b;border-radius:15px;color:#fff6e5;box-shadow:0 0 20px #00000040;font-family:Segoe UI,sans-serif;font-size:.95rem}.register-title{text-align:center;color:#fc9;margin-bottom:rem;font-size:1.62rem;text-shadow:1px 1px 3px #000}.form-group{margin-bottom:1.5rem}label{display:block;font-weight:600;margin-bottom:.4rem;color:#ffe0bd}input{width:100%;padding:.6rem .8rem;border-radius:8px;border:1px solid #805333;background-color:#2e1a0f;color:#fff6e5;font-size:.95rem}input:focus{outline:none;border-color:#ffa366;box-shadow:0 0 8px #ffa36680}.input-with-icon{position:relative}.input-with-icon i{position:absolute;top:50%;right:12px;transform:translateY(-50%);color:#ffddb3;cursor:pointer}.input-with-icon i:hover{color:#ffa366}.error-message{color:#ff8a80;font-size:.85rem;margin-top:.3rem}.error-summary{background-color:#5c2c10;border-left:4px solid #ff5e5e;padding:1rem;margin-bottom:1.5rem;border-radius:8px;color:#faa;font-size:.9rem}.button-group{display:flex;flex-direction:column;gap:.8rem}.register-btn{background-color:#f4a261;color:#2b160a;border:none;border-radius:50px;padding:.9rem;font-size:1.1rem;font-weight:700;cursor:pointer;transition:background-color .3s ease}.register-btn:hover{background-color:#ffa366}button[type=submit]{background-color:#f4a261;color:#2b160a;border:none;border-radius:50px;padding:.9rem 1.6rem;font-size:1.1rem;font-weight:700;cursor:pointer;transition:background-color .3s ease,box-shadow .3s ease;box-shadow:0 4px 8px #f4a26166}button[type=submit]:hover:not(:disabled){background-color:#ffa366;box-shadow:0 6px 12px #ffa36699}button[type=submit]:disabled{background-color:#d4b28a;cursor:not-allowed;box-shadow:none;color:#6e4c2a}button.cancel-button{background-color:#5c3b28;color:#fff0e0;border:none;border-radius:50px;padding:.9rem 1.6rem;font-size:1.1rem;font-weight:700;cursor:pointer;transition:background-color .3s ease,box-shadow .3s ease;box-shadow:0 4px 8px #5c3b2866;margin-left:1rem}button.cancel-button:hover{background-color:#7a4a30;box-shadow:0 6px 12px #7a4a3099}.checkbox-group{margin:15px 0;font-size:.95rem}.checkbox-label{display:flex;align-items:center;gap:8px}.checkbox-label input[type=checkbox]{accent-color:brown;width:18px;height:18px}.checkbox-label a{color:#8b4513;text-decoration:underline}.checkbox-group .error-message{color:#b22222;font-size:.85rem;margin-top:4px}
`],encapsulation:2})};var Jo=i=>({"winner-photo":i});function ea(i,t){if(i&1){let e=V();s(0,"div",12),O(1,"img",13),s(2,"div",14)(3,"p",15),c(4),a(),s(5,"p",16),c(6),a(),s(7,"button",17),_("click",function(){let r=x(e).$implicit,o=g(2);return w(o.vote(r.id))}),c(8),a()()()}if(i&2){let e=t.$implicit,n=g().$implicit,r=g();u("ngClass",on(6,Jo,r.isWinner(e,n))),m(),u("src",e.photo_url,De),m(3),R("\u{1F4F8} ",e.autor,""),m(2),R("\u2764\uFE0F ",e.votos||0," votos"),m(),u("disabled",r.hasVoted(e.id)),m(),R(" ",r.hasVoted(e.id)?"Ya votaste":"Votar"," ")}}function ta(i,t){if(i&1&&(s(0,"div",8)(1,"h3"),c(2),a(),s(3,"p",9),c(4),W(5,"date"),W(6,"date"),a(),s(7,"div",10),h(8,ea,9,8,"div",11),a()()),i&2){let e=t.$implicit;m(2),D(e.title),m(2),rn(" \u{1F5D3}\uFE0F Del ",_e(5,4,e.start_date,"dd/MM/yyyy")," al ",_e(6,7,e.end_date,"dd/MM/yyyy")," "),m(4),u("ngForOf",e.photos)}}var _n=class i{constructor(t,e,n,r){this.photoService=t;this.router=e;this.route=n;this.sweetAlert=r}rallies=[];votedPhotos=new Set;currentPage=1;limit=6;totalPhotos=0;ngOnInit(){this.loadRallies()}loadRallies(){this.photoService.getFotosAprobadasPaginated(this.currentPage,this.limit).subscribe({next:t=>{console.log("Fotos aprobadas:",t),this.rallies=this.groupPhotosByRally(t.photos||[]),this.totalPhotos=t.totalPhotos||0,this.loadVotedPhotos(),this.setWinners()},error:t=>{console.error("Error al cargar fotos aprobadas:",t)}})}setWinners(){this.rallies.forEach(t=>{let e=0,n=[];t.photos.forEach(r=>{r.votos>e?(e=r.votos,n=[r]):r.votos===e&&n.push(r)}),e>0?t.winnerPhoto=n:t.winnerPhoto=[]})}isWinner(t,e){return e.winnerPhoto?.some(n=>n.id===t.id)??!1}groupPhotosByRally(t){let e={};return t.forEach(n=>{n.photo_url=`${oe.apiUrl}/${n.photo_url}`;let r=n.rally_id;e[r]||(e[r]={id:r,title:n.rally_title||"Rally sin nombre",start_date:n.rally_start_date,end_date:n.rally_end_date,photos:[]}),e[r].photos.push(n)}),Object.values(e)}loadVotedPhotos(){let t=localStorage.getItem("userId");if(t){let e=localStorage.getItem(`userVotedPhotos_${t}`);e&&(this.votedPhotos=new Set(JSON.parse(e)))}}hasVoted(t){return this.votedPhotos.has(t)}vote(t){let e=localStorage.getItem("userId"),n=parseInt(e||"",10);if(!e||isNaN(n)){this.sweetAlert.info("Debes iniciar sesi\xF3n para votar.");return}if(this.hasVoted(t)){this.sweetAlert.info("Ya has votado por esta foto.");return}this.photoService.vote(t,n).subscribe({next:r=>{console.log("Voto registrado correctamente:",r);let o=this.findPhotoById(t);o&&(o.votos=(o.votos||0)+1),this.votedPhotos.add(t),localStorage.setItem(`userVotedPhotos_${e}`,JSON.stringify(Array.from(this.votedPhotos))),this.sweetAlert.success("\xA1Voto registrado!","\xA1Gracias por participar!")},error:r=>{console.error("Error al votar:",r),this.sweetAlert.error("Error al votar: "+(r.error?.error||"Intenta m\xE1s tarde."))}})}findPhotoById(t){for(let e of this.rallies){let n=e.photos.find(r=>r.id===t);if(n)return n}return null}nextPage(){this.currentPage*this.limit<this.totalPhotos&&(this.currentPage++,this.loadRallies())}prevPage(){this.currentPage>1&&(this.currentPage--,this.loadRallies())}hasMorePhotos(){return this.currentPage*this.limit<this.totalPhotos}goBackToHome(){this.route.snapshot.queryParamMap.get("from")==="dashboard"?this.router.navigate(["/user/dashboard"]):this.router.navigate(["/home"])}static \u0275fac=function(e){return new(e||i)(y(He),y(A),y(tt),y(Ae))};static \u0275cmp=k({type:i,selectors:[["app-gallery"]],decls:15,vars:4,consts:[[1,"app-gallery"],[1,"app-gallery-content"],["class","rally-card",4,"ngFor","ngForOf"],[1,"pagination-container"],[1,"pagination-btn",3,"click","disabled"],[1,"page-number"],[1,"button-container"],[1,"back-button",3,"click"],[1,"rally-card"],[1,"rally-dates"],[1,"photos-grid"],["class","photo-card",3,"ngClass",4,"ngFor","ngForOf"],[1,"photo-card",3,"ngClass"],["alt","Foto del rally",3,"src"],[1,"photo-info"],[1,"author"],[1,"votos"],[1,"btn-vote",3,"click","disabled"]],template:function(e,n){e&1&&(s(0,"div",0)(1,"div",1)(2,"h2"),c(3,"Galer\xEDa del Rally"),a(),h(4,ta,9,10,"div",2),s(5,"div",3)(6,"button",4),_("click",function(){return n.prevPage()}),c(7,"Anterior"),a(),s(8,"span",5),c(9),a(),s(10,"button",4),_("click",function(){return n.nextPage()}),c(11,"Siguiente"),a()()(),s(12,"div",6)(13,"button",7),_("click",function(){return n.goBackToHome()}),c(14,"Volver"),a()()()),e&2&&(m(4),u("ngForOf",n.rallies),m(2),u("disabled",n.currentPage===1),m(3),D(n.currentPage),m(),u("disabled",!n.hasMorePhotos()))},dependencies:[U,Be,$,ve],styles:['@font-face{font-family:Merriweather;font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(https://fonts.gstatic.com/s/merriweather/v31/u-4D0qyriQwlOrhSvowK_l5UcA6zuSYEqOzpPe3HOZJ5eX1WtLaQwmYiScCmDxhtNOKl8yDr3icaGV31GvU.woff2) format("woff2");unicode-range:U+0460-052F,U+1C80-1C8A,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:Merriweather;font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(https://fonts.gstatic.com/s/merriweather/v31/u-4D0qyriQwlOrhSvowK_l5UcA6zuSYEqOzpPe3HOZJ5eX1WtLaQwmYiScCmDxhtNOKl8yDr3icaEF31GvU.woff2) format("woff2");unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:Merriweather;font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(https://fonts.gstatic.com/s/merriweather/v31/u-4D0qyriQwlOrhSvowK_l5UcA6zuSYEqOzpPe3HOZJ5eX1WtLaQwmYiScCmDxhtNOKl8yDr3icaG131GvU.woff2) format("woff2");unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:Merriweather;font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(https://fonts.gstatic.com/s/merriweather/v31/u-4D0qyriQwlOrhSvowK_l5UcA6zuSYEqOzpPe3HOZJ5eX1WtLaQwmYiScCmDxhtNOKl8yDr3icaGl31GvU.woff2) format("woff2");unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:Merriweather;font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(https://fonts.gstatic.com/s/merriweather/v31/u-4D0qyriQwlOrhSvowK_l5UcA6zuSYEqOzpPe3HOZJ5eX1WtLaQwmYiScCmDxhtNOKl8yDr3icaFF31.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}[_nghost-%COMP%]{font-family:Merriweather,serif;background-size:cover;min-height:80vh;color:#5c3a1e}html[_ngcontent-%COMP%], body[_ngcontent-%COMP%]{margin:0;padding:0;height:100%}.app-gallery[_ngcontent-%COMP%]{background:url(/images/fondo3.jpg) no-repeat center center;background-size:cover;min-height:100vh;padding:2rem;color:#5c3a1e}.app-gallery-content[_ngcontent-%COMP%]{max-width:1000px;margin:0 auto;background:#fdf7edcc;border-radius:10px;padding:1.5rem 2rem;margin-bottom:2rem;box-shadow:0 4px 12px #7b4f244d}.app-gallery[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{text-align:center;font-size:3rem;margin-bottom:1.5rem;color:#4a2c14;text-shadow:1px 1px 2px #d4a373}.rally-card[_ngcontent-%COMP%]{margin-bottom:2rem;border:1px solid #e0c9a6;border-radius:10px;padding:1rem 1.5rem;background:#f2d388;box-shadow:0 2px 8px #8b45131a}.rally-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 .3rem;font-size:1.8rem;font-weight:700;color:#5c3a1e}.rally-dates[_ngcontent-%COMP%]{font-size:1rem;margin-bottom:1rem;font-weight:600;color:#6e4b19}.photos-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:1rem;justify-items:center}.photo-card[_ngcontent-%COMP%]{background:#fffaf5;border-radius:10px;box-shadow:0 2px 8px #8b451326;overflow:hidden;width:220px;display:flex;flex-direction:column;transition:transform .3s ease;cursor:pointer}.photo-card[_ngcontent-%COMP%]:hover{transform:translateY(-5px);box-shadow:0 10px 20px #8b45134d}.photo-card.winner-photo[_ngcontent-%COMP%]{border:3px solid #4CAF50}.photo-card[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:auto;display:block;border-bottom:1px solid #d4a373}.photo-info[_ngcontent-%COMP%]{padding:.8rem 1rem;text-align:center;font-size:.9rem;color:#5c3a1e;flex-grow:1;display:flex;flex-direction:column;justify-content:space-between}.photo-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:.3rem 0;font-weight:600}.btn-vote[_ngcontent-%COMP%]{margin-top:.5rem;background-color:sienna;border:none;color:#fff;padding:.5rem;border-radius:6px;font-weight:700;cursor:pointer;transition:background-color .3s ease}.btn-vote[_ngcontent-%COMP%]:disabled{background-color:#ccc;cursor:not-allowed;color:#666}.btn-vote[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#8b4513}.pagination-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;gap:1rem;margin:2rem 0 1rem}.pagination-btn[_ngcontent-%COMP%]{background-color:sienna;border:none;color:#fff;padding:.6rem 1.2rem;border-radius:6px;font-weight:700;cursor:pointer;transition:background-color .3s ease}.pagination-btn[_ngcontent-%COMP%]:disabled{background-color:#ccc;cursor:not-allowed;color:#666}.pagination-btn[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#8b4513}.page-number[_ngcontent-%COMP%]{font-size:1.2rem;font-weight:700;color:#5c3a1e}.button-container[_ngcontent-%COMP%]{text-align:center;margin-bottom:2rem}.back-button[_ngcontent-%COMP%]{background-color:#8b4513;color:#fff;border:none;padding:.6rem 1.2rem;border-radius:6px;cursor:pointer;font-size:1rem;font-weight:700;transition:background-color .3s ease}.back-button[_ngcontent-%COMP%]:hover{background-color:sienna}@media (max-width: 600px){.app-gallery[_ngcontent-%COMP%]{padding:1rem}.app-gallery[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:2rem}.rally-card[_ngcontent-%COMP%]{padding:1rem}.rally-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.4rem}.rally-dates[_ngcontent-%COMP%]{font-size:.9rem}.photos-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:1rem}.photo-card[_ngcontent-%COMP%]{width:100%}.photo-info[_ngcontent-%COMP%]{font-size:.85rem;padding:.6rem .8rem}.btn-vote[_ngcontent-%COMP%]{padding:.4rem;font-size:.9rem}.pagination-btn[_ngcontent-%COMP%]{padding:.4rem .8rem;font-size:.9rem}.back-button[_ngcontent-%COMP%]{width:100%}}@media (min-width: 601px) and (max-width: 900px){.photos-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}.rally-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.6rem}.btn-vote[_ngcontent-%COMP%]{font-size:1rem}}@media (min-width: 901px){.photos-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(3,1fr)}}']})};var we=class i{constructor(t){this.http=t}apiUrl=`${oe.apiUrl}/rallies.php`;apiInscripcionesUrl=`${oe.apiUrl}/inscripciones.php`;apiUploadPhotosUrl=`${oe.apiUrl}/fotos.php`;ralliesSubject=new bt([]);rallies$=this.ralliesSubject.asObservable();userInscriptionsSubject=new bt([]);userInscriptions$=this.userInscriptionsSubject.asObservable();getAllRallies(){return this.http.get(this.apiUrl).pipe(Ve(t=>this.ralliesSubject.next(t)),ge(t=>(console.error("Error al obtener rallies:",t),Fe(()=>new Error(t)))))}createRally(t){return this.http.post(this.apiUrl,t,{observe:"response"}).pipe(Ve(e=>{let n=e.body,r=this.ralliesSubject.value||[];this.ralliesSubject.next([...r,n])}),ge(e=>(console.error("Error al crear rally:",e),Fe(()=>new Error(e.message||"Error desconocido")))))}updateRally(t,e){let n=fe(B({},e),{action:"update",id:t});return this.http.post(this.apiUrl,n).pipe(Ve(r=>{let o=this.ralliesSubject.value||[],l=o.findIndex(d=>d.id===t);l!==-1&&(o[l]=r,this.ralliesSubject.next([...o]))}),ge(r=>(console.error("Error al actualizar rally:",r),Fe(()=>new Error(r)))))}getRallyById(t){return this.http.get(`${this.apiUrl}?id=${t}`).pipe(ge(e=>(console.error("Error al obtener rally por ID:",e),Fe(()=>new Error(e)))))}deleteRally(t){let e={action:"delete",id:t};return this.http.post(this.apiUrl,e).pipe(Ve(()=>{let n=this.ralliesSubject.value||[];this.ralliesSubject.next(n.filter(r=>r.id!==t))}),ge(n=>(console.error("Error al eliminar rally:",n),Fe(()=>new Error(n)))))}loadUserInscriptions(t){this.http.get(`${this.apiInscripcionesUrl}?userId=${t}`).pipe(Ve(e=>console.log("Respuesta inscripciones:",e)),vt(e=>Array.isArray(e.inscritos)?e.inscritos.map(n=>n.id):[]),ge(e=>(console.error("Error al cargar inscripciones:",e),Nt([])))).subscribe({next:e=>this.userInscriptionsSubject.next(e),error:()=>this.userInscriptionsSubject.next([])})}getFotosAprobadasPorUsuario(t){return this.http.get(`${this.apiUrl}/fotos.php?action=getApprovedPhotosByUser&userId=${t}`).pipe(vt(e=>e.ralliesConFotoAprobada))}toggleInscripcion(t,e,n){let r={rallyId:t,userId:e,action:n?"desinscribir":"inscribir"};return this.http.post(this.apiInscripcionesUrl,r,{headers:{"Content-Type":"application/json"}}).pipe(Ve(o=>{o.success&&this.loadUserInscriptions(e)}),vt(o=>o),ge(o=>(console.error("Error HTTP o conexi\xF3n:",o),Fe(()=>({success:!1,message:o.message||"Error de conexi\xF3n o servidor"})))))}cancelarInscripcion(t){let e=parseInt(localStorage.getItem("userId")||"0",10);return e?this.cancelarInscripcionBackend(t,e):(console.error("Usuario no autenticado."),Nt(null))}cancelarInscripcionBackend(t,e){let n={rallyId:t,userId:e,action:"desinscribir"};return this.http.post(this.apiInscripcionesUrl,n,{headers:{"Content-Type":"application/json"}}).pipe(ge(r=>(console.error("Error al cancelar inscripci\xF3n:",r),Fe(()=>new Error(r)))))}uploadPhotos(t,e){let n=new FormData;e.forEach(r=>n.append("photos[]",r,r.name));for(let r of e)if(!r.type.startsWith("image/"))throw console.error("Solo se pueden subir im\xE1genes."),new Error("Solo se pueden subir im\xE1genes.");return this.http.post(`${this.apiUploadPhotosUrl}?rallyId=${t}`,n).pipe(ge(r=>(console.error("Error al subir fotos:",r),Fe(()=>new Error(r)))))}getFotosSubidas(t,e){let n=`${this.apiInscripcionesUrl}?rallyId=${t}&userId=${e}`;return this.http.get(n).pipe(vt(r=>r.count||0),ge(r=>(console.error("Error al obtener fotos subidas:",r),Nt(0))))}getFotosAprobadas(t,e){let n=`${this.apiUploadPhotosUrl}?action=checkAprobadas&rallyId=${t}&userId=${e}`;return this.http.get(n).pipe(vt(r=>!!r.aprobadas),ge(r=>(console.error("Error al comprobar fotos aprobadas:",r),Nt(!1))))}static \u0275fac=function(e){return new(e||i)(q(et))};static \u0275prov=Y({token:i,factory:i.\u0275fac,providedIn:"root"})};function na(i,t){if(i&1&&(s(0,"li",3)(1,"div",4),O(2,"i"),s(3,"div",5)(4,"h3"),c(5),a(),s(6,"p"),c(7),a(),s(8,"p"),c(9," Inicio: "),s(10,"span"),c(11),W(12,"date"),a(),c(13," - Fin: "),s(14,"span"),c(15),W(16,"date"),a()()()()()),i&2){let e=t.$implicit,n=g();m(2),he(n.getIconClassByTheme(e.theme)+" icono-tema-preview"),m(3),D(e.title),m(2),D(e.description),m(4),D(_e(12,6,e.start_date,"dd/MM/yyyy")),m(4),D(_e(16,9,e.end_date,"dd/MM/yyyy"))}}var bn=class i{constructor(t,e){this.rallyService=t;this.router=e}ralliesProximos=[];ngOnInit(){this.rallyService.getAllRallies().subscribe(t=>{let e=new Date;this.ralliesProximos=t.filter(n=>new Date(n.start_date)>e),console.log("Rallies pr\xF3ximos:",this.ralliesProximos)})}getIconClassByTheme(t){if(!t)return"fa-solid fa-question";switch(t.trim().toLowerCase()){case"fotografia":return"fa-solid fa-camera-retro";case"naturaleza":return"fa-solid fa-tree";case"deporte":return"fa-solid fa-person-hiking";case"animales":return"fa-solid fa-paw";case"comida":return"fa-solid fa-utensils";case"mar y playa":return"fa-solid fa-umbrella-beach";case"paisaje urbano":return"fa-solid fa-city";default:return"fa-solid fa-question"}}volverAlPanelUsuario(){this.router.navigate(["user/dashboard"])}static \u0275fac=function(e){return new(e||i)(y(we),y(A))};static \u0275cmp=k({type:i,selectors:[["app-proximos-rallies"]],decls:6,vars:1,consts:[["class","card horizontal-card p-3 mb-3",4,"ngFor","ngForOf"],[1,"button-container"],[1,"btn",3,"click"],[1,"card","horizontal-card","p-3","mb-3"],[1,"d-flex","align-items-center"],[1,"flex-grow-1"]],template:function(e,n){e&1&&(s(0,"h2"),c(1,"Pr\xF3ximos Rallies"),a(),h(2,na,17,12,"li",0),s(3,"div",1)(4,"button",2),_("click",function(){return n.volverAlPanelUsuario()}),c(5,"Volver"),a()()),e&2&&(m(2),u("ngForOf",n.ralliesProximos))},dependencies:[U,$,ve,Q],styles:[".horizontal-card[_ngcontent-%COMP%]{background:#f2d388;border-radius:12px;box-shadow:0 6px 14px #d2a04673;color:#4b2e05;transition:transform .3s ease;cursor:pointer;margin-left:2rem;margin-right:2rem;margin-top:2rem}h2[_ngcontent-%COMP%]{text-align:center;margin-top:1rem;color:#4b2e05;font-size:2rem;font-weight:700;text-shadow:1px 1px 1px #7b4f24}.horizontal-card[_ngcontent-%COMP%]:hover{transform:translateY(-5px);box-shadow:0 10px 20px #d2a04699}.horizontal-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-top:0;font-weight:700;text-shadow:1px 1px 2px #7b4f24}p[_ngcontent-%COMP%]{font-size:1.2rem;color:#4b2e05}.horizontal-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:700;color:#7b4f24}i[_ngcontent-%COMP%], .material-symbols-outlined[_ngcontent-%COMP%]{font-size:3rem!important;margin-right:1rem;vertical-align:middle;color:#5c2c10!important}.btn[_ngcontent-%COMP%]{background-color:sienna;color:#fff;border:none;padding:.6rem 1.2rem;border-radius:5px;cursor:pointer;transition:background-color .3s ease;font-size:1rem;font-weight:700;text-align:center;display:block;margin:1rem auto}.btn[_ngcontent-%COMP%]:hover{background-color:#8b4513}.btn[_ngcontent-%COMP%]   back[_ngcontent-%COMP%]{background-color:#8b4513;color:#fff;border:none;padding:.6rem 1.2rem;border-radius:5px;cursor:pointer;transition:background-color .3s ease;font-size:1rem;font-weight:700;text-align:center}"]})};function ia(i,t){if(i&1){let e=V();Pe(0),s(1,"button",14),_("click",function(){x(e);let r=g().$implicit,o=g(2);return w(o.alternarInscripcion(r.id))}),c(2),a(),Oe()}if(i&2){let e=g().$implicit,n=g(2);m(),u("disabled",n.haCompletadoRally(e.id)),m(),R(" ",n.haCompletadoRally(e.id)?"Inscripci\xF3n completada":"Anular Inscripci\xF3n"," ")}}function ra(i,t){if(i&1){let e=V();s(0,"button",15),_("click",function(){x(e);let r=g().$implicit,o=g(2);return w(o.alternarInscripcion(r.id))}),c(1),a()}if(i&2){let e=g().$implicit,n=g(2);u("disabled",n.haCompletadoRally(e.id)),m(),R(" ",n.haCompletadoRally(e.id)?"Inscripci\xF3n completada":"Inscribirse"," ")}}function oa(i,t){if(i&1&&(s(0,"li",7)(1,"div",8),O(2,"i"),s(3,"div",9)(4,"h3",10),c(5),a(),s(6,"p",11),c(7),a(),s(8,"p",12)(9,"strong"),c(10,"Inicio:"),a(),c(11),W(12,"date"),s(13,"strong"),c(14,"Fin:"),a(),c(15),W(16,"date"),a()()(),s(17,"div",13),h(18,ia,3,2,"ng-container",3)(19,ra,2,2,"ng-template",null,1,ti),a()()),i&2){let e=t.$implicit,n=re(20),r=g(2);m(2),he(r.getIconClassByTheme(e.theme)+" icono-tema-preview fs-2 text-primary"),m(3),D(e.title),m(2),D(e.description),m(4),R(" ",_e(12,8,e.start_date,"dd/MM/yyyy")," \xA0|\xA0 "),m(4),R(" ",_e(16,11,e.end_date,"dd/MM/yyyy")," "),m(3),u("ngIf",r.estaInscrito(e.id))("ngIfElse",n)}}function aa(i,t){if(i&1&&(s(0,"ul"),h(1,oa,21,14,"li",6),a()),i&2){let e=g();m(),u("ngForOf",e.ralliesActuales)}}function sa(i,t){i&1&&(s(0,"p"),c(1,"No hay rallies actualmente."),a())}var vn=class i{constructor(t,e,n,r){this.rallyService=t;this.router=e;this.cdRef=n;this.sweetAlert=r}ralliesActuales=[];userInscriptions=[];fotosCompletadas={};fotosAprobadas={};subscriptions=new qi;ngOnInit(){let t=this.rallyService.getAllRallies().subscribe(e=>{let n=new Date;n.setHours(0,0,0,0),this.ralliesActuales=e.filter(o=>{let l=new Date(o.start_date),d=new Date(o.end_date);return l.setHours(0,0,0,0),d.setHours(0,0,0,0),l<=n&&d>=n});let r=parseInt(localStorage.getItem("userId")||"0",10);if(r){this.rallyService.loadUserInscriptions(r);let o=this.rallyService.userInscriptions$.subscribe(l=>{this.userInscriptions=l,this.fotosCompletadas={},l.forEach(d=>{this.fotosAprobadas[d]=!1;let p=this.rallyService.getFotosSubidas(d,r).subscribe(b=>{this.fotosCompletadas[d]=b,this.cdRef.detectChanges()});this.subscriptions.add(p);let f=this.rallyService.getFotosAprobadas(d,r).subscribe(b=>{this.fotosAprobadas[d]=b,this.cdRef.detectChanges()});this.subscriptions.add(f)}),this.cdRef.detectChanges()});this.subscriptions.add(o)}});this.subscriptions.add(t)}ngOnDestroy(){this.subscriptions.unsubscribe()}estaInscrito(t){return this.userInscriptions.includes(t)}alternarInscripcion(t){let e=parseInt(localStorage.getItem("userId")||"0",10);if(!e){console.error("Usuario no autenticado.");return}let n=this.estaInscrito(t);if(n){let r=this.fotosAprobadas[t];if(r===void 0){this.sweetAlert.warning("Espera un momento","Comprobando tus fotos aprobadas...");return}if(r){this.sweetAlert.warning("No puedes darte de baja","Ya tienes una foto aprobada en este rally.");return}}this.rallyService.toggleInscripcion(t,e,n).subscribe(r=>{r.success?(n?(this.userInscriptions=this.userInscriptions.filter(o=>o!==t),delete this.fotosCompletadas[t]):(this.userInscriptions.push(t),this.fotosCompletadas[t]=0),this.cdRef.detectChanges()):this.sweetAlert.error("Error",r.message||"Error al alternar inscripci\xF3n.")},r=>{this.sweetAlert.error("Error de conexi\xF3n",r.message||"Int\xE9ntalo m\xE1s tarde.")})}getIconClassByTheme(t){if(!t)return"fa-solid fa-question";switch(t.trim().toLowerCase()){case"fotografia":return"fa-solid fa-camera-retro";case"naturaleza":return"fa-solid fa-tree";case"deporte":return"fa-solid fa-person-hiking";case"animales":return"fa-solid fa-paw";case"comida":return"fa-solid fa-utensils";case"mar y playa":return"fa-solid fa-umbrella-beach";case"paisaje urbano":return"fa-solid fa-city";default:return"fa-solid fa-question"}}haCompletadoRally(t){return(this.fotosCompletadas[t]||0)>=3}volverAlPanelUsuario(){this.router.navigate(["user/dashboard"])}static \u0275fac=function(e){return new(e||i)(y(we),y(A),y(ir),y(Ae))};static \u0275cmp=k({type:i,selectors:[["app-rallies-actuales"]],decls:8,vars:2,consts:[["sinRallies",""],["noInscrito",""],[1,"mb-4","text-center","text-uppercase","text-brown"],[4,"ngIf","ngIfElse"],[1,"button-container","text-center","mt-4"],[1,"btn","btn-secondary","px-4","rounded-pill",3,"click"],["class","card p-4 mb-4 shadow-sm rounded-4 border-0 bg-light",4,"ngFor","ngForOf"],[1,"card","p-4","mb-4","shadow-sm","rounded-4","border-0","bg-light"],[1,"d-flex","flex-column","flex-md-row","align-items-start","align-items-md-center","gap-3"],[1,"flex-grow-1"],[1,"mb-2","text-dark"],[1,"mb-1","text-muted"],[1,"mb-0"],[1,"button-wrapper","mt-3","text-end"],[1,"btn","btn-outline-danger","px-4","rounded-pill",3,"click","disabled"],[1,"btn","btn-primary","px-4","rounded-pill",3,"click","disabled"]],template:function(e,n){if(e&1){let r=V();s(0,"h2",2),c(1,"Rallies Actuales"),a(),h(2,aa,2,1,"ul",3)(3,sa,2,0,"ng-template",null,0,ti),s(5,"div",4)(6,"button",5),_("click",function(){return x(r),w(n.volverAlPanelUsuario())}),c(7,"Volver"),a()()}if(e&2){let r=re(4);m(2),u("ngIf",n.ralliesActuales.length>0)("ngIfElse",r)}},dependencies:[U,$,K,ve,Q],styles:['@font-face{font-family:Merriweather;font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(https://fonts.gstatic.com/s/merriweather/v31/u-4D0qyriQwlOrhSvowK_l5UcA6zuSYEqOzpPe3HOZJ5eX1WtLaQwmYiScCmDxhtNOKl8yDr3icaGV31GvU.woff2) format("woff2");unicode-range:U+0460-052F,U+1C80-1C8A,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:Merriweather;font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(https://fonts.gstatic.com/s/merriweather/v31/u-4D0qyriQwlOrhSvowK_l5UcA6zuSYEqOzpPe3HOZJ5eX1WtLaQwmYiScCmDxhtNOKl8yDr3icaEF31GvU.woff2) format("woff2");unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:Merriweather;font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(https://fonts.gstatic.com/s/merriweather/v31/u-4D0qyriQwlOrhSvowK_l5UcA6zuSYEqOzpPe3HOZJ5eX1WtLaQwmYiScCmDxhtNOKl8yDr3icaG131GvU.woff2) format("woff2");unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:Merriweather;font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(https://fonts.gstatic.com/s/merriweather/v31/u-4D0qyriQwlOrhSvowK_l5UcA6zuSYEqOzpPe3HOZJ5eX1WtLaQwmYiScCmDxhtNOKl8yDr3icaGl31GvU.woff2) format("woff2");unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:Merriweather;font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(https://fonts.gstatic.com/s/merriweather/v31/u-4D0qyriQwlOrhSvowK_l5UcA6zuSYEqOzpPe3HOZJ5eX1WtLaQwmYiScCmDxhtNOKl8yDr3icaFF31.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}[_nghost-%COMP%]{font-family:Merriweather,serif;background-size:cover;min-height:80vh;padding:1rem;color:#4b2e05}h2[_ngcontent-%COMP%]{text-align:center;margin-top:1rem;color:#4b2e05;font-size:2.5rem;font-weight:700;text-shadow:1px 1px 1px #7b4f24}.text-brown[_ngcontent-%COMP%]{color:#6c4c3b}.icono-tema-preview[_ngcontent-%COMP%]{font-size:2rem;color:#b08968}ul[_ngcontent-%COMP%]{padding-left:0;margin:0 auto;max-width:900px;list-style:none}.horizontal-card[_ngcontent-%COMP%]{background:#f2d388;border-radius:12px;box-shadow:0 6px 14px #d2a04673;color:#4b2e05;transition:transform .3s ease;cursor:pointer;margin:1.5rem 2rem;display:flex;align-items:center;gap:1rem;padding:1rem 1.5rem}.horizontal-card[_ngcontent-%COMP%]:hover{transform:translateY(-5px);box-shadow:0 10px 20px #d2a04699}i[_ngcontent-%COMP%], .material-symbols-outlined[_ngcontent-%COMP%]{font-size:3rem!important;color:#5c2c10!important;flex-shrink:0}.horizontal-card[_ngcontent-%COMP%] > div.flex-grow-1[_ngcontent-%COMP%]{flex-grow:1}.horizontal-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-top:0;font-weight:700;text-shadow:1px 1px 2px #7b4f24;text-align:left;font-size:1.8rem;margin-bottom:.3rem}.horizontal-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1.2rem;margin:.3rem 0}.horizontal-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:700;color:#7b4f24}.btn[_ngcontent-%COMP%], .cancelar-btn[_ngcontent-%COMP%], .apuntarme-btn[_ngcontent-%COMP%]{background-color:sienna;color:#fff;border:none;padding:.6rem 1.2rem;border-radius:5px;cursor:pointer;transition:background-color .3s ease;font-size:1rem;font-weight:700;text-align:center;min-width:130px;white-space:nowrap}.btn[_ngcontent-%COMP%]:hover, .cancelar-btn[_ngcontent-%COMP%]:hover, .apuntarme-btn[_ngcontent-%COMP%]:hover{background-color:#8b4513}.cancelar-btn[_ngcontent-%COMP%]{background-color:#cc4b37}.cancelar-btn[_ngcontent-%COMP%]:hover{background-color:#a43a29}.apuntarme-btn[_ngcontent-%COMP%]{background-color:#4b8b3b}.apuntarme-btn[_ngcontent-%COMP%]:hover{background-color:#3a6b2b}.button-container[_ngcontent-%COMP%]{text-align:center;margin:2rem 0}@media (max-width: 600px){.horizontal-card[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;margin:1rem;padding:1rem}i[_ngcontent-%COMP%], .material-symbols-outlined[_ngcontent-%COMP%]{font-size:2.5rem!important;margin-bottom:.5rem}.horizontal-card[_ngcontent-%COMP%] > div.flex-grow-1[_ngcontent-%COMP%]{width:100%;margin-bottom:1rem}.horizontal-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.5rem}.horizontal-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1rem}.btn[_ngcontent-%COMP%], .cancelar-btn[_ngcontent-%COMP%], .apuntarme-btn[_ngcontent-%COMP%]{width:100%;min-width:unset;font-size:1.1rem;padding:.7rem 0}}@media (min-width: 601px) and (max-width: 900px){.horizontal-card[_ngcontent-%COMP%]{margin:1.5rem 1rem;padding:1rem 1.2rem}i[_ngcontent-%COMP%], .material-symbols-outlined[_ngcontent-%COMP%]{font-size:2.8rem!important}.horizontal-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.6rem}.horizontal-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1.1rem}.btn[_ngcontent-%COMP%], .cancelar-btn[_ngcontent-%COMP%], .apuntarme-btn[_ngcontent-%COMP%]{min-width:140px;font-size:1rem;padding:.6rem 1rem}}@media (min-width: 901px){.horizontal-card[_ngcontent-%COMP%]{margin:2rem;padding:1.2rem 1.5rem}i[_ngcontent-%COMP%], .material-symbols-outlined[_ngcontent-%COMP%]{font-size:3rem!important}.horizontal-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.8rem}.horizontal-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1.2rem}.btn[_ngcontent-%COMP%], .cancelar-btn[_ngcontent-%COMP%], .apuntarme-btn[_ngcontent-%COMP%]{min-width:130px}}']})};function la(i,t){if(i&1&&(s(0,"li",3)(1,"div",4),O(2,"i"),s(3,"div",5)(4,"h3"),c(5),a(),s(6,"p"),c(7),a(),s(8,"p"),c(9," Inicio: "),s(10,"span"),c(11),W(12,"date"),a(),c(13," - Fin: "),s(14,"span"),c(15),W(16,"date"),a()()()()()),i&2){let e=t.$implicit,n=g();m(2),he(n.getIconClassByTheme(e.theme)+" icono-tema-preview"),m(3),D(e.title),m(2),D(e.description),m(4),D(_e(12,6,e.start_date,"dd/MM/yyyy")),m(4),D(_e(16,9,e.end_date,"dd/MM/yyyy"))}}var yn=class i{constructor(t,e){this.rallyService=t;this.router=e}ralliesPasados=[];rallies;ngOnInit(){this.rallyService.getAllRallies().subscribe(t=>{console.log("TODOS LOS RALLIES:",t);let e=new Date;e.setHours(0,0,0,0),this.ralliesPasados=t.filter(n=>{let r=new Date(n.end_date);r.setHours(0,0,0,0);let o=r<e;return console.log(`Rally: ${n.title} - Fin: ${r.toISOString()} - \xBFPasado?: ${o}`),o}),console.log("Rallies pasados:",this.ralliesPasados)})}getIconClassByTheme(t){if(!t)return"fa-solid fa-question";switch(t.trim().toLowerCase()){case"fotografia":return"fa-solid fa-camera-retro";case"naturaleza":return"fa-solid fa-tree";case"deporte":return"fa-solid fa-person-hiking";case"animales":return"fa-solid fa-paw";case"comida":return"fa-solid fa-utensils";case"mar y playa":return"fa-solid fa-umbrella-beach";case"paisaje urbano":return"fa-solid fa-city";default:return"fa-solid fa-question"}}volverAlPanelUsuario(){this.router.navigate(["user/dashboard"])}static \u0275fac=function(e){return new(e||i)(y(we),y(A))};static \u0275cmp=k({type:i,selectors:[["app-rallies-pasados"]],decls:6,vars:1,consts:[["class","card horizontal-card p-3 mb-3",4,"ngFor","ngForOf"],[1,"button-container"],[1,"btn",3,"click"],[1,"card","horizontal-card","p-3","mb-3"],[1,"d-flex","align-items-center"],[1,"flex-grow-1"]],template:function(e,n){e&1&&(s(0,"h2"),c(1,"Rallies Pasados"),a(),h(2,la,17,12,"li",0),s(3,"div",1)(4,"button",2),_("click",function(){return n.volverAlPanelUsuario()}),c(5,"Volver"),a()()),e&2&&(m(2),u("ngForOf",n.ralliesPasados))},dependencies:[U,$,ve,Q],styles:[".horizontal-card[_ngcontent-%COMP%]{background:#f2d388;border-radius:12px;box-shadow:0 6px 14px #d2a04673;color:#4b2e05;transition:transform .3s ease;cursor:pointer;margin-left:2rem;margin-right:2rem;margin-top:2rem;display:flex}h2[_ngcontent-%COMP%]{text-align:center;margin-top:1rem;color:#4b2e05;font-size:2rem;font-weight:700;text-shadow:1px 1px 1px #7b4f24}.horizontal-card[_ngcontent-%COMP%]:hover{transform:translateY(-5px);box-shadow:0 10px 20px #d2a04699}.horizontal-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-top:0;font-weight:700;text-shadow:1px 1px 2px #7b4f24;text-align:left}p[_ngcontent-%COMP%]{font-size:1.2rem;color:#4b2e05}.horizontal-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:700;color:#7b4f24}i[_ngcontent-%COMP%], .material-symbols-outlined[_ngcontent-%COMP%]{font-size:3rem!important;margin-right:1rem;vertical-align:middle;color:#5c2c10!important}.btn[_ngcontent-%COMP%], .cancelar-btn[_ngcontent-%COMP%], .apuntarme-btn[_ngcontent-%COMP%]{background-color:sienna;color:#fff;border:none;padding:.6rem 1.2rem;border-radius:5px;cursor:pointer;transition:background-color .3s ease;font-size:1rem;font-weight:700;text-align:center}.btn[_ngcontent-%COMP%]:hover, .cancelar-btn[_ngcontent-%COMP%]:hover, .apuntarme-btn[_ngcontent-%COMP%]:hover{background-color:#8b4513}.cancelar-btn[_ngcontent-%COMP%]{background-color:#cc4b37}.cancelar-btn[_ngcontent-%COMP%]:hover{background-color:#a43a29}.apuntarme-btn[_ngcontent-%COMP%]{background-color:#4b8b3b}.apuntarme-btn[_ngcontent-%COMP%]:hover{background-color:#3a6b2b}.button-container[_ngcontent-%COMP%]{text-align:center;margin:2rem 0}"]})};var Cn=class i{constructor(t){this.router=t}goToRalliesManagement(){this.router.navigate(["/admin/gestion-rallies"])}goToUsersManagement(){this.router.navigate(["/admin/user-control"])}goToPhotosManagement(){this.router.navigate(["/admin/user-photos"])}static \u0275fac=function(e){return new(e||i)(y(A))};static \u0275cmp=k({type:i,selectors:[["app-admin"]],decls:26,vars:0,consts:[[1,"dashboard","admin-panel"],[1,"dashboard-header"],[1,"card-container"],[1,"card",3,"click"],[1,"btn-guardar"]],template:function(e,n){e&1&&(s(0,"div",0)(1,"div",1)(2,"h1"),c(3,"Panel de Administraci\xF3n"),a()(),s(4,"div",2)(5,"div",3),_("click",function(){return n.goToRalliesManagement()}),s(6,"h2"),c(7,"Gesti\xF3n de Rallies"),a(),s(8,"p"),c(9,"Crear, editar o eliminar rallies existentes."),a(),s(10,"button",4),c(11,"Gestionar Rallies"),a()(),s(12,"div",3),_("click",function(){return n.goToUsersManagement()}),s(13,"h2"),c(14,"Gesti\xF3n de Usuarios"),a(),s(15,"p"),c(16,"Administrar usuarios registrados en el sistema."),a(),s(17,"button",4),c(18,"Gestionar Usuarios"),a()(),s(19,"div",3),_("click",function(){return n.goToPhotosManagement()}),s(20,"h2"),c(21,"Gesti\xF3n de Fotos"),a(),s(22,"p"),c(23,"Administrar el estado de las fotos de los usuarios."),a(),s(24,"button",4),c(25,"Gestionar Fotos"),a()()()())},dependencies:[U],styles:[".admin-panel[_ngcontent-%COMP%]{background:url(/images/fondo3.jpg) no-repeat center center;background-size:cover;min-height:100vh;width:100%;overflow:hidden;display:flex;flex-direction:column}h1[_ngcontent-%COMP%]{font-size:2.4rem;font-weight:700;color:#4b2e05;text-align:center;margin-bottom:2rem;text-shadow:1px 1px 2px #7b4f24}.card-container[_ngcontent-%COMP%]{display:flex;gap:2rem;margin-bottom:2rem;flex-wrap:wrap;justify-content:center}.card[_ngcontent-%COMP%]{flex:1 1 280px;max-width:320px;background:#f2d388;padding:1.8rem;border-radius:12px;box-shadow:0 6px 14px #d2a04673;color:#4b2e05;display:flex;flex-direction:column;justify-content:space-between;cursor:pointer;transition:transform .3s ease,box-shadow .3s ease}.card[_ngcontent-%COMP%]:hover{transform:translateY(-6px);box-shadow:0 10px 20px #d2a04699}.card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-weight:700;font-size:1.6rem;margin-bottom:.6rem;text-shadow:1px 1px 2px #7b4f24}.card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1rem;line-height:1.4;margin-bottom:1.8rem}.card[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{align-self:flex-start;background-color:#7b4f24;color:#f9f4e6;border:none;padding:.6rem 1.4rem;font-size:1rem;font-weight:700;border-radius:8px;cursor:pointer;transition:background-color .3s ease}.card[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#a06937}"]})};function ca(i,t){i&1&&(s(0,"div",21)(1,"small"),c(2,"El nombre debe tener al menos 3 caracteres."),a()())}function da(i,t){i&1&&(s(0,"div",21)(1,"small"),c(2,"Los apellidos deben tener al menos 3 caracteres."),a()())}function ma(i,t){i&1&&(s(0,"div",21)(1,"small"),c(2,"Ingresa un correo v\xE1lido."),a()())}function ua(i,t){i&1&&(s(0,"div",21)(1,"small"),c(2,"El rol es obligatorio."),a()())}function pa(i,t){i&1&&(s(0,"div",22),c(1," Por favor, complete todos los campos correctamente. "),a())}var xn=class i{constructor(t,e,n,r,o){this.activatedRoute=t;this.userService=e;this.formBuilder=n;this.router=r;this.sweetAlert=o}userId;userForm;user=null;passwordRegex=/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[!@#$%&*]).{8,12}$/;emailRegex=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;ngOnInit(){this.userId=Number(this.activatedRoute.snapshot.paramMap.get("id")),this.userForm=this.formBuilder.group({name:["",[L.required,L.minLength(3)]],lastName:["",[L.required,L.minLength(3)]],email:["",[L.required,L.email]],role:["",L.required]}),this.userService.getUserById(this.userId).subscribe({next:t=>{this.user=t,this.userForm.patchValue({name:t.name,lastName:t.lastName,email:t.email,role:t.role})},error:t=>{console.error("Error al obtener los datos del usuario",t)}})}saveUser(){if(this.userForm.valid&&this.user){let t=B(B({},this.user),this.userForm.value);if(this.userId===14&&t.role!==this.user?.role){this.sweetAlert.warning("No puedes cambiar el rol del admin principal");return}this.userService.updateUser(this.userId,t).subscribe({next:()=>{this.router.navigate(["/admin/user-control"])},error:e=>{console.error("Error al actualizar el usuario",e)}})}}cancel(){this.router.navigate(["/admin/user-control"])}static \u0275fac=function(e){return new(e||i)(y(tt),y(Pt),y(it),y(A),y(Ae))};static \u0275cmp=k({type:i,selectors:[["app-edit-user"]],decls:37,vars:7,consts:[[1,"container","mt-5","mb-5"],[1,"text-center","mb-4",2,"color","#4b2e2e","font-family","'Georgia', serif"],[3,"ngSubmit","formGroup"],[1,"row","g-3"],[1,"col-md-6"],["for","name",1,"form-label","fw-bold",2,"color","#3e2b2b"],["id","name","formControlName","name","type","text","placeholder","Nombre",1,"form-control","custom-input"],["class","text-danger small mt-1",4,"ngIf"],["for","lastName",1,"form-label","fw-bold",2,"color","#3e2b2b"],["id","lastName","formControlName","lastName","type","text","placeholder","Apellidos",1,"form-control","custom-input"],["for","email",1,"form-label","fw-bold",2,"color","#3e2b2b"],["id","email","formControlName","email","type","email","placeholder","Correo Electr\xF3nico",1,"form-control","custom-input"],["for","role",1,"form-label","fw-bold",2,"color","#3e2b2b"],["id","role","formControlName","role",1,"form-select","custom-input"],["value",""],["value","user"],["value","admin"],["class","text-danger mt-3",4,"ngIf"],[1,"mt-4","d-flex","gap-3"],["type","submit",1,"btn","btn-guardar","flex-grow-1",3,"disabled"],["type","button",1,"btn","btn-cancel","flex-grow-1",3,"click"],[1,"text-danger","small","mt-1"],[1,"text-danger","mt-3"]],template:function(e,n){if(e&1&&(s(0,"div",0)(1,"h2",1),c(2,"Editar Usuario"),a(),s(3,"form",2),_("ngSubmit",function(){return n.saveUser()}),s(4,"div",3)(5,"div",4)(6,"label",5),c(7,"Nombre"),a(),O(8,"input",6),h(9,ca,3,0,"div",7),a(),s(10,"div",4)(11,"label",8),c(12,"Apellidos"),a(),O(13,"input",9),h(14,da,3,0,"div",7),a(),s(15,"div",4)(16,"label",10),c(17,"Correo Electr\xF3nico"),a(),O(18,"input",11),h(19,ma,3,0,"div",7),a(),s(20,"div",4)(21,"label",12),c(22,"Rol"),a(),s(23,"select",13)(24,"option",14),c(25,"Selecciona un rol"),a(),s(26,"option",15),c(27,"Usuario"),a(),s(28,"option",16),c(29,"Administrador"),a()(),h(30,ua,3,0,"div",7),a()(),h(31,pa,2,0,"div",17),s(32,"div",18)(33,"button",19),c(34,"Guardar Cambios"),a(),s(35,"button",20),_("click",function(){return n.cancel()}),c(36,"Cancelar"),a()()()()),e&2){let r,o,l,d;m(3),u("formGroup",n.userForm),m(6),u("ngIf",((r=n.userForm.get("name"))==null?null:r.invalid)&&((r=n.userForm.get("name"))==null?null:r.touched)),m(5),u("ngIf",((o=n.userForm.get("lastName"))==null?null:o.invalid)&&((o=n.userForm.get("lastName"))==null?null:o.touched)),m(5),u("ngIf",((l=n.userForm.get("email"))==null?null:l.invalid)&&((l=n.userForm.get("email"))==null?null:l.touched)),m(11),u("ngIf",((d=n.userForm.get("role"))==null?null:d.invalid)&&((d=n.userForm.get("role"))==null?null:d.touched)),m(),u("ngIf",n.userForm.invalid&&(n.userForm.dirty||n.userForm.touched)),m(2),u("disabled",n.userForm.invalid)}},dependencies:[U,K,rt,Ge,Et,Mt,ye,St,Ce,qe,xt,wt,je],styles:[".container[_ngcontent-%COMP%]{background-color:#fdf4e3;border:2px solid #e2c799;border-radius:16px;padding:30px;box-shadow:0 6px 16px #a0693740;font-family:Georgia,serif;color:#4b2e05}h2[_ngcontent-%COMP%]{font-size:2.2rem;font-weight:700;color:#7b4f24;text-shadow:1px 1px 2px #cfa873}.form-label[_ngcontent-%COMP%]{font-weight:700;font-family:Georgia,serif;color:#4b2e05;margin-bottom:6px;display:inline-block}.custom-input[_ngcontent-%COMP%]{background-color:#fff8f0;border:1.5px solid #a06937;border-radius:14px;padding:12px 16px;font-size:16px;font-family:Georgia,serif;color:#4b2e05;transition:border-color .3s ease,box-shadow .3s ease;box-shadow:inset 0 1px 3px #a0693726}.custom-input[_ngcontent-%COMP%]:focus{border-color:#7b4f24;outline:none;box-shadow:0 0 8px #a06937}.text-danger[_ngcontent-%COMP%]   small[_ngcontent-%COMP%], .error-message[_ngcontent-%COMP%]{font-family:Georgia,serif;color:#a04a1b;font-weight:600}.btn-guardar[_ngcontent-%COMP%]{background-color:#7b4f24;color:#f9f4e6;border:none;padding:12px 26px;font-size:16px;border-radius:14px;cursor:pointer;transition:background-color .3s ease,box-shadow .3s ease;font-family:Georgia,serif;font-weight:700;box-shadow:0 4px 10px #7b4f2499;-webkit-user-select:none;user-select:none}.btn-guardar[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#a06937;box-shadow:0 6px 14px #a06937bf}.btn-guardar[_ngcontent-%COMP%]:disabled{background-color:#c4a378;cursor:not-allowed;box-shadow:none}.btn-cancel[_ngcontent-%COMP%]{background-color:#f2d388;color:#4b2e05;border:none;padding:12px 26px;font-size:16px;border-radius:14px;cursor:pointer;transition:background-color .3s ease,box-shadow .3s ease;font-family:Georgia,serif;font-weight:600;box-shadow:0 3px 8px #7b4f2466;-webkit-user-select:none;user-select:none}.btn-cancel[_ngcontent-%COMP%]:hover{background-color:#d4b66a;box-shadow:0 5px 12px #a0693780}"]})};function fa(i,t){if(i&1){let e=V();s(0,"tr")(1,"td"),c(2),a(),s(3,"td"),c(4),a(),s(5,"td"),c(6),a(),s(7,"td"),c(8),W(9,"date"),W(10,"date"),a(),s(11,"td",8)(12,"button",9),_("click",function(){let r=x(e).$implicit,o=g();return w(r.id!==void 0&&o.editRally(r.id))}),c(13,"Editar"),a(),s(14,"button",10),_("click",function(){let r=x(e).$implicit,o=g();return w(r.id!==void 0&&o.deleteRally(r.id))}),c(15,"Eliminar"),a()()()}if(i&2){let e=t.$implicit;m(2),D(e.title),m(2),D(e.theme),m(2),D(e.description),m(2),rn("",_e(9,5,e.start_date,"dd/MM/yyyy")," - ",_e(10,8,e.end_date,"dd/MM/yyyy"),"")}}var wn=class i{constructor(t,e,n){this.router=t;this.rallyService=e;this.sweetAlert=n}rallies=[];ngOnInit(){this.rallyService.rallies$.subscribe(t=>{console.log("Datos de rallies recibidos en la suscripci\xF3n:",t),this.rallies=t,console.log("Todos los rallies:",this.rallies)}),this.rallyService.getAllRallies().subscribe({next:()=>console.log("Rallies cargados correctamente"),error:t=>console.error("Error al cargar los rallies:",t)})}editRally(t){this.router.navigate([`/admin/edit-rallies/${t}`])}deleteRally(t){this.rallyService.getRallyById(t).subscribe(e=>{if(e){let n=e.title;this.sweetAlert.confirm(`\xBFEst\xE1s seguro de que deseas eliminar el rally: ${n}?`,"Esta acci\xF3n no se puede deshacer.").then(r=>{r&&this.rallyService.deleteRally(t).subscribe(()=>{this.sweetAlert.success("Rally eliminado")})})}else this.sweetAlert.warning("No se encontr\xF3 el rally.")})}goBackToAdminPanel(){this.router.navigate(["admin"])}static \u0275fac=function(e){return new(e||i)(y(A),y(we),y(Ae))};static \u0275cmp=k({type:i,selectors:[["app-gestion-rallies"]],decls:25,vars:1,consts:[[1,"add-button-container"],[1,"btn-nuevo",3,"click"],[1,"table-container"],[1,"table-responsive"],[1,"table"],[4,"ngFor","ngForOf"],[1,"button-container"],[1,"back-button",3,"click"],[1,"actions"],[1,"action-btn","edit-btn",3,"click"],[1,"action-btn","delete-btn",3,"click"]],template:function(e,n){e&1&&(s(0,"h2"),c(1,"Gesti\xF3n de Rallies"),a(),s(2,"div",0)(3,"button",1),_("click",function(){return n.router.navigate(["/admin/create-rallies"])}),c(4,"A\xF1adir nuevo rally"),a()(),s(5,"div",2)(6,"div",3)(7,"table",4)(8,"thead")(9,"tr")(10,"th"),c(11,"T\xEDtulo"),a(),s(12,"th"),c(13,"Tema"),a(),s(14,"th"),c(15,"Descripci\xF3n"),a(),s(16,"th"),c(17,"Fechas"),a(),s(18,"th"),c(19,"Acciones"),a()()(),s(20,"tbody"),h(21,fa,16,11,"tr",5),a()()(),s(22,"div",6)(23,"button",7),_("click",function(){return n.goBackToAdminPanel()}),c(24,"Volver"),a()()()),e&2&&(m(21),u("ngForOf",n.rallies))},dependencies:[U,$,ve,Q],styles:[".table-container[_ngcontent-%COMP%]{max-width:900px;margin:40px auto;background-color:#f2d388;border:2px solid #7b4f24;border-radius:12px;padding:20px 30px;box-shadow:0 6px 14px #d2a04673;font-family:Georgia,serif;color:#4b2e05}h2[_ngcontent-%COMP%]{font-size:2.5rem;margin-top:1rem;margin-bottom:1rem;color:#7b4f24;text-align:center;text-shadow:1px 1px 2px #7b4f24}.table-responsive[_ngcontent-%COMP%]{overflow-x:auto}.table[_ngcontent-%COMP%]{width:100%;border-collapse:separate;border-spacing:0 12px;min-width:600px}.table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{text-align:left;padding:12px 15px;font-size:1.1rem;border-bottom:2px solid #a06937;color:#4b2e05;text-shadow:1px 1px 2px #7b4f24}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{background-color:#f9e3b0;transition:background-color .3s ease;border-radius:8px;box-shadow:0 2px 5px #d2a0464d}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#ebcb80}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px 15px;vertical-align:middle;font-size:1rem;color:#4b2e05}.table[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border:none!important;box-shadow:none!important}.actions[_ngcontent-%COMP%]{display:flex;gap:10px;flex-wrap:wrap}.action-btn[_ngcontent-%COMP%]{font-family:Georgia,serif;font-weight:700;padding:6px 14px;border-radius:8px;border:none;cursor:pointer;font-size:.95rem;transition:background-color .3s ease;color:#f9f4e6;min-width:70px;text-align:center;-webkit-user-select:none;user-select:none;box-shadow:0 2px 5px #7b4f2466;white-space:nowrap}.edit-btn[_ngcontent-%COMP%]{background-color:#7b4f24}.edit-btn[_ngcontent-%COMP%]:hover{background-color:#a06937;box-shadow:0 4px 10px #a0693799}.delete-btn[_ngcontent-%COMP%]{background-color:#c55e25;box-shadow:0 2px 5px #c55e2566}.delete-btn[_ngcontent-%COMP%]:hover{background-color:#a04a1b;box-shadow:0 4px 10px #a04a1b99}.button-container[_ngcontent-%COMP%]{margin-top:25px;text-align:center}.back-button[_ngcontent-%COMP%]{font-family:Georgia,serif;font-weight:700;background-color:#7b4f24;color:#f9f4e6;border:none;padding:10px 28px;border-radius:12px;cursor:pointer;font-size:1.1rem;box-shadow:0 4px 10px #7b4f2499;transition:background-color .3s ease}.back-button[_ngcontent-%COMP%]:hover{background-color:#a06937;color:#fff;box-shadow:0 6px 14px #a06937cc}.btn-nuevo[_ngcontent-%COMP%]{font-family:Georgia,serif;font-weight:700;background-color:#4b2e05;color:#f9f4e6;border:none;margin-left:12rem;padding:10px 22px;border-radius:10px;cursor:pointer;font-size:1rem;box-shadow:0 4px 10px #4b2e0566;transition:background-color .3s ease,box-shadow .3s ease;white-space:nowrap}.add-button-container[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;margin-bottom:1rem}.btn-nuevo[_ngcontent-%COMP%]:hover{background-color:#7b4f24;box-shadow:0 6px 14px #7b4f2499;color:#fff}@media (max-width: 768px){.table-container[_ngcontent-%COMP%]{padding:15px;margin:20px auto}.table[_ngcontent-%COMP%]{min-width:unset}.table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px 12px;font-size:.9rem}.actions[_ngcontent-%COMP%]{gap:8px}.action-btn[_ngcontent-%COMP%]{font-size:.85rem;padding:6px 10px;min-width:60px}.button-container[_ngcontent-%COMP%]{margin-top:20px}.back-button[_ngcontent-%COMP%]{font-size:1rem;padding:10px 22px}}"]})};function ga(i,t){i&1&&(s(0,"small"),c(1,"El t\xEDtulo es obligatorio."),a())}function ha(i,t){i&1&&(s(0,"small"),c(1,"El t\xEDtulo debe tener al menos 5 caracteres."),a())}function _a(i,t){i&1&&(s(0,"small"),c(1,"El t\xEDtulo no puede superar los 100 caracteres."),a())}function ba(i,t){if(i&1&&(s(0,"div",32),h(1,ga,2,0,"small",33)(2,ha,2,0,"small",33)(3,_a,2,0,"small",33),a()),i&2){let e,n,r,o=g();m(),u("ngIf",(e=o.rallyForm.get("title"))==null?null:e.hasError("required")),m(),u("ngIf",(n=o.rallyForm.get("title"))==null?null:n.hasError("minlength")),m(),u("ngIf",(r=o.rallyForm.get("title"))==null?null:r.hasError("maxlength"))}}function va(i,t){i&1&&(s(0,"small"),c(1,"La ubicaci\xF3n es obligatoria."),a())}function ya(i,t){i&1&&(s(0,"small"),c(1,"La ubicaci\xF3n debe tener al menos 3 caracteres."),a())}function Ca(i,t){i&1&&(s(0,"small"),c(1,"La ubicaci\xF3n no puede superar los 100 caracteres."),a())}function xa(i,t){if(i&1&&(s(0,"div",32),h(1,va,2,0,"small",33)(2,ya,2,0,"small",33)(3,Ca,2,0,"small",33),a()),i&2){let e,n,r,o=g();m(),u("ngIf",(e=o.rallyForm.get("location"))==null?null:e.hasError("required")),m(),u("ngIf",(n=o.rallyForm.get("location"))==null?null:n.hasError("minlength")),m(),u("ngIf",(r=o.rallyForm.get("location"))==null?null:r.hasError("maxlength"))}}function wa(i,t){i&1&&(s(0,"small"),c(1,"La descripci\xF3n es obligatoria."),a())}function Sa(i,t){i&1&&(s(0,"small"),c(1,"La descripci\xF3n debe tener al menos 10 caracteres."),a())}function Ea(i,t){i&1&&(s(0,"small"),c(1,"La descripci\xF3n no puede superar los 500 caracteres."),a())}function Ma(i,t){if(i&1&&(s(0,"div",32),h(1,wa,2,0,"small",33)(2,Sa,2,0,"small",33)(3,Ea,2,0,"small",33),a()),i&2){let e,n,r,o=g();m(),u("ngIf",(e=o.rallyForm.get("description"))==null?null:e.hasError("required")),m(),u("ngIf",(n=o.rallyForm.get("description"))==null?null:n.hasError("minlength")),m(),u("ngIf",(r=o.rallyForm.get("description"))==null?null:r.hasError("maxlength"))}}function Pa(i,t){i&1&&(s(0,"small"),c(1,"La fecha de inicio es obligatoria."),a())}function Oa(i,t){if(i&1&&(s(0,"div",32),h(1,Pa,2,0,"small",33),a()),i&2){let e,n=g();m(),u("ngIf",(e=n.rallyForm.get("start_date"))==null?null:e.hasError("required"))}}function Ta(i,t){i&1&&(s(0,"small"),c(1,"La fecha de finalizaci\xF3n es obligatoria."),a())}function Fa(i,t){if(i&1&&(s(0,"div",32),h(1,Ta,2,0,"small",33),a()),i&2){let e,n=g();m(),u("ngIf",(e=n.rallyForm.get("end_date"))==null?null:e.hasError("required"))}}function Aa(i,t){i&1&&(s(0,"div",32)(1,"small"),c(2,"La fecha de finalizaci\xF3n no puede ser anterior a la de inicio."),a()())}function Ia(i,t){i&1&&(s(0,"small"),c(1,"El tema es obligatorio."),a())}function ka(i,t){if(i&1&&(s(0,"div",32),h(1,Ia,2,0,"small",33),a()),i&2){let e,n=g();m(),u("ngIf",(e=n.rallyForm.get("theme"))==null?null:e.hasError("required"))}}function Da(i,t){i&1&&(s(0,"div",34),c(1," Por favor, completa todos los campos correctamente. "),a())}function Ra(i,t){if(i&1&&(s(0,"div",35)(1,"h5")(2,"strong"),c(3,"Inicio actual:"),a(),c(4),W(5,"date"),a(),s(6,"h5")(7,"strong"),c(8,"Fin actual:"),a(),c(9),W(10,"date"),a()()),i&2){let e,n,r=g();m(4),R(" ",yt(5,2,(e=r.rallyForm.get("start_date"))==null?null:e.value),""),m(5),R(" ",yt(10,4,(n=r.rallyForm.get("end_date"))==null?null:n.value),"")}}var Sn=class i{constructor(t,e,n,r){this.route=t;this.router=e;this.rallyService=n;this.fb=r}rallyForm;rallyId;isLoading=!1;message="";ngOnInit(){this.rallyId=Number(this.route.snapshot.paramMap.get("id")),console.log("ID desde la URL:",this.rallyId),this.rallyForm=this.fb.group({title:["",[L.required,L.minLength(5),L.maxLength(100)]],description:["",[L.required,L.minLength(10),L.maxLength(500)]],start_date:["",L.required],end_date:["",L.required],location:["",[L.required,L.minLength(3),L.maxLength(100)]],theme:["",[L.required,L.minLength(3),L.maxLength(50)]]},{validators:this.dateValidator}),this.rallyService.getRallyById(this.rallyId).subscribe(t=>{console.log("Rally recibido:",t),t?this.rallyForm.patchValue({title:t.title,description:t.description,start_date:this.formatDate(t.start_date),end_date:this.formatDate(t.end_date),location:t.location,theme:t.theme}):this.message="No se encontr\xF3 el rally."})}formatDate(t){let e=new Date(t),n=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),o=String(e.getDate()).padStart(2,"0");return`${n}-${r}-${o}`}dateValidator(t){let e=t.get("start_date")?.value,n=t.get("end_date")?.value;if(e&&n){let r=new Date(e);if(new Date(n)<r)return{dateMismatch:!0}}return null}onSubmit(){if(this.rallyForm.valid){this.isLoading=!0;let t=this.rallyForm.value;console.log("Formulario enviado:",t),this.rallyService.updateRally(this.rallyId,t).subscribe(e=>{this.isLoading=!1,this.message="Rally actualizado correctamente.",this.router.navigate(["/admin/gestion-rallies"])},e=>{this.isLoading=!1,this.message="Error al actualizar el rally.",console.error("Error al actualizar el rally:",e)})}else this.message="Por favor, completa todos los campos correctamente."}cancel(){this.router.navigate(["/admin/gestion-rallies"])}static \u0275fac=function(e){return new(e||i)(y(tt),y(A),y(we),y(it))};static \u0275cmp=k({type:i,selectors:[["app-edit-rallies"]],decls:59,vars:11,consts:[[1,"container","mt-5","mb-5"],[1,"text-center","mb-4",2,"color","#4b2e2e","font-family","'Georgia', serif"],[3,"ngSubmit","formGroup"],[1,"row","g-3"],[1,"col-md-6"],["for","title",1,"form-label","fw-bold",2,"color","#3e2b2b"],["id","title","formControlName","title","type","text","placeholder","T\xEDtulo del rally",1,"form-control","custom-input"],["class","text-danger small mt-1",4,"ngIf"],["for","location",1,"form-label","fw-bold",2,"color","#3e2b2b"],["id","location","formControlName","location","type","text","placeholder","Ubicaci\xF3n del rally",1,"form-control","custom-input"],[1,"col-12"],["for","description",1,"form-label","fw-bold",2,"color","#3e2b2b"],["id","description","formControlName","description","rows","4","placeholder","Descripci\xF3n del rally",1,"form-control","custom-input"],["for","start_date",1,"form-label","fw-bold",2,"color","#3e2b2b"],["id","start_date","type","date","formControlName","start_date",1,"form-control","custom-input"],["for","end_date",1,"form-label","fw-bold",2,"color","#3e2b2b"],["id","end_date","type","date","formControlName","end_date",1,"form-control","custom-input"],["for","theme",1,"form-label","fw-bold",2,"color","#3e2b2b"],["id","theme","formControlName","theme",1,"form-select","custom-input"],["value",""],["value","Fotografia"],["value","Naturaleza"],["value","Deporte"],["value","Animales"],["value","Comida"],["value","Mar y playa"],["value","Paisaje urbano"],["class","text-danger mt-3","style","font-family: 'Georgia', serif;",4,"ngIf"],[1,"mt-4","d-flex","gap-3"],["type","submit",1,"btn","btn-guardar","flex-grow-1",3,"disabled"],["type","button",1,"btn","btn-cancel","flex-grow-1",3,"click"],["class","mt-4","style","font-family: 'Georgia', serif; color: #4b2e05;",4,"ngIf"],[1,"text-danger","small","mt-1"],[4,"ngIf"],[1,"text-danger","mt-3",2,"font-family","'Georgia', serif"],[1,"mt-4",2,"font-family","'Georgia', serif","color","#4b2e05"]],template:function(e,n){if(e&1&&(s(0,"div",0)(1,"h2",1),c(2,"Editar Rally"),a(),s(3,"form",2),_("ngSubmit",function(){return n.onSubmit()}),s(4,"div",3)(5,"div",4)(6,"label",5),c(7,"T\xEDtulo"),a(),O(8,"input",6),h(9,ba,4,3,"div",7),a(),s(10,"div",4)(11,"label",8),c(12,"Ubicaci\xF3n"),a(),O(13,"input",9),h(14,xa,4,3,"div",7),a(),s(15,"div",10)(16,"label",11),c(17,"Descripci\xF3n"),a(),O(18,"textarea",12),h(19,Ma,4,3,"div",7),a(),s(20,"div",4)(21,"label",13),c(22,"Fecha de inicio"),a(),O(23,"input",14),h(24,Oa,2,1,"div",7),a(),s(25,"div",4)(26,"label",15),c(27,"Fecha de finalizaci\xF3n"),a(),O(28,"input",16),h(29,Fa,2,1,"div",7)(30,Aa,3,0,"div",7),a(),s(31,"div",10)(32,"label",17),c(33,"Tema"),a(),s(34,"select",18)(35,"option",19),c(36,"Selecciona un tema"),a(),s(37,"option",20),c(38,"\u{1F4F8} Fotograf\xEDa general"),a(),s(39,"option",21),c(40,"\u{1F33F} Naturaleza"),a(),s(41,"option",22),c(42,"\u{1F3C3}\u200D\u2642\uFE0F Deporte"),a(),s(43,"option",23),c(44,"\u{1F43E} Animales"),a(),s(45,"option",24),c(46,"\u{1F37D}\uFE0F Comida"),a(),s(47,"option",25),c(48,"\u{1F3D6}\uFE0F Mar y Playa"),a(),s(49,"option",26),c(50,"\u{1F306} Paisaje Urbano"),a()(),h(51,ka,2,1,"div",7),a()(),h(52,Da,2,0,"div",27),s(53,"div",28)(54,"button",29),c(55,"Actualizar"),a(),s(56,"button",30),_("click",function(){return n.cancel()}),c(57,"Cancelar"),a()()(),h(58,Ra,11,6,"div",31),a()),e&2){let r,o,l,d,p,f,b,v;m(3),u("formGroup",n.rallyForm),m(6),u("ngIf",((r=n.rallyForm.get("title"))==null?null:r.touched)&&((r=n.rallyForm.get("title"))==null?null:r.invalid)),m(5),u("ngIf",((o=n.rallyForm.get("location"))==null?null:o.touched)&&((o=n.rallyForm.get("location"))==null?null:o.invalid)),m(5),u("ngIf",((l=n.rallyForm.get("description"))==null?null:l.touched)&&((l=n.rallyForm.get("description"))==null?null:l.invalid)),m(5),u("ngIf",((d=n.rallyForm.get("start_date"))==null?null:d.touched)&&((d=n.rallyForm.get("start_date"))==null?null:d.invalid)),m(5),u("ngIf",((p=n.rallyForm.get("end_date"))==null?null:p.touched)&&((p=n.rallyForm.get("end_date"))==null?null:p.invalid)),m(),u("ngIf",(n.rallyForm.errors==null?null:n.rallyForm.errors.dateMismatch)&&((f=n.rallyForm.get("end_date"))==null?null:f.touched)),m(21),u("ngIf",((b=n.rallyForm.get("theme"))==null?null:b.touched)&&((b=n.rallyForm.get("theme"))==null?null:b.invalid)),m(),u("ngIf",n.rallyForm.invalid&&n.rallyForm.touched),m(2),u("disabled",n.rallyForm.invalid||n.isLoading),m(4),u("ngIf",((v=n.rallyForm.get("start_date"))==null?null:v.value)||((v=n.rallyForm.get("end_date"))==null?null:v.value))}},dependencies:[U,K,ve,rt,Ge,Et,Mt,ye,St,Ce,qe,xt,wt],styles:[".container[_ngcontent-%COMP%]{background-color:#fdf4e3;border:2px solid #e2c799;border-radius:16px;padding:30px;box-shadow:0 6px 16px #a0693740;font-family:Georgia,serif;color:#4b2e05}h2[_ngcontent-%COMP%]{font-size:2.2rem;font-weight:700;color:#7b4f24;text-shadow:1px 1px 2px #cfa873}.form-label[_ngcontent-%COMP%]{font-weight:700;font-family:Georgia,serif;color:#4b2e05;margin-bottom:6px;display:inline-block}.custom-input[_ngcontent-%COMP%]{background-color:#fff8f0;border:1.5px solid #a06937;border-radius:14px;padding:12px 16px;font-size:16px;font-family:Georgia,serif;color:#4b2e05;transition:border-color .3s ease,box-shadow .3s ease;box-shadow:inset 0 1px 3px #a0693726}.custom-input[_ngcontent-%COMP%]:focus{border-color:#7b4f24;outline:none;box-shadow:0 0 8px #a06937}.text-danger[_ngcontent-%COMP%]   small[_ngcontent-%COMP%], .error-message[_ngcontent-%COMP%]{font-family:Georgia,serif;color:#a04a1b;font-weight:600}.btn-guardar[_ngcontent-%COMP%]{background-color:#7b4f24;color:#f9f4e6;border:none;padding:12px 26px;font-size:16px;border-radius:14px;cursor:pointer;transition:background-color .3s ease,box-shadow .3s ease;font-family:Georgia,serif;font-weight:700;box-shadow:0 4px 10px #7b4f2499;-webkit-user-select:none;user-select:none}.btn-guardar[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#a06937;box-shadow:0 6px 14px #a06937bf}.btn-guardar[_ngcontent-%COMP%]:disabled{background-color:#c4a378;cursor:not-allowed;box-shadow:none}.btn-cancel[_ngcontent-%COMP%]{background-color:#f2d388;color:#4b2e05;border:none;padding:12px 26px;font-size:16px;border-radius:14px;cursor:pointer;transition:background-color .3s ease,box-shadow .3s ease;font-family:Georgia,serif;font-weight:600;box-shadow:0 3px 8px #7b4f2466;-webkit-user-select:none;user-select:none}.btn-cancel[_ngcontent-%COMP%]:hover{background-color:#d4b66a;box-shadow:0 5px 12px #a0693780}"]})};function Ua(i,t){if(i&1&&O(0,"input",26),i&2){let e=g(2).$implicit;u("id",e.id)("type",e.type)("formControlName",e.name)}}function Na(i,t){if(i&1&&O(0,"textarea",27),i&2){let e=g(2).$implicit;u("id",e.id)("formControlName",e.name)}}function za(i,t){if(i&1&&(Pe(0),c(1),Oe()),i&2){let e=g().$implicit;m(),R(" ",e.message," ")}}function La(i,t){if(i&1&&(s(0,"small"),h(1,za,2,1,"ng-container",22),a()),i&2){let e,n=t.$implicit,r=g(3).$implicit,o=g();m(),u("ngIf",(e=o.rallyForm.get(r.name))==null?null:e.hasError(n.type))}}function Va(i,t){if(i&1&&(s(0,"div",28),h(1,La,2,1,"small",29),a()),i&2){let e=g(2).$implicit;m(),u("ngForOf",e.errors)}}function Ba(i,t){if(i&1&&(Pe(0),s(1,"label",23),c(2),a(),h(3,Ua,1,3,"input",24)(4,Na,1,2,"textarea",25)(5,Va,2,1,"div",15),Oe()),i&2){let e,n=g().$implicit,r=g();m(),u("for",n.id),m(),D(n.label),m(),u("ngIf",n.type!=="textarea"),m(),u("ngIf",n.type==="textarea"),m(),u("ngIf",((e=r.rallyForm.get(n.name))==null?null:e.invalid)&&((e=r.rallyForm.get(n.name))==null?null:e.touched))}}function ja(i,t){if(i&1&&(s(0,"div",4),h(1,Ba,6,5,"ng-container",22),a()),i&2){let e=t.$implicit;m(),u("ngIf",e.name!=="theme")}}function qa(i,t){i&1&&(s(0,"div",28)(1,"small"),c(2,"El tema es obligatorio."),a()())}function Ga(i,t){i&1&&O(0,"div",30)}function Ha(i,t){if(i&1&&(s(0,"div",28),c(1),a()),i&2){let e=g();m(),R(" ",e.dateRangeError," ")}}function Ka(i,t){if(i&1&&(s(0,"div",31),c(1),a()),i&2){let e=g();m(),R(" ",e.message," ")}}function $a(i,t){if(i&1&&(s(0,"li")(1,"strong"),c(2),a(),O(3,"br"),c(4),W(5,"date"),O(6,"br"),c(7),W(8,"date"),O(9,"br"),c(10),O(11,"br"),c(12),a()),i&2){let e=t.$implicit;m(2),D(e.title),m(2),R(" Fecha de inicio: ",yt(5,5,e.start_date),""),m(3),R(" Fecha de finalizaci\xF3n: ",yt(8,7,e.end_date),""),m(3),R(" Ubicaci\xF3n: ",e.location,""),m(2),R(" Tema: ",e.theme," ")}}function Qa(i,t){if(i&1&&(s(0,"div",32)(1,"h3",33),c(2,"Rallies creados"),a(),s(3,"ul"),h(4,$a,13,9,"li",29),a()()),i&2){let e=g();m(4),u("ngForOf",e.rallies)}}var En=class i{constructor(t,e,n){this.formBuilder=t;this.rallyService=e;this.router=n;this.rallyForm=this.formBuilder.group({title:["",[L.required,L.minLength(6)]],description:["",[L.required,L.minLength(10),L.maxLength(250)]],start_date:["",L.required],end_date:["",L.required],location:["",L.required],theme:["",L.required]})}rallyForm;isLoading=!1;message="";dateRangeError=null;titleDuplicationError=null;rallies=[];onSubmit(){if(this.dateRangeError=null,this.titleDuplicationError=null,this.rallyForm.valid){let t=new Date(this.rallyForm.value.start_date);if(new Date(this.rallyForm.value.end_date)<t){this.dateRangeError="La fecha de finalizaci\xF3n no puede ser anterior a la de inicio.";return}let n=fe(B({},this.rallyForm.value),{created_by:parseInt(localStorage.getItem("userId")||"0",10)});this.isLoading=!0,this.rallyService.createRally(n).subscribe(r=>{if(r?.error&&r.error==="Ya existe un rally con ese t\xEDtulo y fecha de inicio"){this.titleDuplicationError=r.error,this.isLoading=!1;return}this.message="Rally creado exitosamente!",this.isLoading=!1,this.rallyService.getAllRallies().subscribe(o=>{this.rallies=o}),this.router.navigate(["/admin/gestion-rallies"])},r=>{this.isLoading=!1,this.message=r?.error?.error||"Error al crear el rally. Int\xE9ntalo nuevamente."})}}fields=[{id:"title",name:"title",label:"T\xEDtulo",type:"text",errors:[{type:"required",message:"El t\xEDtulo es obligatorio."},{type:"minlength",message:"Debe tener al menos 6 caracteres."}]},{id:"description",name:"description",label:"Descripci\xF3n",type:"textarea",errors:[{type:"required",message:"La descripci\xF3n es obligatoria."},{type:"minlength",message:"Debe tener al menos 10 caracteres."},{type:"maxlength",message:"No puede tener m\xE1s de 250 caracteres."}]},{id:"start_date",name:"start_date",label:"Fecha de inicio",type:"date",errors:[{type:"required",message:"La fecha de inicio es obligatoria."}]},{id:"end_date",name:"end_date",label:"Fecha de finalizaci\xF3n",type:"date",errors:[{type:"required",message:"La fecha de finalizaci\xF3n es obligatoria."}]},{id:"location",name:"location",label:"Ubicaci\xF3n",type:"text",errors:[{type:"required",message:"La ubicaci\xF3n es obligatoria."}]},{id:"theme",name:"theme",label:"Tema",type:"text",errors:[{type:"required",message:"El tema es obligatorio."}]}];getIconClassByTheme(t=""){switch(t){case"fotografia":return"fa-solid fa-camera-retro";case"naturaleza":return"fa-solid fa-tree";case"deporte":return"fa-solid fa-person-hiking";case"animales":return"fa-solid fa-paw";case"comida":return"fa-solid fa-utensils";case"mar y playa":return"fa-solid fa-umbrella-beach";case"paisaje urbano":return"fa-solid fa-city";default:return"fa-solid fa-question"}}cancelCreation(){this.router.navigate(["admin/gestion-rallies"])}static \u0275fac=function(e){return new(e||i)(y(it),y(we),y(A))};static \u0275cmp=k({type:i,selectors:[["app-create-rallies"]],decls:35,vars:8,consts:[[1,"form-container"],[1,"form-title"],[3,"ngSubmit","formGroup"],["class","form-group",4,"ngFor","ngForOf"],[1,"form-group"],["for","theme"],["id","theme","formControlName","theme",1,"form-control-custom"],["value",""],["value","fotografia"],["value","naturaleza"],["value","deporte"],["value","animales"],["value","comida"],["value","mar y playa"],["value","paisaje urbano"],["class","text-danger",4,"ngIf"],["class","icon-preview",4,"ngIf"],[1,"form-group","button-group"],["type","submit",1,"btn-submit",3,"disabled"],["type","button",1,"btn-cancel",3,"click"],["class","alert-info-custom",4,"ngIf"],["class","rally-list",4,"ngIf"],[4,"ngIf"],[3,"for"],["class","form-control-custom",3,"id","type","formControlName",4,"ngIf"],["class","form-control-custom",3,"id","formControlName",4,"ngIf"],[1,"form-control-custom",3,"id","type","formControlName"],[1,"form-control-custom",3,"id","formControlName"],[1,"text-danger"],[4,"ngFor","ngForOf"],[1,"icon-preview"],[1,"alert-info-custom"],[1,"rally-list"],[1,"list-title"]],template:function(e,n){if(e&1&&(s(0,"div",0)(1,"h2",1),c(2,"Crear Rally"),a(),s(3,"form",2),_("ngSubmit",function(){return n.onSubmit()}),h(4,ja,2,1,"div",3),s(5,"div",4)(6,"label",5),c(7,"Tema del Rally"),a(),s(8,"select",6)(9,"option",7),c(10,"Selecciona un tema"),a(),s(11,"option",8),c(12,"\u{1F4F8} Fotograf\xEDa general"),a(),s(13,"option",9),c(14,"\u{1F33F} Naturaleza"),a(),s(15,"option",10),c(16,"\u{1F3C3}\u200D\u2642\uFE0F Deporte"),a(),s(17,"option",11),c(18,"\u{1F43E} Animales"),a(),s(19,"option",12),c(20,"\u{1F37D}\uFE0F Comida"),a(),s(21,"option",13),c(22,"\u{1F3D6}\uFE0F Mar y Playa"),a(),s(23,"option",14),c(24,"\u{1F306} Paisaje Urbano"),a()(),h(25,qa,3,0,"div",15)(26,Ga,1,0,"div",16),a(),h(27,Ha,2,1,"div",15),s(28,"div",17)(29,"button",18),c(30,"Crear Rally"),a(),s(31,"button",19),_("click",function(){return n.cancelCreation()}),c(32,"Cancelar"),a()(),h(33,Ka,2,1,"div",20),a(),h(34,Qa,5,1,"div",21),a()),e&2){let r,o;m(3),u("formGroup",n.rallyForm),m(),u("ngForOf",n.fields),m(21),u("ngIf",((r=n.rallyForm.get("theme"))==null?null:r.invalid)&&((r=n.rallyForm.get("theme"))==null?null:r.touched)),m(),u("ngIf",(o=n.rallyForm.get("theme"))==null?null:o.value),m(),u("ngIf",n.dateRangeError),m(2),u("disabled",n.isLoading),m(4),u("ngIf",n.message),m(),u("ngIf",n.rallies.length>0)}},dependencies:[U,$,K,ve,rt,Ge,Et,Mt,ye,St,Ce,qe,xt,wt],styles:[".form-container[_ngcontent-%COMP%]{max-width:700px;margin:40px auto;padding:32px 36px;background-color:#fff8f0;border-radius:18px;box-shadow:0 8px 22px #a0693726;font-family:Georgia,serif;color:#4b2e05}.form-title[_ngcontent-%COMP%]{text-align:center;font-size:30px;margin-bottom:28px;color:#7b4f24;font-weight:700;text-shadow:1px 1px 2px #a06937}.form-group[_ngcontent-%COMP%]{margin-bottom:24px}label[_ngcontent-%COMP%]{display:block;margin-bottom:10px;font-weight:700;color:#7b4f24;font-family:Georgia,serif}.form-control-custom[_ngcontent-%COMP%]{width:100%;padding:14px 16px;border:1.5px solid #a06937;border-radius:14px;background-color:#fff8f0;font-size:16px;font-family:Georgia,serif;color:#4b2e05;transition:border-color .3s ease,box-shadow .3s ease;box-shadow:inset 0 1px 3px #a0693726}.form-control-custom[_ngcontent-%COMP%]:focus{border-color:#7b4f24;outline:none;box-shadow:0 0 8px #a06937}.text-danger[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{display:block;color:#a04a1b;margin-top:6px;font-family:Georgia,serif;font-weight:600}.btn-submit[_ngcontent-%COMP%]{background-color:#7b4f24;color:#f9f4e6;padding:14px 0;font-size:18px;border:none;border-radius:14px;width:100%;cursor:pointer;transition:background-color .3s ease,box-shadow .3s ease;font-family:Georgia,serif;font-weight:700;box-shadow:0 6px 14px #7b4f2499;-webkit-user-select:none;user-select:none}.btn-submit[_ngcontent-%COMP%]:hover{background-color:#a06937;box-shadow:0 8px 18px #a06937bf}.alert-info-custom[_ngcontent-%COMP%]{margin-top:24px;background-color:#f1e3d3;padding:14px 20px;border-radius:14px;color:#5a3e36;text-align:center;border-left:6px solid #a06937;font-family:Georgia,serif;font-weight:600}.rally-list[_ngcontent-%COMP%]{margin-top:48px;background-color:#fff8f0;border-radius:14px;padding:24px 28px;box-shadow:inset 0 0 14px #a069371f}.list-title[_ngcontent-%COMP%]{text-align:center;margin-bottom:20px;color:#7b4f24;font-family:Georgia,serif;font-weight:700}ul[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0}li[_ngcontent-%COMP%]{background-color:#fdf7ef;padding:16px 20px;margin-bottom:14px;border-left:6px solid #a06937;border-radius:12px;font-family:Georgia,serif;color:#4b2e05;font-weight:600}.button-group[_ngcontent-%COMP%]{display:flex;justify-content:space-between;gap:16px;margin-top:12px}.btn-cancel[_ngcontent-%COMP%]{background-color:#f2d388;color:#4b2e05;padding:14px 0;font-size:16px;border:none;border-radius:14px;width:100%;cursor:pointer;transition:background-color .3s ease,box-shadow .3s ease;font-family:Georgia,serif;font-weight:600;box-shadow:0 4px 10px #7b4f2480;-webkit-user-select:none;user-select:none}.btn-cancel[_ngcontent-%COMP%]:hover{background-color:#d4b66a;box-shadow:0 6px 12px #a0693799}.icono-tema-preview[_ngcontent-%COMP%]{font-size:2.2rem;margin-top:8px;display:inline-block;color:#7b4f24;text-shadow:1px 1px 2px #a06937}.icon-preview[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.6rem;color:#5a3e36;font-family:Georgia,serif}"]})};var ae=class i{constructor(t,e){this.authService=t;this.router=e}canActivate(){return this.authService.isAuthenticated()?!0:(this.router.navigate(["/login"]),!1)}static \u0275fac=function(e){return new(e||i)(q(ne),q(A))};static \u0275prov=Y({token:i,factory:i.\u0275fac,providedIn:"root"})};var Ke=class i{constructor(t,e){this.authService=t;this.router=e}canActivate(){let t=this.authService.getUserRole(),e=this.authService.getUserId();return t==="admin"?!0:(this.router.navigate(["/user/dashboard"]),!1)}static \u0275fac=function(e){return new(e||i)(q(ne),q(A))};static \u0275prov=Y({token:i,factory:i.\u0275fac,providedIn:"root"})};var $e=class i{constructor(t,e){this.authService=t;this.router=e}canActivate(t,e){return this.authService.getRole()==="admin"?(this.router.navigate(["/admin"]),!1):!0}static \u0275fac=function(e){return new(e||i)(q(ne),q(A))};static \u0275prov=Y({token:i,factory:i.\u0275fac,providedIn:"root"})};var Mn=class i{constructor(t){this.http=t}apiInscripcionesUrl=`${oe.apiUrl}/inscripciones.php`;obtenerInscripciones(t){return this.http.get(`${this.apiInscripcionesUrl}?userId=${t}`)}gestionarInscripcion(t,e){let n={rallyId:t,userId:e};return this.http.post(this.apiInscripcionesUrl,n)}static \u0275fac=function(e){return new(e||i)(q(et))};static \u0275prov=Y({token:i,factory:i.\u0275fac,providedIn:"root"})};var Ya=()=>["/mis-fotos"],Za=()=>["/faqs"],Xa=(i,t,e)=>({"estado-aprobada":i,"estado-pendiente":t,"estado-rechazada":e});function Ja(i,t){i&1&&(s(0,"span"),c(1," Aprobada \u2705"),a())}function es(i,t){i&1&&(s(0,"span"),c(1," Pendiente \u23F3"),a())}function ts(i,t){i&1&&(s(0,"span"),c(1," Rechazada \u274C"),a())}function ns(i,t){if(i&1){let e=V();s(0,"div",23)(1,"img",24),_("click",function(){let r=x(e).$implicit,o=g(4);return w(o.openImageModal(r.photo_url))}),a(),s(2,"p"),c(3),a(),s(4,"p")(5,"span",25),c(6,"Status:"),a(),s(7,"span",26),Pe(8,27),h(9,Ja,2,0,"span",28)(10,es,2,0,"span",28)(11,ts,2,0,"span",28),Oe(),a()()()}if(i&2){let e=t.$implicit;m(),u("src",e.photo_url,De),m(2),D(e.title||"Sin t\xEDtulo"),m(4),u("ngClass",an(7,Xa,e.status==="aprobada",e.status==="pendiente",e.status==="rechazada")),m(),u("ngSwitch",e.status),m(),u("ngSwitchCase","aprobada"),m(),u("ngSwitchCase","pendiente"),m(),u("ngSwitchCase","rechazada")}}function is(i,t){if(i&1&&(s(0,"div",20)(1,"h6"),c(2,"Mis fotos subidas:"),a(),s(3,"div",21),h(4,ns,12,11,"div",22),a()()),i&2){let e=g().ngIf;m(4),u("ngForOf",e)}}function rs(i,t){if(i&1&&(Pe(0),h(1,is,5,1,"div",19),Oe()),i&2){let e=t.ngIf;m(),u("ngIf",e.length>0)}}function os(i,t){if(i&1){let e=V();s(0,"div",29),_("click",function(){x(e);let r=g(2);return w(r.closeImageModal())}),s(1,"div",30),_("click",function(r){return x(e),w(r.stopPropagation())}),O(2,"img",31),a()()}if(i&2){let e=g(2);m(2),u("src",e.imagenModalUrl,De)}}function as(i,t){if(i&1){let e=V();s(0,"div",12)(1,"div",13)(2,"h5",14),c(3),a(),h(4,rs,2,1,"ng-container",15)(5,os,3,1,"div",16),s(6,"div",17)(7,"button",18),_("click",function(){let r=x(e).$implicit,o=g();return w(o.openModal(r))}),c(8,"Subir Foto"),a()()()()}if(i&2){let e=t.$implicit,n=g();m(3),D(e.title),m(),u("ngIf",n.fotosPorRally&&n.fotosPorRally[e.id]),m(),u("ngIf",n.imagenModalVisible)}}function ss(i,t){if(i&1&&(s(0,"div"),O(1,"img",39),a()),i&2){let e=g(2);m(),u("src",e.imagePreview,De)}}function ls(i,t){if(i&1){let e=V();s(0,"div",32)(1,"div",33)(2,"h5"),c(3),a(),s(4,"label",34),c(5,"T\xEDtulo de la foto"),a(),s(6,"input",35),de("ngModelChange",function(r){x(e);let o=g();return ce(o.tituloFoto,r)||(o.tituloFoto=r),w(r)}),a(),s(7,"input",36),_("change",function(r){x(e);let o=g();return w(o.onFileSelected(r))}),a(),h(8,ss,2,1,"div",15),s(9,"div",37)(10,"button",18),_("click",function(){x(e);let r=g();return w(r.onSubmit())}),c(11,"Subir Foto"),a(),s(12,"button",38),_("click",function(){x(e);let r=g();return w(r.closeModal())}),c(13,"Cerrar"),a()()()()}if(i&2){let e=g();m(3),R("Subir foto para el rally: ",e.rallySeleccionado==null?null:e.rallySeleccionado.title,""),m(3),le("ngModel",e.tituloFoto),m(2),u("ngIf",e.imagePreview)}}function cs(i,t){if(i&1&&(s(0,"div",40),c(1),a()),i&2){let e=g();m(),R(" ",e.popupMensaje," ")}}var Pn=class i{constructor(t,e,n,r,o){this.inscripcionesService=t;this.router=e;this.userService=n;this.photoService=r;this.sweetAlert=o}tabActivo="misrallies";misRallies=[];rallySeleccionado=null;isModalOpen=!1;selectedFile=null;imagePreview=null;usuario=null;tituloFoto="";popupVisible=!1;popupMensaje="";imagenModalVisible=!1;imagenModalUrl=null;fotosPorRally={};ngOnInit(){let t=localStorage.getItem("userId");if(!t){console.error("Usuario no encontrado o no tiene un ID v\xE1lido.");return}this.userService.getUserById(Number(t)).subscribe(e=>{this.usuario=e,this.inscripcionesService.obtenerInscripciones(Number(t)).subscribe({next:n=>{if(n.success){this.misRallies=n.inscritos;for(let r of this.misRallies)this.loadFotosSubidas(r.id)}else console.error(n.message)},error:n=>console.error("Error al obtener mis rallies:",n)})})}seleccionarTab(t){this.tabActivo=t}openModal(t){if(this.rallySeleccionado=t,(this.fotosPorRally[t.id]?.length||0)>=3){this.sweetAlert.info("Ya has subido el n\xFAmero m\xE1ximo de fotos para este rally.","L\xEDmite alcanzado");return}this.isModalOpen=!0,this.usuario&&this.loadFotosSubidas(t.id)}closeModal(){this.isModalOpen=!1,this.selectedFile=null,this.imagePreview=null}onFileSelected(t){let e=t.target.files[0];if(e){this.selectedFile=e;let n=new FileReader;n.onload=()=>{this.imagePreview=n.result},n.readAsDataURL(e)}}loadFotosSubidas(t){this.photoService.getFotosPorRallyYUsuario(t,this.usuario.id).subscribe({next:e=>{console.log(e),this.fotosPorRally[t]=(e.photos||[]).map(n=>fe(B({},n),{photo_url:`${oe.apiUrl}/${n.photo_url}`}))},error:e=>{console.error("Error al cargar fotos:",e),this.fotosPorRally[t]=[]}})}onSubmit(){if(!this.selectedFile){this.sweetAlert.info("Por favor selecciona una foto.");return}if(this.selectedFile&&this.usuario){let t=this.usuario.id,e=this.rallySeleccionado?.id,n=this.tituloFoto||this.selectedFile.name||"Sin t\xEDtulo";e?this.photoService.uploadPhoto(this.selectedFile,t,e,n).subscribe({next:r=>{this.sweetAlert.success("Foto subida correctamente","\xA1Buen trabajo!"),this.loadFotosSubidas(e),this.selectedFile=null,this.imagePreview=null,this.tituloFoto="",this.closeModal()},error:r=>{console.error("Error al subir la foto:",r)}}):this.sweetAlert.warning("No se ha seleccionado un rally v\xE1lido!")}}openImageModal(t){this.imagenModalUrl=t,this.imagenModalVisible=!0}closeImageModal(){this.imagenModalVisible=!1,this.imagenModalUrl=null}mostrarPopup(t){this.popupMensaje=t,this.popupVisible=!0,setTimeout(()=>{this.popupVisible=!1},5e3)}volverADashboard(){this.router.navigateByUrl("/",{skipLocationChange:!0}).then(()=>{this.router.navigate(["/user/dashboard"])})}entrarGaleria(){this.router.navigate(["/gallery"],{queryParams:{from:"dashboard"}})}goBackToUserPanel(){this.router.navigate(["user/dashboard"])}static \u0275fac=function(e){return new(e||i)(y(Mn),y(A),y(Pt),y(He),y(Ae))};static \u0275cmp=k({type:i,selectors:[["app-mis-rallies"]],decls:22,vars:17,consts:[[1,"mis-rallies"],[1,"mis-rallies-header"],[1,"tabs"],[3,"click"],[3,"routerLink"],[1,"titulo-seccion"],[1,"rallies-container"],["class","rally-card",4,"ngFor","ngForOf"],["class","modal-overlay",4,"ngIf"],["class","popup-error",4,"ngIf"],[1,"button-container"],[1,"btn","volver",3,"click"],[1,"rally-card"],[1,"card-body"],[1,"card-title"],[4,"ngIf"],["class","modal-overlay","style","cursor: zoom-out;",3,"click",4,"ngIf"],[1,"card-buttons"],[1,"btn",3,"click"],["class","miniaturas-container",4,"ngIf"],[1,"miniaturas-container"],[1,"miniaturas"],["class","foto-preview",4,"ngFor","ngForOf"],[1,"foto-preview"],["alt","Foto subida",2,"cursor","pointer",3,"click","src"],[2,"color","#5c3a1e"],[3,"ngClass"],[3,"ngSwitch"],[4,"ngSwitchCase"],[1,"modal-overlay",2,"cursor","zoom-out",3,"click"],[1,"modal-content",3,"click"],["alt","Imagen ampliada",2,"width","100%","height","auto","border-radius","1rem",3,"src"],[1,"modal-overlay"],[1,"modal-content"],["for","tituloFoto"],["id","tituloFoto","type","text","placeholder","Introduce un t\xEDtulo",3,"ngModelChange","ngModel"],["type","file",3,"change"],[1,"modal-buttons"],[1,"btn-secondary",3,"click"],["alt","Vista previa",1,"preview-img",3,"src"],[1,"popup-error"]],template:function(e,n){e&1&&(s(0,"div",0)(1,"header",1)(2,"nav",2)(3,"button",3),_("click",function(){return n.volverADashboard()}),c(4,"Perfil"),a(),s(5,"button",3),_("click",function(){return n.seleccionarTab("mis-rallies")}),c(6,"Mis Rallies"),a(),s(7,"button",4),c(8,"Mis Fotos"),a(),s(9,"button",3),_("click",function(){return n.entrarGaleria()}),c(10,"Galer\xEDa"),a(),s(11,"button",4),c(12,"FAQs"),a()()(),s(13,"h2",5),c(14,"Mis Rallies"),a(),s(15,"div",6),h(16,as,9,3,"div",7),a(),h(17,ls,14,3,"div",8)(18,cs,2,1,"div",9),s(19,"div",10)(20,"button",11),_("click",function(){return n.goBackToUserPanel()}),c(21,"Volver"),a()()()),e&2&&(m(3),X("active",n.tabActivo==="perfil"),m(2),X("active",n.tabActivo==="misrallies"),m(2),X("active",n.tabActivo==="misfotos"),u("routerLink",Ye(15,Ya)),m(2),X("active",n.tabActivo==="gallery"),m(2),X("active",n.tabActivo==="faqs"),u("routerLink",Ye(16,Za)),m(5),u("ngForOf",n.misRallies),m(),u("ngIf",n.isModalOpen),m(),u("ngIf",n.popupVisible))},dependencies:[U,Be,$,K,sn,ln,Q,ye,Ce,nt,je,Ct],styles:['@font-face{font-family:Merriweather;font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(https://fonts.gstatic.com/s/merriweather/v31/u-4D0qyriQwlOrhSvowK_l5UcA6zuSYEqOzpPe3HOZJ5eX1WtLaQwmYiScCmDxhtNOKl8yDr3icaGV31GvU.woff2) format("woff2");unicode-range:U+0460-052F,U+1C80-1C8A,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:Merriweather;font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(https://fonts.gstatic.com/s/merriweather/v31/u-4D0qyriQwlOrhSvowK_l5UcA6zuSYEqOzpPe3HOZJ5eX1WtLaQwmYiScCmDxhtNOKl8yDr3icaEF31GvU.woff2) format("woff2");unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:Merriweather;font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(https://fonts.gstatic.com/s/merriweather/v31/u-4D0qyriQwlOrhSvowK_l5UcA6zuSYEqOzpPe3HOZJ5eX1WtLaQwmYiScCmDxhtNOKl8yDr3icaG131GvU.woff2) format("woff2");unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:Merriweather;font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(https://fonts.gstatic.com/s/merriweather/v31/u-4D0qyriQwlOrhSvowK_l5UcA6zuSYEqOzpPe3HOZJ5eX1WtLaQwmYiScCmDxhtNOKl8yDr3icaGl31GvU.woff2) format("woff2");unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:Merriweather;font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(https://fonts.gstatic.com/s/merriweather/v31/u-4D0qyriQwlOrhSvowK_l5UcA6zuSYEqOzpPe3HOZJ5eX1WtLaQwmYiScCmDxhtNOKl8yDr3icaFF31.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}[_nghost-%COMP%]{font-family:Merriweather,serif}.mis-rallies[_ngcontent-%COMP%]{background:url(/images/fondo3.jpg) no-repeat center top;background-size:cover;min-height:100vh;padding:1rem}.mis-rallies-header[_ngcontent-%COMP%]{background-color:#7b4f24;color:#f9f4e6;padding:1.5rem 2rem;border-radius:1rem;box-shadow:0 .25rem .625rem #7b4f2480;margin:0 1rem 2rem;-webkit-user-select:none;user-select:none}.mis-rallies-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0 0 .8rem;font-weight:700;font-size:2rem;text-shadow:1px 1px 4px #3c2608}.tabs[_ngcontent-%COMP%]{display:flex;gap:1rem}.tabs[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:transparent;border:none;color:#e0cda9;font-weight:600;font-size:1rem;padding:.5rem 1rem;border-bottom:.25rem solid transparent;cursor:pointer;transition:color .3s ease,border-bottom-color .3s ease;white-space:nowrap}.tabs[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{color:#fff6d6}.tabs[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{border-bottom-color:#f2d388;color:#f9f4e6;font-weight:700}.titulo-seccion[_ngcontent-%COMP%]{text-align:center;font-size:2rem;margin:1rem;color:#4a2c14;font-weight:700;text-shadow:.0625rem .0625rem .125rem #d4a373}.rally-card[_ngcontent-%COMP%]{background-color:#f2d388;padding:3rem;border-radius:1.5rem;box-shadow:0 .5rem 1.5rem #8b45131a;border:.0625rem solid #e0c9a6;margin:2rem auto;max-width:95%}.card-title[_ngcontent-%COMP%]{font-size:2rem;font-weight:700;color:#5c3a1e;margin-bottom:2rem;text-align:center;text-shadow:.1rem .1rem .2rem #d4a373}h6[_ngcontent-%COMP%]{font-size:1.3rem;color:#5c3a1e;margin-bottom:1.5rem;text-align:center}.miniaturas-container[_ngcontent-%COMP%]{margin-top:2rem}.miniaturas[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:1.5rem;justify-content:center}.foto-preview[_ngcontent-%COMP%]{text-align:center;max-width:25rem;flex:1 1 30%;position:relative}.foto-preview[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;max-width:370px;height:auto;aspect-ratio:370 / 300;object-fit:cover;border:.25rem solid #d4a373;border-radius:1rem;box-shadow:0 .25rem 1rem #00000026;cursor:pointer;transition:transform .3s ease,box-shadow .3s ease;position:relative;z-index:1}.foto-preview[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:.5rem 0;font-size:1.2rem;font-weight:700;text-align:center}.estado-aprobada[_ngcontent-%COMP%]{color:#4caf50;font-size:1.25rem;font-weight:700}.estado-pendiente[_ngcontent-%COMP%]{color:#ac8511;font-size:1.25rem;font-weight:700}.estado-rechazada[_ngcontent-%COMP%]{color:#f44336;font-size:1.25rem;font-weight:700}.btn[_ngcontent-%COMP%], .btn.volver[_ngcontent-%COMP%]{background-color:sienna;color:#fff;border:none;padding:1rem 2rem;border-radius:.625rem;cursor:pointer;font-size:1.25rem;font-weight:700;text-align:center;display:block;margin:2rem auto;transition:background-color .3s ease}.btn[_ngcontent-%COMP%]:hover, .btn.volver[_ngcontent-%COMP%]:hover{background-color:#8b4513}.btn-secondary[_ngcontent-%COMP%]{background-color:#ddd;color:#333;padding:.75rem 1.5rem;margin-left:1rem;border-radius:.5rem;border:none;cursor:pointer}.modal-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#0009;display:flex;justify-content:center;align-items:center;z-index:9999;cursor:zoom-out}.modal-content[_ngcontent-%COMP%]{background:#fffaf5;padding:1.5rem;border-radius:1.25rem;border:.0625rem solid #e0c9a6;box-shadow:0 .375rem .9375rem #8b451340;width:90%;height:auto;max-width:70rem;max-height:100vh;overflow-y:auto;text-align:center;cursor:default}.modal-content[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:auto;border-radius:1rem;object-fit:contain}.popup-error[_ngcontent-%COMP%]{position:fixed;top:1.25rem;right:1.25rem;background-color:#b22222;color:#fff;padding:1rem 1.5rem;border-radius:.5rem;z-index:10000;box-shadow:0 .25rem .5rem #0003;animation:_ngcontent-%COMP%_fadeInOut 3s ease-in-out;font-family:Merriweather,serif}@keyframes _ngcontent-%COMP%_fadeInOut{0%{opacity:0;transform:translateY(-.625rem)}10%{opacity:1;transform:translateY(0)}90%{opacity:1;transform:translateY(0)}to{opacity:0;transform:translateY(-.625rem)}}@media (max-width: 900px){.rally-card[_ngcontent-%COMP%]{padding:2rem;max-width:95%}.foto-preview[_ngcontent-%COMP%]{max-width:80%;flex:1 1 45%}.card-title[_ngcontent-%COMP%]{font-size:2rem}}@media (max-width: 600px){.mis-rallies[_ngcontent-%COMP%]{padding:1rem .5rem}.mis-rallies-header[_ngcontent-%COMP%]{padding:1rem;margin:0 .5rem}.tabs[_ngcontent-%COMP%]{gap:.5rem}.tabs[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:1rem;padding:.5rem 1rem}.titulo-seccion[_ngcontent-%COMP%]{font-size:2rem}.rally-card[_ngcontent-%COMP%]{padding:1.5rem}.foto-preview[_ngcontent-%COMP%]{max-width:100%;flex:1 1 100%}.btn[_ngcontent-%COMP%]{font-size:1rem;padding:.75rem 1.25rem}.modal-content[_ngcontent-%COMP%]{padding:2rem;width:95%}}*[_ngcontent-%COMP%]{box-sizing:border-box}img[_ngcontent-%COMP%]{max-width:100%;height:auto}']})};var ds=["editFileInput"],ms=()=>["/mis-rallies"],us=()=>["/faqs"],ps=(i,t,e)=>({"estado-aprobada":i,"estado-pendiente":t,"estado-rechazada":e});function fs(i,t){if(i&1){let e=V();s(0,"img",24),_("error",function(){x(e);let r=g().$implicit;return w(r.photo_url=null)}),a()}if(i&2){let e=g().$implicit,n=g(2);Ji("alt",e.title),u("src",n.getFullImageUrl(e.photo_url),De)}}function gs(i,t){i&1&&(s(0,"span"),c(1," Aprobada \u2705"),a())}function hs(i,t){i&1&&(s(0,"span"),c(1," Pendiente \u23F3"),a())}function _s(i,t){i&1&&(s(0,"span"),c(1," Rechazada \u274C"),a())}function bs(i,t){if(i&1){let e=V();s(0,"div",15),h(1,fs,1,2,"img",16),s(2,"h3"),c(3),a(),s(4,"p",17)(5,"span",18),c(6,"Estado:"),a(),s(7,"span",19),Pe(8,20),h(9,gs,2,0,"span",21)(10,hs,2,0,"span",21)(11,_s,2,0,"span",21),Oe(),a()(),s(12,"button",22),_("click",function(){let r=x(e).$implicit,o=g(2);return w(o.editPhoto(r))}),c(13,"Editar"),a(),s(14,"button",23),_("click",function(){let r=x(e).$implicit,o=g(2);return w(o.deletePhoto(r.id))}),c(15,"Eliminar"),a()()}if(i&2){let e=t.$implicit;m(),u("ngIf",e.photo_url),m(2),D(e.title),m(4),u("ngClass",an(7,ps,e.status==="aprobada",e.status==="pendiente",e.status==="rechazada")),m(),u("ngSwitch",e.status),m(),u("ngSwitchCase","aprobada"),m(),u("ngSwitchCase","pendiente"),m(),u("ngSwitchCase","rechazada")}}function vs(i,t){if(i&1&&(s(0,"div",13),h(1,bs,16,11,"div",14),a()),i&2){let e=g();m(),u("ngForOf",e.fotos)}}function ys(i,t){i&1&&(s(0,"div",25)(1,"p"),c(2,"No hay fotos para mostrar."),a()())}function Cs(i,t){i&1&&(s(0,"div",39),c(1," Solo se puede modificar el nombre. La imagen ya fue aprobada. "),a())}function xs(i,t){i&1&&(s(0,"p",40),c(1," No se puede cambiar la imagen si la foto ya fue aprobada. "),a())}function ws(i,t){if(i&1&&(s(0,"div",41),O(1,"img",42),a()),i&2){let e=g(2);m(),u("src",e.imagePreview,De)}}function Ss(i,t){if(i&1){let e=V();s(0,"div",26)(1,"div",27)(2,"h4",28),c(3),a(),h(4,Cs,2,0,"div",29),s(5,"label",30),c(6,"Nuevo T\xEDtulo"),a(),s(7,"input",31),de("ngModelChange",function(r){x(e);let o=g();return ce(o.selectedPhoto.title,r)||(o.selectedPhoto.title=r),w(r)}),a(),s(8,"label",32),c(9,"Nueva Foto"),a(),s(10,"input",33,0),_("change",function(r){x(e);let o=g();return w(o.onFileSelected(r))}),a(),h(12,xs,2,0,"p",34)(13,ws,2,1,"div",35),s(14,"div",36)(15,"button",37),_("click",function(){x(e);let r=g();return w(r.onSaveEdit())}),c(16,"Guardar cambios"),a(),s(17,"button",38),_("click",function(){x(e);let r=g();return w(r.closeEditModal())}),c(18,"Cerrar"),a()()()()}if(i&2){let e=g();m(3),R("Editar Foto: ",e.selectedPhoto==null?null:e.selectedPhoto.title,""),m(),u("ngIf",(e.selectedPhoto==null?null:e.selectedPhoto.status)==="aprobada"),m(3),le("ngModel",e.selectedPhoto.title),m(3),u("disabled",(e.selectedPhoto==null?null:e.selectedPhoto.status)==="aprobada"),m(2),u("ngIf",(e.selectedPhoto==null?null:e.selectedPhoto.status)==="aprobada"),m(),u("ngIf",e.imagePreview)}}var On=class i{constructor(t,e,n,r){this.photoService=t;this.router=e;this.sweetAlert=n;this.fb=r}tabActivo="misfotos";usuario=null;fotos=[];rallySeleccionado=null;isModalOpen=!1;imagePreview;selectedFile=null;isEditModalOpen=!1;selectedPhoto=null;editForm;userId=0;fotosAprobadas={};editFileInput;ngOnInit(){let t=localStorage.getItem("userId");t?(this.userId=parseInt(t,10),this.loadPhotos(),this.loadAprobadas()):(this.sweetAlert.info("Usuario no encontrado."),this.router.navigate(["/login"]))}seleccionarTab(t){this.tabActivo=t}loadPhotos(){this.photoService.getFotosUsuarioActuales(this.userId).subscribe({next:t=>{this.fotos=(t?.photos||[]).map(e=>fe(B({},e),{photo_url:`${oe.apiUrl}/${e.photo_url}?t=${Date.now()}`}))},error:t=>{console.error("Error al cargar las fotos:",t),this.sweetAlert.warning("Error al cargar las fotos.")}})}loadAprobadas(){this.photoService.getFotosAprobadasPorUsuario(this.userId).subscribe({next:t=>{t.forEach(e=>{this.photoService.getFotosAprobadas(e,this.userId).subscribe(n=>{this.fotosAprobadas[e]=n})})},error:t=>{console.error("Error al obtener rallies con fotos aprobadas:",t)}})}deletePhoto(t){let e=this.fotos.find(n=>n.id===t);if(!e)return this.sweetAlert.warning("Foto no encontrada");if(e.status==="aprobada"){this.sweetAlert.warning("No se puede eliminar una foto que ya fue aprobada.");return}this.sweetAlert.confirm("\xBFEst\xE1s seguro?","Esta acci\xF3n eliminar\xE1 la foto permanentemente.").then(n=>{n&&this.photoService.deletePhoto(t,this.userId).subscribe({next:()=>{this.fotos=this.fotos.filter(r=>r.id!==t),this.sweetAlert.success("\xA1Foto eliminada correctamente!")},error:r=>{console.error("Error al eliminar la foto:",r),this.sweetAlert.warning("Error al eliminar la foto.")}})})}editPhoto(t){this.selectedPhoto=B({},t),this.imagePreview=t.photo_url,this.selectedFile=null,this.isEditModalOpen=!0}closeEditModal(){this.isEditModalOpen=!1,this.selectedPhoto=null,this.imagePreview=void 0,this.selectedFile=null}onSaveEdit(){let t=this.editFileInput?.nativeElement,e;t&&t.files&&t.files.length>0&&(e=t.files[0]),this.photoService.editPhoto(this.userId,this.selectedPhoto.id,this.selectedPhoto.title.trim(),e).subscribe({next:n=>{let r=this.fotos.findIndex(o=>o.id===this.selectedPhoto.id);r!==-1&&(this.fotos[r]=fe(B({},this.fotos[r]),{title:this.selectedPhoto.title,status:this.fotos[r].status==="rechazada"?"pendiente":this.fotos[r].status,photo_url:`${n.photo_url}?t=${Date.now()}`}),this.selectedPhoto=B({},this.fotos[r]),this.imagePreview=this.selectedPhoto.photo_url),this.sweetAlert.success("Foto actualizada correctamente"),this.closeEditModal(),this.loadPhotos()},error:n=>{console.error("Error al editar:",n),this.sweetAlert.warning("Error al editar la foto")}})}onFileSelected(t){let e=t.target;if(e.files&&e.files.length>0){let n=e.files[0],r=n.name.replace(/\.[^/.]+$/,"");this.selectedPhoto.title=r;let o=new FileReader;o.onload=()=>{this.imagePreview=o.result},o.readAsDataURL(n)}}getFullImageUrl(t){return t.startsWith("http")?t:`${oe.apiUrl}/${t}`}openEditModal(t){this.isModalOpen=!0,this.rallySeleccionado=t}closeModal(){this.isModalOpen=!1,this.imagePreview=void 0,this.selectedFile=null}onSubmit(){this.rallySeleccionado&&this.selectedFile?this.photoService.uploadPhoto(this.selectedFile,this.userId,this.rallySeleccionado.id,this.rallySeleccionado.title).subscribe({next:()=>{this.sweetAlert.success("Foto subida correctamente"),this.closeModal(),this.loadPhotos()},error:t=>{console.error("Error al subir la foto:",t),this.sweetAlert.warning("Error al subir la foto")}}):this.sweetAlert.info("Por favor selecciona una foto y un rally.")}volverADashboard(){this.router.navigateByUrl("/",{skipLocationChange:!0}).then(()=>{this.router.navigate(["/user/dashboard"])})}entrarGaleria(){this.router.navigate(["/gallery"],{queryParams:{from:"dashboard"}})}goBackToUserPanel(){this.router.navigate(["/user/dashboard"])}static \u0275fac=function(e){return new(e||i)(y(He),y(A),y(Ae),y(it))};static \u0275cmp=k({type:i,selectors:[["app-mis-fotos"]],viewQuery:function(e,n){if(e&1&&er(ds,5),e&2){let r;tr(r=nr())&&(n.editFileInput=r.first)}},decls:22,vars:17,consts:[["editFileInput",""],[1,"mis-fotos"],[1,"mis-fotos-header"],[1,"tabs"],[3,"click"],[3,"routerLink"],[1,"container"],[1,"section-title"],["class","photo-grid",4,"ngIf"],["class","no-photos",4,"ngIf"],["class","modal-overlay",4,"ngIf"],[1,"button-container"],[1,"back-button",3,"click"],[1,"photo-grid"],["class","photo-card",4,"ngFor","ngForOf"],[1,"photo-card"],["class","photo-img",3,"src","alt","error",4,"ngIf"],[1,"status-text"],[2,"color","#5c3a1e"],[3,"ngClass"],[3,"ngSwitch"],[4,"ngSwitchCase"],[1,"edit-btn",3,"click"],[1,"delete-btn",3,"click"],[1,"photo-img",3,"error","src","alt"],[1,"no-photos"],[1,"modal-overlay"],[1,"modal-content"],[1,"modal-title"],["class","alert alert-warning","style","margin-bottom: 10px;",4,"ngIf"],["for","title"],["type","text","placeholder","Nuevo t\xEDtulo",1,"form-control",3,"ngModelChange","ngModel"],["for","photo"],["type","file","id","photo",1,"photo-file-input",3,"change","disabled"],["class","disabled-note","style","color: #8b4513;",4,"ngIf"],["class","preview-container",4,"ngIf"],[1,"modal-buttons"],[1,"save-btn",3,"click"],[1,"close-btn",3,"click"],[1,"alert","alert-warning",2,"margin-bottom","10px"],[1,"disabled-note",2,"color","#8b4513"],[1,"preview-container"],["alt","Vista previa",1,"preview-img",3,"src"]],template:function(e,n){e&1&&(s(0,"div",1)(1,"header",2)(2,"nav",3)(3,"button",4),_("click",function(){return n.volverADashboard()}),c(4,"Perfil"),a(),s(5,"button",5),c(6,"Mis Rallies"),a(),s(7,"button",4),_("click",function(){return n.seleccionarTab("mis-fotos")}),c(8,"Mis Fotos"),a(),s(9,"button",4),_("click",function(){return n.entrarGaleria()}),c(10,"Galer\xEDa"),a(),s(11,"button",5),c(12,"FAQs"),a()()(),s(13,"div",6)(14,"h2",7),c(15,"Mis Fotos"),a(),h(16,vs,2,1,"div",8)(17,ys,3,0,"div",9)(18,Ss,19,6,"div",10),s(19,"div",11)(20,"button",12),_("click",function(){return n.goBackToUserPanel()}),c(21,"Volver"),a()()()()),e&2&&(m(3),X("active",n.tabActivo==="perfil"),m(2),X("active",n.tabActivo==="misrallies"),u("routerLink",Ye(15,ms)),m(2),X("active",n.tabActivo==="misfotos"),m(2),X("active",n.tabActivo==="gallery"),m(2),X("active",n.tabActivo==="faqs"),u("routerLink",Ye(16,us)),m(5),u("ngIf",n.fotos.length>0),m(),u("ngIf",n.fotos.length===0),m(),u("ngIf",n.isEditModalOpen))},dependencies:[U,Be,$,K,sn,ln,Q,ye,Ce,nt,je,Ct,rt],styles:['@font-face{font-family:Merriweather;font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(https://fonts.gstatic.com/s/merriweather/v31/u-4D0qyriQwlOrhSvowK_l5UcA6zuSYEqOzpPe3HOZJ5eX1WtLaQwmYiScCmDxhtNOKl8yDr3icaGV31GvU.woff2) format("woff2");unicode-range:U+0460-052F,U+1C80-1C8A,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:Merriweather;font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(https://fonts.gstatic.com/s/merriweather/v31/u-4D0qyriQwlOrhSvowK_l5UcA6zuSYEqOzpPe3HOZJ5eX1WtLaQwmYiScCmDxhtNOKl8yDr3icaEF31GvU.woff2) format("woff2");unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:Merriweather;font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(https://fonts.gstatic.com/s/merriweather/v31/u-4D0qyriQwlOrhSvowK_l5UcA6zuSYEqOzpPe3HOZJ5eX1WtLaQwmYiScCmDxhtNOKl8yDr3icaG131GvU.woff2) format("woff2");unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:Merriweather;font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(https://fonts.gstatic.com/s/merriweather/v31/u-4D0qyriQwlOrhSvowK_l5UcA6zuSYEqOzpPe3HOZJ5eX1WtLaQwmYiScCmDxhtNOKl8yDr3icaGl31GvU.woff2) format("woff2");unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:Merriweather;font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(https://fonts.gstatic.com/s/merriweather/v31/u-4D0qyriQwlOrhSvowK_l5UcA6zuSYEqOzpPe3HOZJ5eX1WtLaQwmYiScCmDxhtNOKl8yDr3icaFF31.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}[_nghost-%COMP%]{font-family:Merriweather,serif}.mis-fotos[_ngcontent-%COMP%]{background:url(/images/fondo3.jpg) no-repeat center top;background-size:cover;min-height:80vh;padding:1rem}.mis-fotos-header[_ngcontent-%COMP%]{background-color:#7b4f24;color:#f9f4e6;padding:1.5rem 2rem;border-radius:8px;box-shadow:0 4px 10px #7b4f2480;margin-bottom:1.5rem;-webkit-user-select:none;user-select:none}.mis-fotos-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0 0 .8rem;font-weight:700;font-size:2rem;text-shadow:1px 1px 4px #3c2608}.tabs[_ngcontent-%COMP%]{display:flex;gap:1rem}.tabs[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:transparent;border:none;color:#e0cda9;font-weight:600;font-size:1rem;padding:.5rem 1rem;border-bottom:3px solid transparent;cursor:pointer;transition:color .3s ease,border-bottom-color .3s ease}.tabs[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{color:#fff6d6}.tabs[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{border-bottom-color:#f2d388;color:#f9f4e6;font-weight:700}.section-title[_ngcontent-%COMP%]{text-align:center;font-size:2rem;margin:1rem;color:#4a2c14;font-weight:700;text-shadow:1px 1px 2px #d4a373}.photo-grid[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:1.5rem;justify-content:center}.photo-card[_ngcontent-%COMP%]{background-color:#f2d388;border:1px solid #e0c9a6;padding:1rem;border-radius:10px;box-shadow:0 2px 8px #8b45131a;width:280px;text-align:center;transition:transform .3s ease}.photo-card[_ngcontent-%COMP%]:hover{transform:translateY(-5px);box-shadow:0 10px 20px #8b45134d}.photo-img[_ngcontent-%COMP%]{width:100%;height:auto;border:2px solid #d4a373;border-radius:8px;box-shadow:0 2px 6px #0000001a;margin-bottom:.8rem}h3[_ngcontent-%COMP%]{font-size:1.1rem;color:#5c3a1e;margin:.5rem 0}.status-text[_ngcontent-%COMP%]{color:#5c3a1e;font-size:.95rem;font-weight:700;margin-bottom:.8rem}.edit-btn[_ngcontent-%COMP%], .delete-btn[_ngcontent-%COMP%]{padding:.5rem 1rem;margin:.3rem;border:none;border-radius:5px;font-weight:700;cursor:pointer;font-size:.95rem;transition:background-color .3s ease}.edit-btn[_ngcontent-%COMP%]{background-color:sienna;color:#fff}.edit-btn[_ngcontent-%COMP%]:hover{background-color:#8b4513}.delete-btn[_ngcontent-%COMP%]{background-color:#b22222;color:#fff}.delete-btn[_ngcontent-%COMP%]:hover{background-color:#992f2f}.modal-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#0009;display:flex;justify-content:center;align-items:center;z-index:1000}.modal-content[_ngcontent-%COMP%]{background:#fffaf5;padding:2rem;border-radius:12px;border:1px solid #e0c9a6;box-shadow:0 6px 15px #8b451340;width:90%;max-width:500px;text-align:center}.modal-title[_ngcontent-%COMP%]{color:#5c3a1e;font-size:1.5rem;margin-bottom:1rem}.photo-title-input[_ngcontent-%COMP%]{width:100%;padding:.6rem;border-radius:8px;border:1px solid #d3c2a2;margin-bottom:1rem;background-color:#fdf7ed;font-family:Merriweather,serif}.disabled-note[_ngcontent-%COMP%]{color:#888;font-size:.85rem;margin-top:.5rem}.preview-container[_ngcontent-%COMP%]{margin:1rem 0;text-align:center}.preview-img[_ngcontent-%COMP%]{max-width:100%;border-radius:8px;border:2px solid #d4a373;box-shadow:0 2px 10px #7b4f2433}.modal-buttons[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:1rem;margin-top:1.5rem}.save-btn[_ngcontent-%COMP%]{background-color:sienna;color:#fff;padding:.6rem 1.2rem;border-radius:5px;border:none;font-weight:700;cursor:pointer}.save-btn[_ngcontent-%COMP%]:hover{background-color:#8b4513}.close-btn[_ngcontent-%COMP%]{background-color:#ddd;color:#333;padding:.6rem 1.2rem;border-radius:5px;border:none;cursor:pointer;font-weight:700}.close-btn[_ngcontent-%COMP%]:hover{background-color:#bbb}.no-photos[_ngcontent-%COMP%]{text-align:center;font-size:1rem;color:#5c3a1e;margin-top:2rem;font-weight:700}.button-container[_ngcontent-%COMP%]{margin-top:2rem;text-align:center}.back-button[_ngcontent-%COMP%]{background-color:#8b4513;color:#fff;border:none;padding:.6rem 1.2rem;border-radius:5px;cursor:pointer;transition:background-color .3s ease;font-size:1rem;font-weight:700;text-align:center}.back-button[_ngcontent-%COMP%]:hover{background-color:sienna}.estado-aprobada[_ngcontent-%COMP%]{color:#4caf50;font-size:1rem;font-weight:700}.estado-pendiente[_ngcontent-%COMP%]{color:#ac8511;font-size:1rem;font-weight:700}.estado-rechazada[_ngcontent-%COMP%]{color:#f44336;font-size:1rem;font-weight:700}@media (max-width: 600px){.mis-fotos[_ngcontent-%COMP%]{padding:1rem .5rem}.mis-fotos-header[_ngcontent-%COMP%]{padding:1rem}.tabs[_ngcontent-%COMP%]{flex-wrap:nowrap;overflow-x:auto;-webkit-overflow-scrolling:touch}.tabs[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:0 0 auto;padding:.5rem .8rem;font-size:.9rem}.section-title[_ngcontent-%COMP%]{font-size:2rem;margin:1rem .5rem}.photo-grid[_ngcontent-%COMP%]{gap:1rem}.photo-card[_ngcontent-%COMP%]{width:100%;max-width:100%;padding:.8rem}h3[_ngcontent-%COMP%]{font-size:1rem}.status-text[_ngcontent-%COMP%]{font-size:.9rem}.edit-btn[_ngcontent-%COMP%], .delete-btn[_ngcontent-%COMP%]{font-size:.85rem;padding:.4rem .8rem}.modal-content[_ngcontent-%COMP%]{width:95%;padding:1.5rem}.modal-title[_ngcontent-%COMP%]{font-size:1.3rem}.photo-title-input[_ngcontent-%COMP%]{font-size:.9rem;padding:.5rem}.save-btn[_ngcontent-%COMP%], .close-btn[_ngcontent-%COMP%]{font-size:.9rem;padding:.5rem 1rem}}@media (min-width: 601px) and (max-width: 900px){.mis-fotos[_ngcontent-%COMP%]{padding:1rem}.tabs[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:1rem;padding:.5rem 1rem}.section-title[_ngcontent-%COMP%]{font-size:2.5rem}.photo-grid[_ngcontent-%COMP%]{gap:1.2rem}.photo-card[_ngcontent-%COMP%]{width:calc(50% - 1.2rem)}}@media (min-width: 901px){.photo-card[_ngcontent-%COMP%]{width:280px}}.photo-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:1.5rem;justify-content:center}.tabs[_ngcontent-%COMP%]{scrollbar-width:thin;scrollbar-color:#f2d388 transparent}.tabs[_ngcontent-%COMP%]::-webkit-scrollbar{height:6px}.tabs[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.tabs[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background-color:#f2d388;border-radius:3px}input[type=file][_ngcontent-%COMP%]{max-width:100%}.button-container[_ngcontent-%COMP%]{padding:0 .5rem}.back-button[_ngcontent-%COMP%]{width:100%;max-width:300px;font-size:1rem}']})};var Es=()=>["/mis-rallies"],Ms=()=>["/mis-fotos"];function Ps(i,t){if(i&1){let e=V();s(0,"div",9)(1,"div",10),_("click",function(){let r=x(e).index,o=g();return w(o.toggle(r))}),s(2,"span"),c(3),a(),s(4,"span",11),c(5),a()(),O(6,"div",12),a()}if(i&2){let e=t.$implicit;m(3),D(e.pregunta),m(2),D(e.abierta?"\u25B2":"\u25BC"),m(),X("abierto",e.abierta),u("innerHTML",e.respuesta,Vt)}}var Tn=class i{constructor(t,e){this.photoService=t;this.router=e}tabActivo="faqs";preguntasRespuestas=[{pregunta:"\xBFQuieres saber c\xF3mo moverte por toda la App?",respuesta:'Aqu\xED puedes descargar nuestro <a href="/docs/manual-usuario.pdf" download target="_blank" class="btn-descarga">manual de usuario (PDF)</a>.',abierta:!1},{pregunta:"\xBFCu\xE1ntas fotos puedo subir por rally?",respuesta:"Puedes subir hasta 3 fotos por cada rally<br> !Mientras m\xE1s fotos subas m\xE1s posibiliades de ganar!",abierta:!1},{pregunta:"\xBFQu\xE9 requisitos deben cumplir las fotos?",respuesta:"Las fotos deben seguir la tem\xE1tica del rally para ser aceptadas.<br>\u2022 Deben ser originales y no haber sido publicadas anteriormente en ning\xFAn otro lugar.<br>\u2022 Deben ser tomadas por el participante y no pueden ser editadas con programas de edici\xF3n de im\xE1genes.<br>\u2022 Deben ser enviadas en formato digital (JPG o PNG) y no superar los 5 MB.",abierta:!1},{pregunta:"\xBFQu\xE9 estados puede tener mi foto?",respuesta:`
        El administrador revisar\xE1 las fotos y cambiar\xE1 su estado a:<br>
        \u2022 <strong>Admitida</strong>: \xA1Tu foto participa oficialmente!<br>
        \u2022 <strong>Pendiente</strong>: Est\xE1 en revisi\xF3n.<br>
        \u2022 <strong>Rechazada</strong>: No cumple con los requisitos.
      `,abierta:!1},{pregunta:"\xBFPuedo editar o eliminar mis fotos?",respuesta:"Puedes eliminar o reemplazar tus fotos mientras el rally est\xE9 activo.",abierta:!1},{pregunta:"\xBFPuedo modificar mis fotos tras finalizar el rally?",respuesta:"No. Una vez finalizado el rally, no podr\xE1s modificar tus fotos.",abierta:!1},{pregunta:"\xBFC\xF3mo funciona la votaci\xF3n?",respuesta:"Puedes votar por tus fotos favoritas en la galer\xEDa mientras est\xE9 activo el rally.",abierta:!1},{pregunta:"\xBFQu\xE9 pasa con las fotos ganadoras?",respuesta:"Las fotos ganadoras se anunciar\xE1n en la galer\xEDa.",abierta:!1},{pregunta:"\xBFTienes m\xE1s dudas o necesitas ayuda?",respuesta:"Puedes ponerte en contacto a gtraves de nuestro correo el\xE9ctronico: expresscapturesvz.admin@gmail.com.",abierta:!1}];ngOnInit(){}toggle(t){this.preguntasRespuestas[t].abierta=!this.preguntasRespuestas[t].abierta}seleccionarTab(t){this.tabActivo=t}volverADashboard(){this.router.navigateByUrl("/",{skipLocationChange:!0}).then(()=>{this.router.navigate(["/user/dashboard"])})}entrarGaleria(){this.router.navigate(["/gallery"],{queryParams:{from:"dashboard"}})}goBackToUserPanel(){this.router.navigate(["/user/dashboard"])}static \u0275fac=function(e){return new(e||i)(y(He),y(A))};static \u0275cmp=k({type:i,selectors:[["app-faqs"]],decls:20,vars:15,consts:[[1,"faqs"],[1,"faqs-header"],[1,"tabs"],[3,"click"],[3,"routerLink"],[1,"acordeon-card"],["class","acordeon",4,"ngFor","ngForOf"],[1,"button-container"],[1,"back-button",3,"click"],[1,"acordeon"],[1,"acordeon-header",3,"click"],[1,"flecha"],[1,"acordeon-body",3,"innerHTML"]],template:function(e,n){e&1&&(s(0,"div",0)(1,"header",1)(2,"nav",2)(3,"button",3),_("click",function(){return n.volverADashboard()}),c(4,"Perfil"),a(),s(5,"button",4),c(6,"Mis Rallies"),a(),s(7,"button",4),c(8,"Mis Fotos"),a(),s(9,"button",3),_("click",function(){return n.entrarGaleria()}),c(10,"Galer\xEDa"),a(),s(11,"button",3),_("click",function(){return n.seleccionarTab("faqs")}),c(12,"FAQs"),a()()(),s(13,"div",5)(14,"h2"),c(15,"Preguntas Frecuentes"),a(),h(16,Ps,7,5,"div",6),a(),s(17,"div",7)(18,"button",8),_("click",function(){return n.goBackToUserPanel()}),c(19,"Volver"),a()()()),e&2&&(m(3),X("active",n.tabActivo==="perfil"),m(2),X("active",n.tabActivo==="misrallies"),u("routerLink",Ye(13,Es)),m(2),X("active",n.tabActivo==="misfotos"),u("routerLink",Ye(14,Ms)),m(2),X("active",n.tabActivo==="gallery"),m(2),X("active",n.tabActivo==="faqs"),m(5),u("ngForOf",n.preguntasRespuestas))},dependencies:[U,$,Q,je,Ct],styles:['@font-face{font-family:Merriweather;font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(https://fonts.gstatic.com/s/merriweather/v31/u-4D0qyriQwlOrhSvowK_l5UcA6zuSYEqOzpPe3HOZJ5eX1WtLaQwmYiScCmDxhtNOKl8yDr3icaGV31GvU.woff2) format("woff2");unicode-range:U+0460-052F,U+1C80-1C8A,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:Merriweather;font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(https://fonts.gstatic.com/s/merriweather/v31/u-4D0qyriQwlOrhSvowK_l5UcA6zuSYEqOzpPe3HOZJ5eX1WtLaQwmYiScCmDxhtNOKl8yDr3icaEF31GvU.woff2) format("woff2");unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:Merriweather;font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(https://fonts.gstatic.com/s/merriweather/v31/u-4D0qyriQwlOrhSvowK_l5UcA6zuSYEqOzpPe3HOZJ5eX1WtLaQwmYiScCmDxhtNOKl8yDr3icaG131GvU.woff2) format("woff2");unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:Merriweather;font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(https://fonts.gstatic.com/s/merriweather/v31/u-4D0qyriQwlOrhSvowK_l5UcA6zuSYEqOzpPe3HOZJ5eX1WtLaQwmYiScCmDxhtNOKl8yDr3icaGl31GvU.woff2) format("woff2");unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:Merriweather;font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(https://fonts.gstatic.com/s/merriweather/v31/u-4D0qyriQwlOrhSvowK_l5UcA6zuSYEqOzpPe3HOZJ5eX1WtLaQwmYiScCmDxhtNOKl8yDr3icaFF31.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}.faqs[_ngcontent-%COMP%]{background:url(/images/fondo3.jpg) no-repeat center top;background-size:cover;min-height:100vh;padding:1rem 1rem 1rem 0rem}[_nghost-%COMP%]{font-family:Merriweather,serif}.faqs-header[_ngcontent-%COMP%]{background-color:#7b4f24;color:#f9f4e6;padding:1.5rem 2rem;border-radius:8px;box-shadow:0 4px 10px #7b4f2480;margin-bottom:1.5rem;-webkit-user-select:none;user-select:none}.faqs-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0 0 .8rem;font-weight:700;font-size:2rem;text-shadow:1px 1px 4px #3c2608}.tabs[_ngcontent-%COMP%]{display:flex;gap:1rem}.tabs[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:transparent;border:none;color:#e0cda9;font-weight:600;font-size:1rem;padding:.5rem 1rem;border-bottom:3px solid transparent;cursor:pointer;transition:color .3s ease,border-bottom-color .3s ease}.tabs[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{color:#fff6d6}.tabs[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{border-bottom-color:#f2d388;color:#f9f4e6;font-weight:700}.acordeon-card[_ngcontent-%COMP%]{background:#fff9ec;border-radius:16px;padding:2rem;box-shadow:0 6px 14px #d2a04666;color:#4b2e05;transition:box-shadow .3s ease;margin:2rem auto;max-width:800px}.acordeon-card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:2rem;font-weight:700;margin-bottom:1.5rem;color:#4b2e05;text-shadow:1px 1px 3px #7b4f24;display:flex;align-items:center;gap:.5rem}.acordeon[_ngcontent-%COMP%]{border-top:1px solid #ddb67d}.acordeon-header[_ngcontent-%COMP%]{padding:1rem;font-weight:700;font-size:1.1rem;cursor:pointer;display:flex;justify-content:space-between;color:#5e3c10;transition:background-color .3s ease}.acordeon-header[_ngcontent-%COMP%]:hover{background-color:#f5e2c4}.acordeon-body[_ngcontent-%COMP%]{max-height:0;overflow:hidden;transition:max-height .4s ease,padding .3s ease;background-color:#fff5dc;padding:0 1rem;color:#5e3c10;font-size:1rem}.acordeon-body.abierto[_ngcontent-%COMP%]{padding:1rem;max-height:300px}.flecha[_ngcontent-%COMP%]{font-size:1.2rem;color:#b3813a}.button-container[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-top:2rem}.back-button[_ngcontent-%COMP%]{background-color:#a1744f;color:#fff;padding:.8rem 1.6rem;border:none;border-radius:8px;font-weight:700;cursor:pointer;transition:background-color .3s ease}.back-button[_ngcontent-%COMP%]:hover{background-color:#8d5f38}.btn-descarga[_ngcontent-%COMP%]{display:inline-block;margin-top:10px;padding:8px 16px;background-color:#8b4513;color:#fff;border-radius:8px;text-decoration:none;font-weight:700;transition:background-color .3s}.btn-descarga[_ngcontent-%COMP%]:hover{background-color:#5c3a1e}@media (max-width: 1024px){.tabs[_ngcontent-%COMP%]{flex-wrap:wrap;justify-content:center}.acordeon-card[_ngcontent-%COMP%]{padding:1.5rem;margin:1.5rem auto}.faqs-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.8rem;text-align:center}}@media (max-width: 768px){.tabs[_ngcontent-%COMP%]{flex-direction:column;align-items:center;gap:.5rem}.tabs[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:1rem;padding:.6rem 1rem;width:100%;max-width:300px;text-align:center}.acordeon-card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.6rem;text-align:center;flex-direction:column}.acordeon-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}.flecha[_ngcontent-%COMP%]{align-self:flex-end}.back-button[_ngcontent-%COMP%]{width:100%;max-width:200px;font-size:1rem}}@media (max-width: 480px){.faqs[_ngcontent-%COMP%], .faqs-header[_ngcontent-%COMP%]{padding:1rem}.tabs[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:.95rem}.acordeon-card[_ngcontent-%COMP%]{padding:1rem}.acordeon-body[_ngcontent-%COMP%]{font-size:.95rem}.back-button[_ngcontent-%COMP%]{padding:.6rem 1.2rem}.btn-descarga[_ngcontent-%COMP%]{padding:6px 12px;font-size:.9rem}}']})};var br=[{path:"",component:fn},{path:"login",component:Ot},{path:"register",component:hn},{path:"gallery",component:_n},{path:"user/dashboard",loadComponent:()=>import("./chunk-3AE343IO.js").then(i=>i.DashboardComponent),canActivate:[ae,$e]},{path:"mis-rallies",component:Pn,canActivate:[ae,$e]},{path:"mis-fotos",component:On,canActivate:[ae,$e]},{path:"faqs",component:Tn,canActivate:[ae,$e]},{path:"proximos-rallies",component:bn,canActivate:[ae,$e]},{path:"rallies-actuales",component:vn,canActivate:[ae,$e]},{path:"rallies-pasados",component:yn,canActivate:[ae,$e]},{path:"admin/edit-user/:id",component:xn,canActivate:[ae,Ke]},{path:"admin/gestion-rallies",component:wn,canActivate:[ae,Ke]},{path:"admin/create-rallies",component:En,canActivate:[ae,Ke]},{path:"admin/edit-rallies/:id",component:Sn,canActivate:[ae,Ke]},{path:"admin/user-control",loadComponent:()=>import("./chunk-7FJT6NXB.js").then(i=>i.UserControlComponent),canActivate:[ae,Ke]},{path:"admin/user-photos",loadComponent:()=>import("./chunk-44K7WCJS.js").then(i=>i.UserPhotosComponent),canActivate:[ae,Ke]},{path:"admin",component:Cn,canActivate:[ae,Ke]},{path:"**",redirectTo:"",pathMatch:"full"}];var vr=(i,t)=>{let n=Je(ne).getToken();if(n){let r=i.clone({setHeaders:{Authorization:`Bearer ${n}`}});return t(r)}return t(i)};var F=function(i){return i[i.State=0]="State",i[i.Transition=1]="Transition",i[i.Sequence=2]="Sequence",i[i.Group=3]="Group",i[i.Animate=4]="Animate",i[i.Keyframes=5]="Keyframes",i[i.Style=6]="Style",i[i.Trigger=7]="Trigger",i[i.Reference=8]="Reference",i[i.AnimateChild=9]="AnimateChild",i[i.AnimateRef=10]="AnimateRef",i[i.Query=11]="Query",i[i.Stagger=12]="Stagger",i}(F||{}),Ie="*";function ii(i,t){return{type:F.Trigger,name:i,definitions:t,options:{}}}function Fn(i,t=null){return{type:F.Animate,styles:t,timings:i}}function yr(i,t=null){return{type:F.Sequence,steps:i,options:t}}function ot(i){return{type:F.Style,styles:i,offset:null}}function Ht(i,t,e){return{type:F.State,name:i,styles:t,options:e}}function An(i,t,e=null){return{type:F.Transition,expr:i,animation:t,options:e}}var Qe=class{_onDoneFns=[];_onStartFns=[];_onDestroyFns=[];_originalOnDoneFns=[];_originalOnStartFns=[];_started=!1;_destroyed=!1;_finished=!1;_position=0;parentPlayer=null;totalTime;constructor(t=0,e=0){this.totalTime=t+e}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}onStart(t){this._originalOnStartFns.push(t),this._onStartFns.push(t)}onDone(t){this._originalOnDoneFns.push(t),this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){queueMicrotask(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(t=>t()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(t){this._position=this.totalTime?t*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(t){let e=t=="start"?this._onStartFns:this._onDoneFns;e.forEach(n=>n()),e.length=0}},mt=class{_onDoneFns=[];_onStartFns=[];_finished=!1;_started=!1;_destroyed=!1;_onDestroyFns=[];parentPlayer=null;totalTime=0;players;constructor(t){this.players=t;let e=0,n=0,r=0,o=this.players.length;o==0?queueMicrotask(()=>this._onFinish()):this.players.forEach(l=>{l.onDone(()=>{++e==o&&this._onFinish()}),l.onDestroy(()=>{++n==o&&this._onDestroy()}),l.onStart(()=>{++r==o&&this._onStart()})}),this.totalTime=this.players.reduce((l,d)=>Math.max(l,d.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this.players.forEach(t=>t.init())}onStart(t){this._onStartFns.push(t)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(t=>t()),this._onStartFns=[])}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(t=>t.play())}pause(){this.players.forEach(t=>t.pause())}restart(){this.players.forEach(t=>t.restart())}finish(){this._onFinish(),this.players.forEach(t=>t.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(t=>t.destroy()),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this.players.forEach(t=>t.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(t){let e=t*this.totalTime;this.players.forEach(n=>{let r=n.totalTime?Math.min(1,e/n.totalTime):1;n.setPosition(r)})}getPosition(){let t=this.players.reduce((e,n)=>e===null||n.totalTime>e.totalTime?n:e,null);return t!=null?t.getPosition():0}beforeDestroy(){this.players.forEach(t=>{t.beforeDestroy&&t.beforeDestroy()})}triggerCallback(t){let e=t=="start"?this._onStartFns:this._onDoneFns;e.forEach(n=>n()),e.length=0}},At="!";var Cr=["toast-component",""];function Fs(i,t){if(i&1){let e=V();s(0,"button",5),_("click",function(){x(e);let r=g();return w(r.remove())}),s(1,"span",6),c(2,"\xD7"),a()()}}function As(i,t){if(i&1&&(Pe(0),c(1),Oe()),i&2){let e=g(2);m(),R("[",e.duplicatesCount+1,"]")}}function Is(i,t){if(i&1&&(s(0,"div"),c(1),h(2,As,2,1,"ng-container",4),a()),i&2){let e=g();he(e.options.titleClass),Bt("aria-label",e.title),m(),R(" ",e.title," "),m(),u("ngIf",e.duplicatesCount)}}function ks(i,t){if(i&1&&O(0,"div",7),i&2){let e=g();he(e.options.messageClass),u("innerHTML",e.message,Vt)}}function Ds(i,t){if(i&1&&(s(0,"div",8),c(1),a()),i&2){let e=g();he(e.options.messageClass),Bt("aria-label",e.message),m(),R(" ",e.message," ")}}function Rs(i,t){if(i&1&&(s(0,"div"),O(1,"div",9),a()),i&2){let e=g();m(),jt("width",e.width()+"%")}}function Us(i,t){if(i&1){let e=V();s(0,"button",5),_("click",function(){x(e);let r=g();return w(r.remove())}),s(1,"span",6),c(2,"\xD7"),a()()}}function Ns(i,t){if(i&1&&(Pe(0),c(1),Oe()),i&2){let e=g(2);m(),R("[",e.duplicatesCount+1,"]")}}function zs(i,t){if(i&1&&(s(0,"div"),c(1),h(2,Ns,2,1,"ng-container",4),a()),i&2){let e=g();he(e.options.titleClass),Bt("aria-label",e.title),m(),R(" ",e.title," "),m(),u("ngIf",e.duplicatesCount)}}function Ls(i,t){if(i&1&&O(0,"div",7),i&2){let e=g();he(e.options.messageClass),u("innerHTML",e.message,Vt)}}function Vs(i,t){if(i&1&&(s(0,"div",8),c(1),a()),i&2){let e=g();he(e.options.messageClass),Bt("aria-label",e.message),m(),R(" ",e.message," ")}}function Bs(i,t){if(i&1&&(s(0,"div"),O(1,"div",9),a()),i&2){let e=g();m(),jt("width",e.width()+"%")}}var ri=class{_attachedHost;component;viewContainerRef;injector;constructor(t,e){this.component=t,this.injector=e}attach(t,e){return this._attachedHost=t,t.attach(this,e)}detach(){let t=this._attachedHost;if(t)return this._attachedHost=void 0,t.detach()}get isAttached(){return this._attachedHost!=null}setAttachedHost(t){this._attachedHost=t}},oi=class{_attachedPortal;_disposeFn;attach(t,e){return this._attachedPortal=t,this.attachComponentPortal(t,e)}detach(){this._attachedPortal&&this._attachedPortal.setAttachedHost(),this._attachedPortal=void 0,this._disposeFn&&(this._disposeFn(),this._disposeFn=void 0)}setDisposeFn(t){this._disposeFn=t}},ai=class{_overlayRef;componentInstance;duplicatesCount=0;_afterClosed=new Le;_activate=new Le;_manualClose=new Le;_resetTimeout=new Le;_countDuplicate=new Le;constructor(t){this._overlayRef=t}manualClose(){this._manualClose.next(),this._manualClose.complete()}manualClosed(){return this._manualClose.asObservable()}timeoutReset(){return this._resetTimeout.asObservable()}countDuplicate(){return this._countDuplicate.asObservable()}close(){this._overlayRef.detach(),this._afterClosed.next(),this._manualClose.next(),this._afterClosed.complete(),this._manualClose.complete(),this._activate.complete(),this._resetTimeout.complete(),this._countDuplicate.complete()}afterClosed(){return this._afterClosed.asObservable()}isInactive(){return this._activate.isStopped}activate(){this._activate.next(),this._activate.complete()}afterActivate(){return this._activate.asObservable()}onDuplicate(t,e){t&&this._resetTimeout.next(),e&&this._countDuplicate.next(++this.duplicatesCount)}},It=class{toastId;config;message;title;toastType;toastRef;_onTap=new Le;_onAction=new Le;constructor(t,e,n,r,o,l){this.toastId=t,this.config=e,this.message=n,this.title=r,this.toastType=o,this.toastRef=l,this.toastRef.afterClosed().subscribe(()=>{this._onAction.complete(),this._onTap.complete()})}triggerTap(){this._onTap.next(),this.config.tapToDismiss&&this._onTap.complete()}onTap(){return this._onTap.asObservable()}triggerAction(t){this._onAction.next(t)}onAction(){return this._onAction.asObservable()}},xr={maxOpened:0,autoDismiss:!1,newestOnTop:!0,preventDuplicates:!1,countDuplicates:!1,resetTimeoutOnDuplicate:!1,includeTitleDuplicates:!1,iconClasses:{error:"toast-error",info:"toast-info",success:"toast-success",warning:"toast-warning"},closeButton:!1,disableTimeOut:!1,timeOut:5e3,extendedTimeOut:1e3,enableHtml:!1,progressBar:!1,toastClass:"ngx-toastr",positionClass:"toast-top-right",titleClass:"toast-title",messageClass:"toast-message",easing:"ease-in",easeTime:300,tapToDismiss:!0,onActivateTick:!1,progressAnimation:"decreasing"},wr=new Gi("ToastConfig"),si=class extends oi{_hostDomElement;_componentFactoryResolver;_appRef;constructor(t,e,n){super(),this._hostDomElement=t,this._componentFactoryResolver=e,this._appRef=n}attachComponentPortal(t,e){let n=this._componentFactoryResolver.resolveComponentFactory(t.component),r;return r=n.create(t.injector),this._appRef.attachView(r.hostView),this.setDisposeFn(()=>{this._appRef.detachView(r.hostView),r.destroy()}),e?this._hostDomElement.insertBefore(this._getComponentRootNode(r),this._hostDomElement.firstChild):this._hostDomElement.appendChild(this._getComponentRootNode(r)),r}_getComponentRootNode(t){return t.hostView.rootNodes[0]}},js=(()=>{class i{_document=Je(qt);_containerElement;ngOnDestroy(){this._containerElement&&this._containerElement.parentNode&&this._containerElement.parentNode.removeChild(this._containerElement)}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){let e=this._document.createElement("div");e.classList.add("overlay-container"),e.setAttribute("aria-live","polite"),this._document.body.appendChild(e),this._containerElement=e}static \u0275fac=function(n){return new(n||i)};static \u0275prov=Y({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),li=class{_portalHost;constructor(t){this._portalHost=t}attach(t,e=!0){return this._portalHost.attach(t,e)}detach(){return this._portalHost.detach()}},qs=(()=>{class i{_overlayContainer=Je(js);_componentFactoryResolver=Je(Yi);_appRef=Je(nn);_document=Je(qt);_paneElements=new Map;create(e,n){return this._createOverlayRef(this.getPaneElement(e,n))}getPaneElement(e="",n){return this._paneElements.get(n)||this._paneElements.set(n,{}),this._paneElements.get(n)[e]||(this._paneElements.get(n)[e]=this._createPaneElement(e,n)),this._paneElements.get(n)[e]}_createPaneElement(e,n){let r=this._document.createElement("div");return r.id="toast-container",r.classList.add(e),r.classList.add("toast-container"),n?n.getContainerElement().appendChild(r):this._overlayContainer.getContainerElement().appendChild(r),r}_createPortalHost(e){return new si(e,this._componentFactoryResolver,this._appRef)}_createOverlayRef(e){return new li(this._createPortalHost(e))}static \u0275fac=function(n){return new(n||i)};static \u0275prov=Y({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),Sr=(()=>{class i{overlay;_injector;sanitizer;ngZone;toastrConfig;currentlyActive=0;toasts=[];overlayContainer;previousToastMessage;index=0;constructor(e,n,r,o,l){this.overlay=n,this._injector=r,this.sanitizer=o,this.ngZone=l,this.toastrConfig=B(B({},e.default),e.config),e.config.iconClasses&&(this.toastrConfig.iconClasses=B(B({},e.default.iconClasses),e.config.iconClasses))}show(e,n,r={},o=""){return this._preBuildNotification(o,e,n,this.applyConfig(r))}success(e,n,r={}){let o=this.toastrConfig.iconClasses.success||"";return this._preBuildNotification(o,e,n,this.applyConfig(r))}error(e,n,r={}){let o=this.toastrConfig.iconClasses.error||"";return this._preBuildNotification(o,e,n,this.applyConfig(r))}info(e,n,r={}){let o=this.toastrConfig.iconClasses.info||"";return this._preBuildNotification(o,e,n,this.applyConfig(r))}warning(e,n,r={}){let o=this.toastrConfig.iconClasses.warning||"";return this._preBuildNotification(o,e,n,this.applyConfig(r))}clear(e){for(let n of this.toasts)if(e!==void 0){if(n.toastId===e){n.toastRef.manualClose();return}}else n.toastRef.manualClose()}remove(e){let n=this._findToast(e);if(!n||(n.activeToast.toastRef.close(),this.toasts.splice(n.index,1),this.currentlyActive=this.currentlyActive-1,!this.toastrConfig.maxOpened||!this.toasts.length))return!1;if(this.currentlyActive<this.toastrConfig.maxOpened&&this.toasts[this.currentlyActive]){let r=this.toasts[this.currentlyActive].toastRef;r.isInactive()||(this.currentlyActive=this.currentlyActive+1,r.activate())}return!0}findDuplicate(e="",n="",r,o){let{includeTitleDuplicates:l}=this.toastrConfig;for(let d of this.toasts){let p=l&&d.title===e;if((!l||p)&&d.message===n)return d.toastRef.onDuplicate(r,o),d}return null}applyConfig(e={}){return B(B({},this.toastrConfig),e)}_findToast(e){for(let n=0;n<this.toasts.length;n++)if(this.toasts[n].toastId===e)return{index:n,activeToast:this.toasts[n]};return null}_preBuildNotification(e,n,r,o){return o.onActivateTick?this.ngZone.run(()=>this._buildNotification(e,n,r,o)):this._buildNotification(e,n,r,o)}_buildNotification(e,n,r,o){if(!o.toastComponent)throw new Error("toastComponent required");let l=this.findDuplicate(r,n,this.toastrConfig.resetTimeoutOnDuplicate&&o.timeOut>0,this.toastrConfig.countDuplicates);if((this.toastrConfig.includeTitleDuplicates&&r||n)&&this.toastrConfig.preventDuplicates&&l!==null)return l;this.previousToastMessage=n;let d=!1;this.toastrConfig.maxOpened&&this.currentlyActive>=this.toastrConfig.maxOpened&&(d=!0,this.toastrConfig.autoDismiss&&this.clear(this.toasts[0].toastId));let p=this.overlay.create(o.positionClass,this.overlayContainer);this.index=this.index+1;let f=n;n&&o.enableHtml&&(f=this.sanitizer.sanitize(Wi.HTML,n));let b=new ai(p),v=new It(this.index,o,f,r,e,b),I=[{provide:It,useValue:v}],T=en.create({providers:I,parent:this._injector}),S=new ri(o.toastComponent,T),P=p.attach(S,o.newestOnTop);b.componentInstance=P.instance;let j={toastId:this.index,title:r||"",message:n||"",toastRef:b,onShown:b.afterActivate(),onHidden:b.afterClosed(),onTap:v.onTap(),onAction:v.onAction(),portal:P};return d||(this.currentlyActive=this.currentlyActive+1,setTimeout(()=>{j.toastRef.activate()})),this.toasts.push(j),j}static \u0275fac=function(n){return new(n||i)(q(wr),q(qs),q(en),q(lr),q(zt))};static \u0275prov=Y({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),Gs=(()=>{class i{toastrService;toastPackage;ngZone;message;title;options;duplicatesCount;originalTimeout;width=Lt(-1);toastClasses="";state;get _state(){return this.state()}get displayStyle(){if(this.state().value==="inactive")return"none"}timeout;intervalId;hideTime;sub;sub1;sub2;sub3;constructor(e,n,r){this.toastrService=e,this.toastPackage=n,this.ngZone=r,this.message=n.message,this.title=n.title,this.options=n.config,this.originalTimeout=n.config.timeOut,this.toastClasses=`${n.toastType} ${n.config.toastClass}`,this.sub=n.toastRef.afterActivate().subscribe(()=>{this.activateToast()}),this.sub1=n.toastRef.manualClosed().subscribe(()=>{this.remove()}),this.sub2=n.toastRef.timeoutReset().subscribe(()=>{this.resetTimeout()}),this.sub3=n.toastRef.countDuplicate().subscribe(o=>{this.duplicatesCount=o}),this.state=Lt({value:"inactive",params:{easeTime:this.toastPackage.config.easeTime,easing:"ease-in"}})}ngOnDestroy(){this.sub.unsubscribe(),this.sub1.unsubscribe(),this.sub2.unsubscribe(),this.sub3.unsubscribe(),clearInterval(this.intervalId),clearTimeout(this.timeout)}activateToast(){this.state.update(e=>fe(B({},e),{value:"active"})),!(this.options.disableTimeOut===!0||this.options.disableTimeOut==="timeOut")&&this.options.timeOut&&(this.outsideTimeout(()=>this.remove(),this.options.timeOut),this.hideTime=new Date().getTime()+this.options.timeOut,this.options.progressBar&&this.outsideInterval(()=>this.updateProgress(),10))}updateProgress(){if(this.width()===0||this.width()===100||!this.options.timeOut)return;let e=new Date().getTime(),n=this.hideTime-e;this.width.set(n/this.options.timeOut*100),this.options.progressAnimation==="increasing"&&this.width.update(r=>100-r),this.width()<=0&&this.width.set(0),this.width()>=100&&this.width.set(100)}resetTimeout(){clearTimeout(this.timeout),clearInterval(this.intervalId),this.state.update(e=>fe(B({},e),{value:"active"})),this.outsideTimeout(()=>this.remove(),this.originalTimeout),this.options.timeOut=this.originalTimeout,this.hideTime=new Date().getTime()+(this.options.timeOut||0),this.width.set(-1),this.options.progressBar&&this.outsideInterval(()=>this.updateProgress(),10)}remove(){this.state().value!=="removed"&&(clearTimeout(this.timeout),this.state.update(e=>fe(B({},e),{value:"removed"})),this.outsideTimeout(()=>this.toastrService.remove(this.toastPackage.toastId),+this.toastPackage.config.easeTime))}tapToast(){this.state().value!=="removed"&&(this.toastPackage.triggerTap(),this.options.tapToDismiss&&this.remove())}stickAround(){this.state().value!=="removed"&&this.options.disableTimeOut!=="extendedTimeOut"&&(clearTimeout(this.timeout),this.options.timeOut=0,this.hideTime=0,clearInterval(this.intervalId),this.width.set(0))}delayedHideToast(){this.options.disableTimeOut===!0||this.options.disableTimeOut==="extendedTimeOut"||this.options.extendedTimeOut===0||this.state().value==="removed"||(this.outsideTimeout(()=>this.remove(),this.options.extendedTimeOut),this.options.timeOut=this.options.extendedTimeOut,this.hideTime=new Date().getTime()+(this.options.timeOut||0),this.width.set(-1),this.options.progressBar&&this.outsideInterval(()=>this.updateProgress(),10))}outsideTimeout(e,n){this.ngZone?this.ngZone.runOutsideAngular(()=>this.timeout=setTimeout(()=>this.runInsideAngular(e),n)):this.timeout=setTimeout(()=>e(),n)}outsideInterval(e,n){this.ngZone?this.ngZone.runOutsideAngular(()=>this.intervalId=setInterval(()=>this.runInsideAngular(e),n)):this.intervalId=setInterval(()=>e(),n)}runInsideAngular(e){this.ngZone?this.ngZone.run(()=>e()):e()}static \u0275fac=function(n){return new(n||i)(y(Sr),y(It),y(zt))};static \u0275cmp=k({type:i,selectors:[["","toast-component",""]],hostVars:5,hostBindings:function(n,r){n&1&&_("click",function(){return r.tapToast()})("mouseenter",function(){return r.stickAround()})("mouseleave",function(){return r.delayedHideToast()}),n&2&&(Xi("@flyInOut",r._state),he(r.toastClasses),jt("display",r.displayStyle))},attrs:Cr,decls:5,vars:5,consts:[["type","button","class","toast-close-button","aria-label","Close",3,"click",4,"ngIf"],[3,"class",4,"ngIf"],["role","alert",3,"class","innerHTML",4,"ngIf"],["role","alert",3,"class",4,"ngIf"],[4,"ngIf"],["type","button","aria-label","Close",1,"toast-close-button",3,"click"],["aria-hidden","true"],["role","alert",3,"innerHTML"],["role","alert"],[1,"toast-progress"]],template:function(n,r){n&1&&h(0,Fs,3,0,"button",0)(1,Is,3,5,"div",1)(2,ks,1,3,"div",2)(3,Ds,2,4,"div",3)(4,Rs,2,2,"div",4),n&2&&(u("ngIf",r.options.closeButton),m(),u("ngIf",r.title),m(),u("ngIf",r.message&&r.options.enableHtml),m(),u("ngIf",r.message&&!r.options.enableHtml),m(),u("ngIf",r.options.progressBar))},dependencies:[K],encapsulation:2,data:{animation:[ii("flyInOut",[Ht("inactive",ot({opacity:0})),Ht("active",ot({opacity:1})),Ht("removed",ot({opacity:0})),An("inactive => active",Fn("{{ easeTime }}ms {{ easing }}")),An("active => removed",Fn("{{ easeTime }}ms {{ easing }}"))])]},changeDetection:0})}return i})(),Hs=fe(B({},xr),{toastComponent:Gs}),Er=(i={})=>Hi([{provide:wr,useValue:{default:Hs,config:i}}]);var Ks=(()=>{class i{toastrService;toastPackage;appRef;message;title;options;duplicatesCount;originalTimeout;width=Lt(-1);toastClasses="";get displayStyle(){return this.state()==="inactive"?"none":null}state=Lt("inactive");timeout;intervalId;hideTime;sub;sub1;sub2;sub3;constructor(e,n,r){this.toastrService=e,this.toastPackage=n,this.appRef=r,this.message=n.message,this.title=n.title,this.options=n.config,this.originalTimeout=n.config.timeOut,this.toastClasses=`${n.toastType} ${n.config.toastClass}`,this.sub=n.toastRef.afterActivate().subscribe(()=>{this.activateToast()}),this.sub1=n.toastRef.manualClosed().subscribe(()=>{this.remove()}),this.sub2=n.toastRef.timeoutReset().subscribe(()=>{this.resetTimeout()}),this.sub3=n.toastRef.countDuplicate().subscribe(o=>{this.duplicatesCount=o})}ngOnDestroy(){this.sub.unsubscribe(),this.sub1.unsubscribe(),this.sub2.unsubscribe(),this.sub3.unsubscribe(),clearInterval(this.intervalId),clearTimeout(this.timeout)}activateToast(){this.state.set("active"),!(this.options.disableTimeOut===!0||this.options.disableTimeOut==="timeOut")&&this.options.timeOut&&(this.timeout=setTimeout(()=>{this.remove()},this.options.timeOut),this.hideTime=new Date().getTime()+this.options.timeOut,this.options.progressBar&&(this.intervalId=setInterval(()=>this.updateProgress(),10))),this.options.onActivateTick&&this.appRef.tick()}updateProgress(){if(this.width()===0||this.width()===100||!this.options.timeOut)return;let e=new Date().getTime(),n=this.hideTime-e;this.width.set(n/this.options.timeOut*100),this.options.progressAnimation==="increasing"&&this.width.update(r=>100-r),this.width()<=0&&this.width.set(0),this.width()>=100&&this.width.set(100)}resetTimeout(){clearTimeout(this.timeout),clearInterval(this.intervalId),this.state.set("active"),this.options.timeOut=this.originalTimeout,this.timeout=setTimeout(()=>this.remove(),this.originalTimeout),this.hideTime=new Date().getTime()+(this.originalTimeout||0),this.width.set(-1),this.options.progressBar&&(this.intervalId=setInterval(()=>this.updateProgress(),10))}remove(){this.state()!=="removed"&&(clearTimeout(this.timeout),this.state.set("removed"),this.timeout=setTimeout(()=>this.toastrService.remove(this.toastPackage.toastId)))}tapToast(){this.state()!=="removed"&&(this.toastPackage.triggerTap(),this.options.tapToDismiss&&this.remove())}stickAround(){this.state()!=="removed"&&(clearTimeout(this.timeout),this.options.timeOut=0,this.hideTime=0,clearInterval(this.intervalId),this.width.set(0))}delayedHideToast(){this.options.disableTimeOut===!0||this.options.disableTimeOut==="extendedTimeOut"||this.options.extendedTimeOut===0||this.state()==="removed"||(this.timeout=setTimeout(()=>this.remove(),this.options.extendedTimeOut),this.options.timeOut=this.options.extendedTimeOut,this.hideTime=new Date().getTime()+(this.options.timeOut||0),this.width.set(-1),this.options.progressBar&&(this.intervalId=setInterval(()=>this.updateProgress(),10)))}static \u0275fac=function(n){return new(n||i)(y(Sr),y(It),y(nn))};static \u0275cmp=k({type:i,selectors:[["","toast-component",""]],hostVars:4,hostBindings:function(n,r){n&1&&_("click",function(){return r.tapToast()})("mouseenter",function(){return r.stickAround()})("mouseleave",function(){return r.delayedHideToast()}),n&2&&(he(r.toastClasses),jt("display",r.displayStyle))},attrs:Cr,decls:5,vars:5,consts:[["type","button","class","toast-close-button","aria-label","Close",3,"click",4,"ngIf"],[3,"class",4,"ngIf"],["role","alert",3,"class","innerHTML",4,"ngIf"],["role","alert",3,"class",4,"ngIf"],[4,"ngIf"],["type","button","aria-label","Close",1,"toast-close-button",3,"click"],["aria-hidden","true"],["role","alert",3,"innerHTML"],["role","alert"],[1,"toast-progress"]],template:function(n,r){n&1&&h(0,Us,3,0,"button",0)(1,zs,3,5,"div",1)(2,Ls,1,3,"div",2)(3,Vs,2,4,"div",3)(4,Bs,2,2,"div",4),n&2&&(u("ngIf",r.options.closeButton),m(),u("ngIf",r.title),m(),u("ngIf",r.message&&r.options.enableHtml),m(),u("ngIf",r.message&&!r.options.enableHtml),m(),u("ngIf",r.options.progressBar))},dependencies:[K],encapsulation:2,changeDetection:0})}return i})(),Om=fe(B({},xr),{toastComponent:Ks});function Mr(i){return new z(3e3,!1)}function $s(){return new z(3100,!1)}function Qs(){return new z(3101,!1)}function Ws(i){return new z(3001,!1)}function Ys(i){return new z(3003,!1)}function Zs(i){return new z(3004,!1)}function Or(i,t){return new z(3005,!1)}function Tr(){return new z(3006,!1)}function Fr(){return new z(3007,!1)}function Ar(i,t){return new z(3008,!1)}function Ir(i){return new z(3002,!1)}function kr(i,t,e,n,r){return new z(3010,!1)}function Dr(){return new z(3011,!1)}function Rr(){return new z(3012,!1)}function Ur(){return new z(3200,!1)}function Nr(){return new z(3202,!1)}function zr(){return new z(3013,!1)}function Lr(i){return new z(3014,!1)}function Vr(i){return new z(3015,!1)}function Br(i){return new z(3016,!1)}function jr(i,t){return new z(3404,!1)}function Xs(i){return new z(3502,!1)}function qr(i){return new z(3503,!1)}function Gr(){return new z(3300,!1)}function Hr(i){return new z(3504,!1)}function Kr(i){return new z(3301,!1)}function $r(i,t){return new z(3302,!1)}function Qr(i){return new z(3303,!1)}function Wr(i,t){return new z(3400,!1)}function Yr(i){return new z(3401,!1)}function Zr(i){return new z(3402,!1)}function Xr(i,t){return new z(3505,!1)}function Ze(i){switch(i.length){case 0:return new Qe;case 1:return i[0];default:return new mt(i)}}function ui(i,t,e=new Map,n=new Map){let r=[],o=[],l=-1,d=null;if(t.forEach(p=>{let f=p.get("offset"),b=f==l,v=b&&d||new Map;p.forEach((I,T)=>{let S=T,P=I;if(T!=="offset")switch(S=i.normalizePropertyName(S,r),P){case At:P=e.get(T);break;case Ie:P=n.get(T);break;default:P=i.normalizeStyleValue(T,S,P,r);break}v.set(S,P)}),b||o.push(v),d=v,l=f}),r.length)throw Xs(r);return o}function In(i,t,e,n){switch(t){case"start":i.onStart(()=>n(e&&ci(e,"start",i)));break;case"done":i.onDone(()=>n(e&&ci(e,"done",i)));break;case"destroy":i.onDestroy(()=>n(e&&ci(e,"destroy",i)));break}}function ci(i,t,e){let n=e.totalTime,r=!!e.disabled,o=kn(i.element,i.triggerName,i.fromState,i.toState,t||i.phaseName,n??i.totalTime,r),l=i._data;return l!=null&&(o._data=l),o}function kn(i,t,e,n,r="",o=0,l){return{element:i,triggerName:t,fromState:e,toState:n,phaseName:r,totalTime:o,disabled:!!l}}function Se(i,t,e){let n=i.get(t);return n||i.set(t,n=e),n}function pi(i){let t=i.indexOf(":"),e=i.substring(1,t),n=i.slice(t+1);return[e,n]}var Js=typeof document>"u"?null:document.documentElement;function Dn(i){let t=i.parentNode||i.host||null;return t===Js?null:t}function el(i){return i.substring(1,6)=="ebkit"}var ut=null,Pr=!1;function Jr(i){ut||(ut=tl()||{},Pr=ut.style?"WebkitAppearance"in ut.style:!1);let t=!0;return ut.style&&!el(i)&&(t=i in ut.style,!t&&Pr&&(t="Webkit"+i.charAt(0).toUpperCase()+i.slice(1)in ut.style)),t}function tl(){return typeof document<"u"?document.body:null}function fi(i,t){for(;t;){if(t===i)return!0;t=Dn(t)}return!1}function gi(i,t,e){if(e)return Array.from(i.querySelectorAll(t));let n=i.querySelector(t);return n?[n]:[]}var nl=1e3,hi="{{",il="}}",_i="ng-enter",Rn="ng-leave",Kt="ng-trigger",$t=".ng-trigger",bi="ng-animating",Un=".ng-animating";function We(i){if(typeof i=="number")return i;let t=i.match(/^(-?[\.\d]+)(m?s)/);return!t||t.length<2?0:di(parseFloat(t[1]),t[2])}function di(i,t){switch(t){case"s":return i*nl;default:return i}}function Qt(i,t,e){return i.hasOwnProperty("duration")?i:rl(i,t,e)}function rl(i,t,e){let n=/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i,r,o=0,l="";if(typeof i=="string"){let d=i.match(n);if(d===null)return t.push(Mr(i)),{duration:0,delay:0,easing:""};r=di(parseFloat(d[1]),d[2]);let p=d[3];p!=null&&(o=di(parseFloat(p),d[4]));let f=d[5];f&&(l=f)}else r=i;if(!e){let d=!1,p=t.length;r<0&&(t.push($s()),d=!0),o<0&&(t.push(Qs()),d=!0),d&&t.splice(p,0,Mr(i))}return{duration:r,delay:o,easing:l}}function eo(i){return i.length?i[0]instanceof Map?i:i.map(t=>new Map(Object.entries(t))):[]}function Re(i,t,e){t.forEach((n,r)=>{let o=Nn(r);e&&!e.has(r)&&e.set(r,i.style[o]),i.style[o]=n})}function at(i,t){t.forEach((e,n)=>{let r=Nn(n);i.style[r]=""})}function kt(i){return Array.isArray(i)?i.length==1?i[0]:yr(i):i}function to(i,t,e){let n=t.params||{},r=vi(i);r.length&&r.forEach(o=>{n.hasOwnProperty(o)||e.push(Ws(o))})}var mi=new RegExp(`${hi}\\s*(.+?)\\s*${il}`,"g");function vi(i){let t=[];if(typeof i=="string"){let e;for(;e=mi.exec(i);)t.push(e[1]);mi.lastIndex=0}return t}function Dt(i,t,e){let n=`${i}`,r=n.replace(mi,(o,l)=>{let d=t[l];return d==null&&(e.push(Ys(l)),d=""),d.toString()});return r==n?i:r}var ol=/-+([a-z0-9])/g;function Nn(i){return i.replace(ol,(...t)=>t[1].toUpperCase())}function no(i,t){return i===0||t===0}function io(i,t,e){if(e.size&&t.length){let n=t[0],r=[];if(e.forEach((o,l)=>{n.has(l)||r.push(l),n.set(l,o)}),r.length)for(let o=1;o<t.length;o++){let l=t[o];r.forEach(d=>l.set(d,zn(i,d)))}}return t}function Ee(i,t,e){switch(t.type){case F.Trigger:return i.visitTrigger(t,e);case F.State:return i.visitState(t,e);case F.Transition:return i.visitTransition(t,e);case F.Sequence:return i.visitSequence(t,e);case F.Group:return i.visitGroup(t,e);case F.Animate:return i.visitAnimate(t,e);case F.Keyframes:return i.visitKeyframes(t,e);case F.Style:return i.visitStyle(t,e);case F.Reference:return i.visitReference(t,e);case F.AnimateChild:return i.visitAnimateChild(t,e);case F.AnimateRef:return i.visitAnimateRef(t,e);case F.Query:return i.visitQuery(t,e);case F.Stagger:return i.visitStagger(t,e);default:throw Zs(t.type)}}function zn(i,t){return window.getComputedStyle(i)[t]}var Ui=(()=>{class i{validateStyleProperty(e){return Jr(e)}containsElement(e,n){return fi(e,n)}getParentElement(e){return Dn(e)}query(e,n,r){return gi(e,n,r)}computeStyle(e,n,r){return r||""}animate(e,n,r,o,l,d=[],p){return new Qe(r,o)}static \u0275fac=function(n){return new(n||i)};static \u0275prov=Y({token:i,factory:i.\u0275fac})}return i})(),ft=class{static NOOP=new Ui},gt=class{};var al=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]),qn=class extends gt{normalizePropertyName(t,e){return Nn(t)}normalizeStyleValue(t,e,n,r){let o="",l=n.toString().trim();if(al.has(e)&&n!==0&&n!=="0")if(typeof n=="number")o="px";else{let d=n.match(/^[+-]?[\d\.]+([a-z]*)$/);d&&d[1].length==0&&r.push(Or(t,n))}return l+o}};var Gn="*";function sl(i,t){let e=[];return typeof i=="string"?i.split(/\s*,\s*/).forEach(n=>ll(n,e,t)):e.push(i),e}function ll(i,t,e){if(i[0]==":"){let p=cl(i,e);if(typeof p=="function"){t.push(p);return}i=p}let n=i.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(n==null||n.length<4)return e.push(Vr(i)),t;let r=n[1],o=n[2],l=n[3];t.push(ro(r,l));let d=r==Gn&&l==Gn;o[0]=="<"&&!d&&t.push(ro(l,r))}function cl(i,t){switch(i){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(e,n)=>parseFloat(n)>parseFloat(e);case":decrement":return(e,n)=>parseFloat(n)<parseFloat(e);default:return t.push(Br(i)),"* => *"}}var Ln=new Set(["true","1"]),Vn=new Set(["false","0"]);function ro(i,t){let e=Ln.has(i)||Vn.has(i),n=Ln.has(t)||Vn.has(t);return(r,o)=>{let l=i==Gn||i==r,d=t==Gn||t==o;return!l&&e&&typeof r=="boolean"&&(l=r?Ln.has(i):Vn.has(i)),!d&&n&&typeof o=="boolean"&&(d=o?Ln.has(t):Vn.has(t)),l&&d}}var go=":self",dl=new RegExp(`s*${go}s*,?`,"g");function ho(i,t,e,n){return new Ei(i).build(t,e,n)}var oo="",Ei=class{_driver;constructor(t){this._driver=t}build(t,e,n){let r=new Mi(e);return this._resetContextStyleTimingState(r),Ee(this,kt(t),r)}_resetContextStyleTimingState(t){t.currentQuerySelector=oo,t.collectedStyles=new Map,t.collectedStyles.set(oo,new Map),t.currentTime=0}visitTrigger(t,e){let n=e.queryCount=0,r=e.depCount=0,o=[],l=[];return t.name.charAt(0)=="@"&&e.errors.push(Tr()),t.definitions.forEach(d=>{if(this._resetContextStyleTimingState(e),d.type==F.State){let p=d,f=p.name;f.toString().split(/\s*,\s*/).forEach(b=>{p.name=b,o.push(this.visitState(p,e))}),p.name=f}else if(d.type==F.Transition){let p=this.visitTransition(d,e);n+=p.queryCount,r+=p.depCount,l.push(p)}else e.errors.push(Fr())}),{type:F.Trigger,name:t.name,states:o,transitions:l,queryCount:n,depCount:r,options:null}}visitState(t,e){let n=this.visitStyle(t.styles,e),r=t.options&&t.options.params||null;if(n.containsDynamicStyles){let o=new Set,l=r||{};n.styles.forEach(d=>{d instanceof Map&&d.forEach(p=>{vi(p).forEach(f=>{l.hasOwnProperty(f)||o.add(f)})})}),o.size&&e.errors.push(Ar(t.name,[...o.values()]))}return{type:F.State,name:t.name,style:n,options:r?{params:r}:null}}visitTransition(t,e){e.queryCount=0,e.depCount=0;let n=Ee(this,kt(t.animation),e),r=sl(t.expr,e.errors);return{type:F.Transition,matchers:r,animation:n,queryCount:e.queryCount,depCount:e.depCount,options:pt(t.options)}}visitSequence(t,e){return{type:F.Sequence,steps:t.steps.map(n=>Ee(this,n,e)),options:pt(t.options)}}visitGroup(t,e){let n=e.currentTime,r=0,o=t.steps.map(l=>{e.currentTime=n;let d=Ee(this,l,e);return r=Math.max(r,e.currentTime),d});return e.currentTime=r,{type:F.Group,steps:o,options:pt(t.options)}}visitAnimate(t,e){let n=fl(t.timings,e.errors);e.currentAnimateTimings=n;let r,o=t.styles?t.styles:ot({});if(o.type==F.Keyframes)r=this.visitKeyframes(o,e);else{let l=t.styles,d=!1;if(!l){d=!0;let f={};n.easing&&(f.easing=n.easing),l=ot(f)}e.currentTime+=n.duration+n.delay;let p=this.visitStyle(l,e);p.isEmptyStep=d,r=p}return e.currentAnimateTimings=null,{type:F.Animate,timings:n,style:r,options:null}}visitStyle(t,e){let n=this._makeStyleAst(t,e);return this._validateStyleAst(n,e),n}_makeStyleAst(t,e){let n=[],r=Array.isArray(t.styles)?t.styles:[t.styles];for(let d of r)typeof d=="string"?d===Ie?n.push(d):e.errors.push(Ir(d)):n.push(new Map(Object.entries(d)));let o=!1,l=null;return n.forEach(d=>{if(d instanceof Map&&(d.has("easing")&&(l=d.get("easing"),d.delete("easing")),!o)){for(let p of d.values())if(p.toString().indexOf(hi)>=0){o=!0;break}}}),{type:F.Style,styles:n,easing:l,offset:t.offset,containsDynamicStyles:o,options:null}}_validateStyleAst(t,e){let n=e.currentAnimateTimings,r=e.currentTime,o=e.currentTime;n&&o>0&&(o-=n.duration+n.delay),t.styles.forEach(l=>{typeof l!="string"&&l.forEach((d,p)=>{let f=e.collectedStyles.get(e.currentQuerySelector),b=f.get(p),v=!0;b&&(o!=r&&o>=b.startTime&&r<=b.endTime&&(e.errors.push(kr(p,b.startTime,b.endTime,o,r)),v=!1),o=b.startTime),v&&f.set(p,{startTime:o,endTime:r}),e.options&&to(d,e.options,e.errors)})})}visitKeyframes(t,e){let n={type:F.Keyframes,styles:[],options:null};if(!e.currentAnimateTimings)return e.errors.push(Dr()),n;let r=1,o=0,l=[],d=!1,p=!1,f=0,b=t.steps.map(Z=>{let ee=this._makeStyleAst(Z,e),ue=ee.offset!=null?ee.offset:pl(ee.styles),ie=0;return ue!=null&&(o++,ie=ee.offset=ue),p=p||ie<0||ie>1,d=d||ie<f,f=ie,l.push(ie),ee});p&&e.errors.push(Rr()),d&&e.errors.push(Ur());let v=t.steps.length,I=0;o>0&&o<v?e.errors.push(Nr()):o==0&&(I=r/(v-1));let T=v-1,S=e.currentTime,P=e.currentAnimateTimings,j=P.duration;return b.forEach((Z,ee)=>{let ue=I>0?ee==T?1:I*ee:l[ee],ie=ue*j;e.currentTime=S+P.delay+ie,P.duration=ie,this._validateStyleAst(Z,e),Z.offset=ue,n.styles.push(Z)}),n}visitReference(t,e){return{type:F.Reference,animation:Ee(this,kt(t.animation),e),options:pt(t.options)}}visitAnimateChild(t,e){return e.depCount++,{type:F.AnimateChild,options:pt(t.options)}}visitAnimateRef(t,e){return{type:F.AnimateRef,animation:this.visitReference(t.animation,e),options:pt(t.options)}}visitQuery(t,e){let n=e.currentQuerySelector,r=t.options||{};e.queryCount++,e.currentQuery=t;let[o,l]=ml(t.selector);e.currentQuerySelector=n.length?n+" "+o:o,Se(e.collectedStyles,e.currentQuerySelector,new Map);let d=Ee(this,kt(t.animation),e);return e.currentQuery=null,e.currentQuerySelector=n,{type:F.Query,selector:o,limit:r.limit||0,optional:!!r.optional,includeSelf:l,animation:d,originalSelector:t.selector,options:pt(t.options)}}visitStagger(t,e){e.currentQuery||e.errors.push(zr());let n=t.timings==="full"?{duration:0,delay:0,easing:"full"}:Qt(t.timings,e.errors,!0);return{type:F.Stagger,animation:Ee(this,kt(t.animation),e),timings:n,options:null}}};function ml(i){let t=!!i.split(/\s*,\s*/).find(e=>e==go);return t&&(i=i.replace(dl,"")),i=i.replace(/@\*/g,$t).replace(/@\w+/g,e=>$t+"-"+e.slice(1)).replace(/:animating/g,Un),[i,t]}function ul(i){return i?B({},i):null}var Mi=class{errors;queryCount=0;depCount=0;currentTransition=null;currentQuery=null;currentQuerySelector=null;currentAnimateTimings=null;currentTime=0;collectedStyles=new Map;options=null;unsupportedCSSPropertiesFound=new Set;constructor(t){this.errors=t}};function pl(i){if(typeof i=="string")return null;let t=null;if(Array.isArray(i))i.forEach(e=>{if(e instanceof Map&&e.has("offset")){let n=e;t=parseFloat(n.get("offset")),n.delete("offset")}});else if(i instanceof Map&&i.has("offset")){let e=i;t=parseFloat(e.get("offset")),e.delete("offset")}return t}function fl(i,t){if(i.hasOwnProperty("duration"))return i;if(typeof i=="number"){let o=Qt(i,t).duration;return yi(o,0,"")}let e=i;if(e.split(/\s+/).some(o=>o.charAt(0)=="{"&&o.charAt(1)=="{")){let o=yi(0,0,"");return o.dynamic=!0,o.strValue=e,o}let r=Qt(e,t);return yi(r.duration,r.delay,r.easing)}function pt(i){return i?(i=B({},i),i.params&&(i.params=ul(i.params))):i={},i}function yi(i,t,e){return{duration:i,delay:t,easing:e}}function Ni(i,t,e,n,r,o,l=null,d=!1){return{type:1,element:i,keyframes:t,preStyleProps:e,postStyleProps:n,duration:r,delay:o,totalTime:r+o,easing:l,subTimeline:d}}var Yt=class{_map=new Map;get(t){return this._map.get(t)||[]}append(t,e){let n=this._map.get(t);n||this._map.set(t,n=[]),n.push(...e)}has(t){return this._map.has(t)}clear(){this._map.clear()}},gl=1,hl=":enter",_l=new RegExp(hl,"g"),bl=":leave",vl=new RegExp(bl,"g");function _o(i,t,e,n,r,o=new Map,l=new Map,d,p,f=[]){return new Pi().buildKeyframes(i,t,e,n,r,o,l,d,p,f)}var Pi=class{buildKeyframes(t,e,n,r,o,l,d,p,f,b=[]){f=f||new Yt;let v=new Oi(t,e,f,r,o,b,[]);v.options=p;let I=p.delay?We(p.delay):0;v.currentTimeline.delayNextStep(I),v.currentTimeline.setStyles([l],null,v.errors,p),Ee(this,n,v);let T=v.timelines.filter(S=>S.containsAnimation());if(T.length&&d.size){let S;for(let P=T.length-1;P>=0;P--){let j=T[P];if(j.element===e){S=j;break}}S&&!S.allowOnlyTimelineStyles()&&S.setStyles([d],null,v.errors,p)}return T.length?T.map(S=>S.buildKeyframes()):[Ni(e,[],[],[],0,I,"",!1)]}visitTrigger(t,e){}visitState(t,e){}visitTransition(t,e){}visitAnimateChild(t,e){let n=e.subInstructions.get(e.element);if(n){let r=e.createSubContext(t.options),o=e.currentTimeline.currentTime,l=this._visitSubInstructions(n,r,r.options);o!=l&&e.transformIntoNewTimeline(l)}e.previousNode=t}visitAnimateRef(t,e){let n=e.createSubContext(t.options);n.transformIntoNewTimeline(),this._applyAnimationRefDelays([t.options,t.animation.options],e,n),this.visitReference(t.animation,n),e.transformIntoNewTimeline(n.currentTimeline.currentTime),e.previousNode=t}_applyAnimationRefDelays(t,e,n){for(let r of t){let o=r?.delay;if(o){let l=typeof o=="number"?o:We(Dt(o,r?.params??{},e.errors));n.delayNextStep(l)}}}_visitSubInstructions(t,e,n){let o=e.currentTimeline.currentTime,l=n.duration!=null?We(n.duration):null,d=n.delay!=null?We(n.delay):null;return l!==0&&t.forEach(p=>{let f=e.appendInstructionToTimeline(p,l,d);o=Math.max(o,f.duration+f.delay)}),o}visitReference(t,e){e.updateOptions(t.options,!0),Ee(this,t.animation,e),e.previousNode=t}visitSequence(t,e){let n=e.subContextCount,r=e,o=t.options;if(o&&(o.params||o.delay)&&(r=e.createSubContext(o),r.transformIntoNewTimeline(),o.delay!=null)){r.previousNode.type==F.Style&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=Hn);let l=We(o.delay);r.delayNextStep(l)}t.steps.length&&(t.steps.forEach(l=>Ee(this,l,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>n&&r.transformIntoNewTimeline()),e.previousNode=t}visitGroup(t,e){let n=[],r=e.currentTimeline.currentTime,o=t.options&&t.options.delay?We(t.options.delay):0;t.steps.forEach(l=>{let d=e.createSubContext(t.options);o&&d.delayNextStep(o),Ee(this,l,d),r=Math.max(r,d.currentTimeline.currentTime),n.push(d.currentTimeline)}),n.forEach(l=>e.currentTimeline.mergeTimelineCollectedStyles(l)),e.transformIntoNewTimeline(r),e.previousNode=t}_visitTiming(t,e){if(t.dynamic){let n=t.strValue,r=e.params?Dt(n,e.params,e.errors):n;return Qt(r,e.errors)}else return{duration:t.duration,delay:t.delay,easing:t.easing}}visitAnimate(t,e){let n=e.currentAnimateTimings=this._visitTiming(t.timings,e),r=e.currentTimeline;n.delay&&(e.incrementTime(n.delay),r.snapshotCurrentStyles());let o=t.style;o.type==F.Keyframes?this.visitKeyframes(o,e):(e.incrementTime(n.duration),this.visitStyle(o,e),r.applyStylesToKeyframe()),e.currentAnimateTimings=null,e.previousNode=t}visitStyle(t,e){let n=e.currentTimeline,r=e.currentAnimateTimings;!r&&n.hasCurrentStyleProperties()&&n.forwardFrame();let o=r&&r.easing||t.easing;t.isEmptyStep?n.applyEmptyStep(o):n.setStyles(t.styles,o,e.errors,e.options),e.previousNode=t}visitKeyframes(t,e){let n=e.currentAnimateTimings,r=e.currentTimeline.duration,o=n.duration,d=e.createSubContext().currentTimeline;d.easing=n.easing,t.styles.forEach(p=>{let f=p.offset||0;d.forwardTime(f*o),d.setStyles(p.styles,p.easing,e.errors,e.options),d.applyStylesToKeyframe()}),e.currentTimeline.mergeTimelineCollectedStyles(d),e.transformIntoNewTimeline(r+o),e.previousNode=t}visitQuery(t,e){let n=e.currentTimeline.currentTime,r=t.options||{},o=r.delay?We(r.delay):0;o&&(e.previousNode.type===F.Style||n==0&&e.currentTimeline.hasCurrentStyleProperties())&&(e.currentTimeline.snapshotCurrentStyles(),e.previousNode=Hn);let l=n,d=e.invokeQuery(t.selector,t.originalSelector,t.limit,t.includeSelf,!!r.optional,e.errors);e.currentQueryTotal=d.length;let p=null;d.forEach((f,b)=>{e.currentQueryIndex=b;let v=e.createSubContext(t.options,f);o&&v.delayNextStep(o),f===e.element&&(p=v.currentTimeline),Ee(this,t.animation,v),v.currentTimeline.applyStylesToKeyframe();let I=v.currentTimeline.currentTime;l=Math.max(l,I)}),e.currentQueryIndex=0,e.currentQueryTotal=0,e.transformIntoNewTimeline(l),p&&(e.currentTimeline.mergeTimelineCollectedStyles(p),e.currentTimeline.snapshotCurrentStyles()),e.previousNode=t}visitStagger(t,e){let n=e.parentContext,r=e.currentTimeline,o=t.timings,l=Math.abs(o.duration),d=l*(e.currentQueryTotal-1),p=l*e.currentQueryIndex;switch(o.duration<0?"reverse":o.easing){case"reverse":p=d-p;break;case"full":p=n.currentStaggerTime;break}let b=e.currentTimeline;p&&b.delayNextStep(p);let v=b.currentTime;Ee(this,t.animation,e),e.previousNode=t,n.currentStaggerTime=r.currentTime-v+(r.startTime-n.currentTimeline.startTime)}},Hn={},Oi=class i{_driver;element;subInstructions;_enterClassName;_leaveClassName;errors;timelines;parentContext=null;currentTimeline;currentAnimateTimings=null;previousNode=Hn;subContextCount=0;options={};currentQueryIndex=0;currentQueryTotal=0;currentStaggerTime=0;constructor(t,e,n,r,o,l,d,p){this._driver=t,this.element=e,this.subInstructions=n,this._enterClassName=r,this._leaveClassName=o,this.errors=l,this.timelines=d,this.currentTimeline=p||new Kn(this._driver,e,0),d.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(t,e){if(!t)return;let n=t,r=this.options;n.duration!=null&&(r.duration=We(n.duration)),n.delay!=null&&(r.delay=We(n.delay));let o=n.params;if(o){let l=r.params;l||(l=this.options.params={}),Object.keys(o).forEach(d=>{(!e||!l.hasOwnProperty(d))&&(l[d]=Dt(o[d],l,this.errors))})}}_copyOptions(){let t={};if(this.options){let e=this.options.params;if(e){let n=t.params={};Object.keys(e).forEach(r=>{n[r]=e[r]})}}return t}createSubContext(t=null,e,n){let r=e||this.element,o=new i(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,n||0));return o.previousNode=this.previousNode,o.currentAnimateTimings=this.currentAnimateTimings,o.options=this._copyOptions(),o.updateOptions(t),o.currentQueryIndex=this.currentQueryIndex,o.currentQueryTotal=this.currentQueryTotal,o.parentContext=this,this.subContextCount++,o}transformIntoNewTimeline(t){return this.previousNode=Hn,this.currentTimeline=this.currentTimeline.fork(this.element,t),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(t,e,n){let r={duration:e??t.duration,delay:this.currentTimeline.currentTime+(n??0)+t.delay,easing:""},o=new Ti(this._driver,t.element,t.keyframes,t.preStyleProps,t.postStyleProps,r,t.stretchStartingKeyframe);return this.timelines.push(o),r}incrementTime(t){this.currentTimeline.forwardTime(this.currentTimeline.duration+t)}delayNextStep(t){t>0&&this.currentTimeline.delayNextStep(t)}invokeQuery(t,e,n,r,o,l){let d=[];if(r&&d.push(this.element),t.length>0){t=t.replace(_l,"."+this._enterClassName),t=t.replace(vl,"."+this._leaveClassName);let p=n!=1,f=this._driver.query(this.element,t,p);n!==0&&(f=n<0?f.slice(f.length+n,f.length):f.slice(0,n)),d.push(...f)}return!o&&d.length==0&&l.push(Lr(e)),d}},Kn=class i{_driver;element;startTime;_elementTimelineStylesLookup;duration=0;easing=null;_previousKeyframe=new Map;_currentKeyframe=new Map;_keyframes=new Map;_styleSummary=new Map;_localTimelineStyles=new Map;_globalTimelineStyles;_pendingStyles=new Map;_backFill=new Map;_currentEmptyStepKeyframe=null;constructor(t,e,n,r){this._driver=t,this.element=e,this.startTime=n,this._elementTimelineStylesLookup=r,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(e),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(e,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(t){let e=this._keyframes.size===1&&this._pendingStyles.size;this.duration||e?(this.forwardTime(this.currentTime+t),e&&this.snapshotCurrentStyles()):this.startTime+=t}fork(t,e){return this.applyStylesToKeyframe(),new i(this._driver,t,e||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=gl,this._loadKeyframe()}forwardTime(t){this.applyStylesToKeyframe(),this.duration=t,this._loadKeyframe()}_updateStyle(t,e){this._localTimelineStyles.set(t,e),this._globalTimelineStyles.set(t,e),this._styleSummary.set(t,{time:this.currentTime,value:e})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(t){t&&this._previousKeyframe.set("easing",t);for(let[e,n]of this._globalTimelineStyles)this._backFill.set(e,n||Ie),this._currentKeyframe.set(e,Ie);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(t,e,n,r){e&&this._previousKeyframe.set("easing",e);let o=r&&r.params||{},l=yl(t,this._globalTimelineStyles);for(let[d,p]of l){let f=Dt(p,o,n);this._pendingStyles.set(d,f),this._localTimelineStyles.has(d)||this._backFill.set(d,this._globalTimelineStyles.get(d)??Ie),this._updateStyle(d,f)}}applyStylesToKeyframe(){this._pendingStyles.size!=0&&(this._pendingStyles.forEach((t,e)=>{this._currentKeyframe.set(e,t)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((t,e)=>{this._currentKeyframe.has(e)||this._currentKeyframe.set(e,t)}))}snapshotCurrentStyles(){for(let[t,e]of this._localTimelineStyles)this._pendingStyles.set(t,e),this._updateStyle(t,e)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){let t=[];for(let e in this._currentKeyframe)t.push(e);return t}mergeTimelineCollectedStyles(t){t._styleSummary.forEach((e,n)=>{let r=this._styleSummary.get(n);(!r||e.time>r.time)&&this._updateStyle(n,e.value)})}buildKeyframes(){this.applyStylesToKeyframe();let t=new Set,e=new Set,n=this._keyframes.size===1&&this.duration===0,r=[];this._keyframes.forEach((d,p)=>{let f=new Map([...this._backFill,...d]);f.forEach((b,v)=>{b===At?t.add(v):b===Ie&&e.add(v)}),n||f.set("offset",p/this.duration),r.push(f)});let o=[...t.values()],l=[...e.values()];if(n){let d=r[0],p=new Map(d);d.set("offset",0),p.set("offset",1),r=[d,p]}return Ni(this.element,r,o,l,this.duration,this.startTime,this.easing,!1)}},Ti=class extends Kn{keyframes;preStyleProps;postStyleProps;_stretchStartingKeyframe;timings;constructor(t,e,n,r,o,l,d=!1){super(t,e,l.delay),this.keyframes=n,this.preStyleProps=r,this.postStyleProps=o,this._stretchStartingKeyframe=d,this.timings={duration:l.duration,delay:l.delay,easing:l.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let t=this.keyframes,{delay:e,duration:n,easing:r}=this.timings;if(this._stretchStartingKeyframe&&e){let o=[],l=n+e,d=e/l,p=new Map(t[0]);p.set("offset",0),o.push(p);let f=new Map(t[0]);f.set("offset",ao(d)),o.push(f);let b=t.length-1;for(let v=1;v<=b;v++){let I=new Map(t[v]),T=I.get("offset"),S=e+T*n;I.set("offset",ao(S/l)),o.push(I)}n=l,e=0,r="",t=o}return Ni(this.element,t,this.preStyleProps,this.postStyleProps,n,e,r,!0)}};function ao(i,t=3){let e=Math.pow(10,t-1);return Math.round(i*e)/e}function yl(i,t){let e=new Map,n;return i.forEach(r=>{if(r==="*"){n??=t.keys();for(let o of n)e.set(o,Ie)}else for(let[o,l]of r)e.set(o,l)}),e}function so(i,t,e,n,r,o,l,d,p,f,b,v,I){return{type:0,element:i,triggerName:t,isRemovalTransition:r,fromState:e,fromStyles:o,toState:n,toStyles:l,timelines:d,queriedElements:p,preStyleProps:f,postStyleProps:b,totalTime:v,errors:I}}var Ci={},$n=class{_triggerName;ast;_stateStyles;constructor(t,e,n){this._triggerName=t,this.ast=e,this._stateStyles=n}match(t,e,n,r){return Cl(this.ast.matchers,t,e,n,r)}buildStyles(t,e,n){let r=this._stateStyles.get("*");return t!==void 0&&(r=this._stateStyles.get(t?.toString())||r),r?r.buildStyles(e,n):new Map}build(t,e,n,r,o,l,d,p,f,b){let v=[],I=this.ast.options&&this.ast.options.params||Ci,T=d&&d.params||Ci,S=this.buildStyles(n,T,v),P=p&&p.params||Ci,j=this.buildStyles(r,P,v),Z=new Set,ee=new Map,ue=new Map,ie=r==="void",ht={params:bo(P,I),delay:this.ast.options?.delay},Ne=b?[]:_o(t,e,this.ast.animation,o,l,S,j,ht,f,v),pe=0;return Ne.forEach(be=>{pe=Math.max(be.duration+be.delay,pe)}),v.length?so(e,this._triggerName,n,r,ie,S,j,[],[],ee,ue,pe,v):(Ne.forEach(be=>{let st=be.element,_t=Se(ee,st,new Set);be.preStyleProps.forEach(lt=>_t.add(lt));let zi=Se(ue,st,new Set);be.postStyleProps.forEach(lt=>zi.add(lt)),st!==e&&Z.add(st)}),so(e,this._triggerName,n,r,ie,S,j,Ne,[...Z.values()],ee,ue,pe))}};function Cl(i,t,e,n,r){return i.some(o=>o(t,e,n,r))}function bo(i,t){let e=B({},t);return Object.entries(i).forEach(([n,r])=>{r!=null&&(e[n]=r)}),e}var Fi=class{styles;defaultParams;normalizer;constructor(t,e,n){this.styles=t,this.defaultParams=e,this.normalizer=n}buildStyles(t,e){let n=new Map,r=bo(t,this.defaultParams);return this.styles.styles.forEach(o=>{typeof o!="string"&&o.forEach((l,d)=>{l&&(l=Dt(l,r,e));let p=this.normalizer.normalizePropertyName(d,e);l=this.normalizer.normalizeStyleValue(d,p,l,e),n.set(d,l)})}),n}};function xl(i,t,e){return new Ai(i,t,e)}var Ai=class{name;ast;_normalizer;transitionFactories=[];fallbackTransition;states=new Map;constructor(t,e,n){this.name=t,this.ast=e,this._normalizer=n,e.states.forEach(r=>{let o=r.options&&r.options.params||{};this.states.set(r.name,new Fi(r.style,o,n))}),lo(this.states,"true","1"),lo(this.states,"false","0"),e.transitions.forEach(r=>{this.transitionFactories.push(new $n(t,r,this.states))}),this.fallbackTransition=wl(t,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(t,e,n,r){return this.transitionFactories.find(l=>l.match(t,e,n,r))||null}matchStyles(t,e,n){return this.fallbackTransition.buildStyles(t,e,n)}};function wl(i,t,e){let n=[(l,d)=>!0],r={type:F.Sequence,steps:[],options:null},o={type:F.Transition,animation:r,matchers:n,options:null,queryCount:0,depCount:0};return new $n(i,o,t)}function lo(i,t,e){i.has(t)?i.has(e)||i.set(e,i.get(t)):i.has(e)&&i.set(t,i.get(e))}var Sl=new Yt,Ii=class{bodyNode;_driver;_normalizer;_animations=new Map;_playersById=new Map;players=[];constructor(t,e,n){this.bodyNode=t,this._driver=e,this._normalizer=n}register(t,e){let n=[],r=[],o=ho(this._driver,e,n,r);if(n.length)throw qr(n);this._animations.set(t,o)}_buildPlayer(t,e,n){let r=t.element,o=ui(this._normalizer,t.keyframes,e,n);return this._driver.animate(r,o,t.duration,t.delay,t.easing,[],!0)}create(t,e,n={}){let r=[],o=this._animations.get(t),l,d=new Map;if(o?(l=_o(this._driver,e,o,_i,Rn,new Map,new Map,n,Sl,r),l.forEach(b=>{let v=Se(d,b.element,new Map);b.postStyleProps.forEach(I=>v.set(I,null))})):(r.push(Gr()),l=[]),r.length)throw Hr(r);d.forEach((b,v)=>{b.forEach((I,T)=>{b.set(T,this._driver.computeStyle(v,T,Ie))})});let p=l.map(b=>{let v=d.get(b.element);return this._buildPlayer(b,new Map,v)}),f=Ze(p);return this._playersById.set(t,f),f.onDestroy(()=>this.destroy(t)),this.players.push(f),f}destroy(t){let e=this._getPlayer(t);e.destroy(),this._playersById.delete(t);let n=this.players.indexOf(e);n>=0&&this.players.splice(n,1)}_getPlayer(t){let e=this._playersById.get(t);if(!e)throw Kr(t);return e}listen(t,e,n,r){let o=kn(e,"","","");return In(this._getPlayer(t),n,o,r),()=>{}}command(t,e,n,r){if(n=="register"){this.register(t,r[0]);return}if(n=="create"){let l=r[0]||{};this.create(t,e,l);return}let o=this._getPlayer(t);switch(n){case"play":o.play();break;case"pause":o.pause();break;case"reset":o.reset();break;case"restart":o.restart();break;case"finish":o.finish();break;case"init":o.init();break;case"setPosition":o.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(t);break}}},co="ng-animate-queued",El=".ng-animate-queued",xi="ng-animate-disabled",Ml=".ng-animate-disabled",Pl="ng-star-inserted",Ol=".ng-star-inserted",Tl=[],vo={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},Fl={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},Ue="__ng_removed",Zt=class{namespaceId;value;options;get params(){return this.options.params}constructor(t,e=""){this.namespaceId=e;let n=t&&t.hasOwnProperty("value"),r=n?t.value:t;if(this.value=Il(r),n){let o=t,{value:l}=o,d=ji(o,["value"]);this.options=d}else this.options={};this.options.params||(this.options.params={})}absorbOptions(t){let e=t.params;if(e){let n=this.options.params;Object.keys(e).forEach(r=>{n[r]==null&&(n[r]=e[r])})}}},Wt="void",wi=new Zt(Wt),ki=class{id;hostElement;_engine;players=[];_triggers=new Map;_queue=[];_elementListeners=new Map;_hostClassName;constructor(t,e,n){this.id=t,this.hostElement=e,this._engine=n,this._hostClassName="ng-tns-"+t,ke(e,this._hostClassName)}listen(t,e,n,r){if(!this._triggers.has(e))throw $r(n,e);if(n==null||n.length==0)throw Qr(e);if(!kl(n))throw Wr(n,e);let o=Se(this._elementListeners,t,[]),l={name:e,phase:n,callback:r};o.push(l);let d=Se(this._engine.statesByElement,t,new Map);return d.has(e)||(ke(t,Kt),ke(t,Kt+"-"+e),d.set(e,wi)),()=>{this._engine.afterFlush(()=>{let p=o.indexOf(l);p>=0&&o.splice(p,1),this._triggers.has(e)||d.delete(e)})}}register(t,e){return this._triggers.has(t)?!1:(this._triggers.set(t,e),!0)}_getTrigger(t){let e=this._triggers.get(t);if(!e)throw Yr(t);return e}trigger(t,e,n,r=!0){let o=this._getTrigger(e),l=new Xt(this.id,e,t),d=this._engine.statesByElement.get(t);d||(ke(t,Kt),ke(t,Kt+"-"+e),this._engine.statesByElement.set(t,d=new Map));let p=d.get(e),f=new Zt(n,this.id);if(!(n&&n.hasOwnProperty("value"))&&p&&f.absorbOptions(p.options),d.set(e,f),p||(p=wi),!(f.value===Wt)&&p.value===f.value){if(!Ul(p.params,f.params)){let P=[],j=o.matchStyles(p.value,p.params,P),Z=o.matchStyles(f.value,f.params,P);P.length?this._engine.reportError(P):this._engine.afterFlush(()=>{at(t,j),Re(t,Z)})}return}let I=Se(this._engine.playersByElement,t,[]);I.forEach(P=>{P.namespaceId==this.id&&P.triggerName==e&&P.queued&&P.destroy()});let T=o.matchTransition(p.value,f.value,t,f.params),S=!1;if(!T){if(!r)return;T=o.fallbackTransition,S=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:e,transition:T,fromState:p,toState:f,player:l,isFallbackTransition:S}),S||(ke(t,co),l.onStart(()=>{Rt(t,co)})),l.onDone(()=>{let P=this.players.indexOf(l);P>=0&&this.players.splice(P,1);let j=this._engine.playersByElement.get(t);if(j){let Z=j.indexOf(l);Z>=0&&j.splice(Z,1)}}),this.players.push(l),I.push(l),l}deregister(t){this._triggers.delete(t),this._engine.statesByElement.forEach(e=>e.delete(t)),this._elementListeners.forEach((e,n)=>{this._elementListeners.set(n,e.filter(r=>r.name!=t))})}clearElementCache(t){this._engine.statesByElement.delete(t),this._elementListeners.delete(t);let e=this._engine.playersByElement.get(t);e&&(e.forEach(n=>n.destroy()),this._engine.playersByElement.delete(t))}_signalRemovalForInnerTriggers(t,e){let n=this._engine.driver.query(t,$t,!0);n.forEach(r=>{if(r[Ue])return;let o=this._engine.fetchNamespacesByElement(r);o.size?o.forEach(l=>l.triggerLeaveAnimation(r,e,!1,!0)):this.clearElementCache(r)}),this._engine.afterFlushAnimationsDone(()=>n.forEach(r=>this.clearElementCache(r)))}triggerLeaveAnimation(t,e,n,r){let o=this._engine.statesByElement.get(t),l=new Map;if(o){let d=[];if(o.forEach((p,f)=>{if(l.set(f,p.value),this._triggers.has(f)){let b=this.trigger(t,f,Wt,r);b&&d.push(b)}}),d.length)return this._engine.markElementAsRemoved(this.id,t,!0,e,l),n&&Ze(d).onDone(()=>this._engine.processLeaveNode(t)),!0}return!1}prepareLeaveAnimationListeners(t){let e=this._elementListeners.get(t),n=this._engine.statesByElement.get(t);if(e&&n){let r=new Set;e.forEach(o=>{let l=o.name;if(r.has(l))return;r.add(l);let p=this._triggers.get(l).fallbackTransition,f=n.get(l)||wi,b=new Zt(Wt),v=new Xt(this.id,l,t);this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:l,transition:p,fromState:f,toState:b,player:v,isFallbackTransition:!0})})}}removeNode(t,e){let n=this._engine;if(t.childElementCount&&this._signalRemovalForInnerTriggers(t,e),this.triggerLeaveAnimation(t,e,!0))return;let r=!1;if(n.totalAnimations){let o=n.players.length?n.playersByQueriedElement.get(t):[];if(o&&o.length)r=!0;else{let l=t;for(;l=l.parentNode;)if(n.statesByElement.get(l)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(t),r)n.markElementAsRemoved(this.id,t,!1,e);else{let o=t[Ue];(!o||o===vo)&&(n.afterFlush(()=>this.clearElementCache(t)),n.destroyInnerAnimations(t),n._onRemovalComplete(t,e))}}insertNode(t,e){ke(t,this._hostClassName)}drainQueuedTransitions(t){let e=[];return this._queue.forEach(n=>{let r=n.player;if(r.destroyed)return;let o=n.element,l=this._elementListeners.get(o);l&&l.forEach(d=>{if(d.name==n.triggerName){let p=kn(o,n.triggerName,n.fromState.value,n.toState.value);p._data=t,In(n.player,d.phase,p,d.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):e.push(n)}),this._queue=[],e.sort((n,r)=>{let o=n.transition.ast.depCount,l=r.transition.ast.depCount;return o==0||l==0?o-l:this._engine.driver.containsElement(n.element,r.element)?1:-1})}destroy(t){this.players.forEach(e=>e.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,t)}},Di=class{bodyNode;driver;_normalizer;players=[];newHostElements=new Map;playersByElement=new Map;playersByQueriedElement=new Map;statesByElement=new Map;disabledNodes=new Set;totalAnimations=0;totalQueuedPlayers=0;_namespaceLookup={};_namespaceList=[];_flushFns=[];_whenQuietFns=[];namespacesByHostElement=new Map;collectedEnterElements=[];collectedLeaveElements=[];onRemovalComplete=(t,e)=>{};_onRemovalComplete(t,e){this.onRemovalComplete(t,e)}constructor(t,e,n){this.bodyNode=t,this.driver=e,this._normalizer=n}get queuedPlayers(){let t=[];return this._namespaceList.forEach(e=>{e.players.forEach(n=>{n.queued&&t.push(n)})}),t}createNamespace(t,e){let n=new ki(t,e,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,e)?this._balanceNamespaceList(n,e):(this.newHostElements.set(e,n),this.collectEnterElement(e)),this._namespaceLookup[t]=n}_balanceNamespaceList(t,e){let n=this._namespaceList,r=this.namespacesByHostElement;if(n.length-1>=0){let l=!1,d=this.driver.getParentElement(e);for(;d;){let p=r.get(d);if(p){let f=n.indexOf(p);n.splice(f+1,0,t),l=!0;break}d=this.driver.getParentElement(d)}l||n.unshift(t)}else n.push(t);return r.set(e,t),t}register(t,e){let n=this._namespaceLookup[t];return n||(n=this.createNamespace(t,e)),n}registerTrigger(t,e,n){let r=this._namespaceLookup[t];r&&r.register(e,n)&&this.totalAnimations++}destroy(t,e){t&&(this.afterFlush(()=>{}),this.afterFlushAnimationsDone(()=>{let n=this._fetchNamespace(t);this.namespacesByHostElement.delete(n.hostElement);let r=this._namespaceList.indexOf(n);r>=0&&this._namespaceList.splice(r,1),n.destroy(e),delete this._namespaceLookup[t]}))}_fetchNamespace(t){return this._namespaceLookup[t]}fetchNamespacesByElement(t){let e=new Set,n=this.statesByElement.get(t);if(n){for(let r of n.values())if(r.namespaceId){let o=this._fetchNamespace(r.namespaceId);o&&e.add(o)}}return e}trigger(t,e,n,r){if(Bn(e)){let o=this._fetchNamespace(t);if(o)return o.trigger(e,n,r),!0}return!1}insertNode(t,e,n,r){if(!Bn(e))return;let o=e[Ue];if(o&&o.setForRemoval){o.setForRemoval=!1,o.setForMove=!0;let l=this.collectedLeaveElements.indexOf(e);l>=0&&this.collectedLeaveElements.splice(l,1)}if(t){let l=this._fetchNamespace(t);l&&l.insertNode(e,n)}r&&this.collectEnterElement(e)}collectEnterElement(t){this.collectedEnterElements.push(t)}markElementAsDisabled(t,e){e?this.disabledNodes.has(t)||(this.disabledNodes.add(t),ke(t,xi)):this.disabledNodes.has(t)&&(this.disabledNodes.delete(t),Rt(t,xi))}removeNode(t,e,n){if(Bn(e)){let r=t?this._fetchNamespace(t):null;r?r.removeNode(e,n):this.markElementAsRemoved(t,e,!1,n);let o=this.namespacesByHostElement.get(e);o&&o.id!==t&&o.removeNode(e,n)}else this._onRemovalComplete(e,n)}markElementAsRemoved(t,e,n,r,o){this.collectedLeaveElements.push(e),e[Ue]={namespaceId:t,setForRemoval:r,hasAnimation:n,removedBeforeQueried:!1,previousTriggersValues:o}}listen(t,e,n,r,o){return Bn(e)?this._fetchNamespace(t).listen(e,n,r,o):()=>{}}_buildInstruction(t,e,n,r,o){return t.transition.build(this.driver,t.element,t.fromState.value,t.toState.value,n,r,t.fromState.options,t.toState.options,e,o)}destroyInnerAnimations(t){let e=this.driver.query(t,$t,!0);e.forEach(n=>this.destroyActiveAnimationsForElement(n)),this.playersByQueriedElement.size!=0&&(e=this.driver.query(t,Un,!0),e.forEach(n=>this.finishActiveQueriedAnimationOnElement(n)))}destroyActiveAnimationsForElement(t){let e=this.playersByElement.get(t);e&&e.forEach(n=>{n.queued?n.markedForDestroy=!0:n.destroy()})}finishActiveQueriedAnimationOnElement(t){let e=this.playersByQueriedElement.get(t);e&&e.forEach(n=>n.finish())}whenRenderingDone(){return new Promise(t=>{if(this.players.length)return Ze(this.players).onDone(()=>t());t()})}processLeaveNode(t){let e=t[Ue];if(e&&e.setForRemoval){if(t[Ue]=vo,e.namespaceId){this.destroyInnerAnimations(t);let n=this._fetchNamespace(e.namespaceId);n&&n.clearElementCache(t)}this._onRemovalComplete(t,e.setForRemoval)}t.classList?.contains(xi)&&this.markElementAsDisabled(t,!1),this.driver.query(t,Ml,!0).forEach(n=>{this.markElementAsDisabled(n,!1)})}flush(t=-1){let e=[];if(this.newHostElements.size&&(this.newHostElements.forEach((n,r)=>this._balanceNamespaceList(n,r)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let n=0;n<this.collectedEnterElements.length;n++){let r=this.collectedEnterElements[n];ke(r,Pl)}if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){let n=[];try{e=this._flushAnimations(n,t)}finally{for(let r=0;r<n.length;r++)n[r]()}}else for(let n=0;n<this.collectedLeaveElements.length;n++){let r=this.collectedLeaveElements[n];this.processLeaveNode(r)}if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(n=>n()),this._flushFns=[],this._whenQuietFns.length){let n=this._whenQuietFns;this._whenQuietFns=[],e.length?Ze(e).onDone(()=>{n.forEach(r=>r())}):n.forEach(r=>r())}}reportError(t){throw Zr(t)}_flushAnimations(t,e){let n=new Yt,r=[],o=new Map,l=[],d=new Map,p=new Map,f=new Map,b=new Set;this.disabledNodes.forEach(C=>{b.add(C);let E=this.driver.query(C,El,!0);for(let M=0;M<E.length;M++)b.add(E[M])});let v=this.bodyNode,I=Array.from(this.statesByElement.keys()),T=po(I,this.collectedEnterElements),S=new Map,P=0;T.forEach((C,E)=>{let M=_i+P++;S.set(E,M),C.forEach(N=>ke(N,M))});let j=[],Z=new Set,ee=new Set;for(let C=0;C<this.collectedLeaveElements.length;C++){let E=this.collectedLeaveElements[C],M=E[Ue];M&&M.setForRemoval&&(j.push(E),Z.add(E),M.hasAnimation?this.driver.query(E,Ol,!0).forEach(N=>Z.add(N)):ee.add(E))}let ue=new Map,ie=po(I,Array.from(Z));ie.forEach((C,E)=>{let M=Rn+P++;ue.set(E,M),C.forEach(N=>ke(N,M))}),t.push(()=>{T.forEach((C,E)=>{let M=S.get(E);C.forEach(N=>Rt(N,M))}),ie.forEach((C,E)=>{let M=ue.get(E);C.forEach(N=>Rt(N,M))}),j.forEach(C=>{this.processLeaveNode(C)})});let ht=[],Ne=[];for(let C=this._namespaceList.length-1;C>=0;C--)this._namespaceList[C].drainQueuedTransitions(e).forEach(M=>{let N=M.player,te=M.element;if(ht.push(N),this.collectedEnterElements.length){let se=te[Ue];if(se&&se.setForMove){if(se.previousTriggersValues&&se.previousTriggersValues.has(M.triggerName)){let ct=se.previousTriggersValues.get(M.triggerName),Te=this.statesByElement.get(M.element);if(Te&&Te.has(M.triggerName)){let Jt=Te.get(M.triggerName);Jt.value=ct,Te.set(M.triggerName,Jt)}}N.destroy();return}}let ze=!v||!this.driver.containsElement(v,te),Me=ue.get(te),Xe=S.get(te),H=this._buildInstruction(M,n,Xe,Me,ze);if(H.errors&&H.errors.length){Ne.push(H);return}if(ze){N.onStart(()=>at(te,H.fromStyles)),N.onDestroy(()=>Re(te,H.toStyles)),r.push(N);return}if(M.isFallbackTransition){N.onStart(()=>at(te,H.fromStyles)),N.onDestroy(()=>Re(te,H.toStyles)),r.push(N);return}let Bi=[];H.timelines.forEach(se=>{se.stretchStartingKeyframe=!0,this.disabledNodes.has(se.element)||Bi.push(se)}),H.timelines=Bi,n.append(te,H.timelines);let So={instruction:H,player:N,element:te};l.push(So),H.queriedElements.forEach(se=>Se(d,se,[]).push(N)),H.preStyleProps.forEach((se,ct)=>{if(se.size){let Te=p.get(ct);Te||p.set(ct,Te=new Set),se.forEach((Jt,Jn)=>Te.add(Jn))}}),H.postStyleProps.forEach((se,ct)=>{let Te=f.get(ct);Te||f.set(ct,Te=new Set),se.forEach((Jt,Jn)=>Te.add(Jn))})});if(Ne.length){let C=[];Ne.forEach(E=>{C.push(Xr(E.triggerName,E.errors))}),ht.forEach(E=>E.destroy()),this.reportError(C)}let pe=new Map,be=new Map;l.forEach(C=>{let E=C.element;n.has(E)&&(be.set(E,E),this._beforeAnimationBuild(C.player.namespaceId,C.instruction,pe))}),r.forEach(C=>{let E=C.element;this._getPreviousPlayers(E,!1,C.namespaceId,C.triggerName,null).forEach(N=>{Se(pe,E,[]).push(N),N.destroy()})});let st=j.filter(C=>fo(C,p,f)),_t=new Map;uo(_t,this.driver,ee,f,Ie).forEach(C=>{fo(C,p,f)&&st.push(C)});let lt=new Map;T.forEach((C,E)=>{uo(lt,this.driver,new Set(C),p,At)}),st.forEach(C=>{let E=_t.get(C),M=lt.get(C);_t.set(C,new Map([...E?.entries()??[],...M?.entries()??[]]))});let Xn=[],Li=[],Vi={};l.forEach(C=>{let{element:E,player:M,instruction:N}=C;if(n.has(E)){if(b.has(E)){M.onDestroy(()=>Re(E,N.toStyles)),M.disabled=!0,M.overrideTotalTime(N.totalTime),r.push(M);return}let te=Vi;if(be.size>1){let Me=E,Xe=[];for(;Me=Me.parentNode;){let H=be.get(Me);if(H){te=H;break}Xe.push(Me)}Xe.forEach(H=>be.set(H,te))}let ze=this._buildAnimation(M.namespaceId,N,pe,o,lt,_t);if(M.setRealPlayer(ze),te===Vi)Xn.push(M);else{let Me=this.playersByElement.get(te);Me&&Me.length&&(M.parentPlayer=Ze(Me)),r.push(M)}}else at(E,N.fromStyles),M.onDestroy(()=>Re(E,N.toStyles)),Li.push(M),b.has(E)&&r.push(M)}),Li.forEach(C=>{let E=o.get(C.element);if(E&&E.length){let M=Ze(E);C.setRealPlayer(M)}}),r.forEach(C=>{C.parentPlayer?C.syncPlayerEvents(C.parentPlayer):C.destroy()});for(let C=0;C<j.length;C++){let E=j[C],M=E[Ue];if(Rt(E,Rn),M&&M.hasAnimation)continue;let N=[];if(d.size){let ze=d.get(E);ze&&ze.length&&N.push(...ze);let Me=this.driver.query(E,Un,!0);for(let Xe=0;Xe<Me.length;Xe++){let H=d.get(Me[Xe]);H&&H.length&&N.push(...H)}}let te=N.filter(ze=>!ze.destroyed);te.length?Dl(this,E,te):this.processLeaveNode(E)}return j.length=0,Xn.forEach(C=>{this.players.push(C),C.onDone(()=>{C.destroy();let E=this.players.indexOf(C);this.players.splice(E,1)}),C.play()}),Xn}afterFlush(t){this._flushFns.push(t)}afterFlushAnimationsDone(t){this._whenQuietFns.push(t)}_getPreviousPlayers(t,e,n,r,o){let l=[];if(e){let d=this.playersByQueriedElement.get(t);d&&(l=d)}else{let d=this.playersByElement.get(t);if(d){let p=!o||o==Wt;d.forEach(f=>{f.queued||!p&&f.triggerName!=r||l.push(f)})}}return(n||r)&&(l=l.filter(d=>!(n&&n!=d.namespaceId||r&&r!=d.triggerName))),l}_beforeAnimationBuild(t,e,n){let r=e.triggerName,o=e.element,l=e.isRemovalTransition?void 0:t,d=e.isRemovalTransition?void 0:r;for(let p of e.timelines){let f=p.element,b=f!==o,v=Se(n,f,[]);this._getPreviousPlayers(f,b,l,d,e.toState).forEach(T=>{let S=T.getRealPlayer();S.beforeDestroy&&S.beforeDestroy(),T.destroy(),v.push(T)})}at(o,e.fromStyles)}_buildAnimation(t,e,n,r,o,l){let d=e.triggerName,p=e.element,f=[],b=new Set,v=new Set,I=e.timelines.map(S=>{let P=S.element;b.add(P);let j=P[Ue];if(j&&j.removedBeforeQueried)return new Qe(S.duration,S.delay);let Z=P!==p,ee=Rl((n.get(P)||Tl).map(pe=>pe.getRealPlayer())).filter(pe=>{let be=pe;return be.element?be.element===P:!1}),ue=o.get(P),ie=l.get(P),ht=ui(this._normalizer,S.keyframes,ue,ie),Ne=this._buildPlayer(S,ht,ee);if(S.subTimeline&&r&&v.add(P),Z){let pe=new Xt(t,d,P);pe.setRealPlayer(Ne),f.push(pe)}return Ne});f.forEach(S=>{Se(this.playersByQueriedElement,S.element,[]).push(S),S.onDone(()=>Al(this.playersByQueriedElement,S.element,S))}),b.forEach(S=>ke(S,bi));let T=Ze(I);return T.onDestroy(()=>{b.forEach(S=>Rt(S,bi)),Re(p,e.toStyles)}),v.forEach(S=>{Se(r,S,[]).push(T)}),T}_buildPlayer(t,e,n){return e.length>0?this.driver.animate(t.element,e,t.duration,t.delay,t.easing,n):new Qe(t.duration,t.delay)}},Xt=class{namespaceId;triggerName;element;_player=new Qe;_containsRealPlayer=!1;_queuedCallbacks=new Map;destroyed=!1;parentPlayer=null;markedForDestroy=!1;disabled=!1;queued=!0;totalTime=0;constructor(t,e,n){this.namespaceId=t,this.triggerName=e,this.element=n}setRealPlayer(t){this._containsRealPlayer||(this._player=t,this._queuedCallbacks.forEach((e,n)=>{e.forEach(r=>In(t,n,void 0,r))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(t.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(t){this.totalTime=t}syncPlayerEvents(t){let e=this._player;e.triggerCallback&&t.onStart(()=>e.triggerCallback("start")),t.onDone(()=>this.finish()),t.onDestroy(()=>this.destroy())}_queueEvent(t,e){Se(this._queuedCallbacks,t,[]).push(e)}onDone(t){this.queued&&this._queueEvent("done",t),this._player.onDone(t)}onStart(t){this.queued&&this._queueEvent("start",t),this._player.onStart(t)}onDestroy(t){this.queued&&this._queueEvent("destroy",t),this._player.onDestroy(t)}init(){this._player.init()}hasStarted(){return this.queued?!1:this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(t){this.queued||this._player.setPosition(t)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(t){let e=this._player;e.triggerCallback&&e.triggerCallback(t)}};function Al(i,t,e){let n=i.get(t);if(n){if(n.length){let r=n.indexOf(e);n.splice(r,1)}n.length==0&&i.delete(t)}return n}function Il(i){return i??null}function Bn(i){return i&&i.nodeType===1}function kl(i){return i=="start"||i=="done"}function mo(i,t){let e=i.style.display;return i.style.display=t??"none",e}function uo(i,t,e,n,r){let o=[];e.forEach(p=>o.push(mo(p)));let l=[];n.forEach((p,f)=>{let b=new Map;p.forEach(v=>{let I=t.computeStyle(f,v,r);b.set(v,I),(!I||I.length==0)&&(f[Ue]=Fl,l.push(f))}),i.set(f,b)});let d=0;return e.forEach(p=>mo(p,o[d++])),l}function po(i,t){let e=new Map;if(i.forEach(d=>e.set(d,[])),t.length==0)return e;let n=1,r=new Set(t),o=new Map;function l(d){if(!d)return n;let p=o.get(d);if(p)return p;let f=d.parentNode;return e.has(f)?p=f:r.has(f)?p=n:p=l(f),o.set(d,p),p}return t.forEach(d=>{let p=l(d);p!==n&&e.get(p).push(d)}),e}function ke(i,t){i.classList?.add(t)}function Rt(i,t){i.classList?.remove(t)}function Dl(i,t,e){Ze(e).onDone(()=>i.processLeaveNode(t))}function Rl(i){let t=[];return yo(i,t),t}function yo(i,t){for(let e=0;e<i.length;e++){let n=i[e];n instanceof mt?yo(n.players,t):t.push(n)}}function Ul(i,t){let e=Object.keys(i),n=Object.keys(t);if(e.length!=n.length)return!1;for(let r=0;r<e.length;r++){let o=e[r];if(!t.hasOwnProperty(o)||i[o]!==t[o])return!1}return!0}function fo(i,t,e){let n=e.get(i);if(!n)return!1;let r=t.get(i);return r?n.forEach(o=>r.add(o)):t.set(i,n),e.delete(i),!0}var Ut=class{_driver;_normalizer;_transitionEngine;_timelineEngine;_triggerCache={};onRemovalComplete=(t,e)=>{};constructor(t,e,n){this._driver=e,this._normalizer=n,this._transitionEngine=new Di(t.body,e,n),this._timelineEngine=new Ii(t.body,e,n),this._transitionEngine.onRemovalComplete=(r,o)=>this.onRemovalComplete(r,o)}registerTrigger(t,e,n,r,o){let l=t+"-"+r,d=this._triggerCache[l];if(!d){let p=[],f=[],b=ho(this._driver,o,p,f);if(p.length)throw jr(r,p);d=xl(r,b,this._normalizer),this._triggerCache[l]=d}this._transitionEngine.registerTrigger(e,r,d)}register(t,e){this._transitionEngine.register(t,e)}destroy(t,e){this._transitionEngine.destroy(t,e)}onInsert(t,e,n,r){this._transitionEngine.insertNode(t,e,n,r)}onRemove(t,e,n){this._transitionEngine.removeNode(t,e,n)}disableAnimations(t,e){this._transitionEngine.markElementAsDisabled(t,e)}process(t,e,n,r){if(n.charAt(0)=="@"){let[o,l]=pi(n),d=r;this._timelineEngine.command(o,e,l,d)}else this._transitionEngine.trigger(t,e,n,r)}listen(t,e,n,r,o){if(n.charAt(0)=="@"){let[l,d]=pi(n);return this._timelineEngine.listen(l,e,d,o)}return this._transitionEngine.listen(t,e,n,r,o)}flush(t=-1){this._transitionEngine.flush(t)}get players(){return[...this._transitionEngine.players,...this._timelineEngine.players]}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}afterFlushAnimationsDone(t){this._transitionEngine.afterFlushAnimationsDone(t)}};function Nl(i,t){let e=null,n=null;return Array.isArray(t)&&t.length?(e=Si(t[0]),t.length>1&&(n=Si(t[t.length-1]))):t instanceof Map&&(e=Si(t)),e||n?new zl(i,e,n):null}var zl=(()=>{class i{_element;_startStyles;_endStyles;static initialStylesByElement=new WeakMap;_state=0;_initialStyles;constructor(e,n,r){this._element=e,this._startStyles=n,this._endStyles=r;let o=i.initialStylesByElement.get(e);o||i.initialStylesByElement.set(e,o=new Map),this._initialStyles=o}start(){this._state<1&&(this._startStyles&&Re(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(Re(this._element,this._initialStyles),this._endStyles&&(Re(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(i.initialStylesByElement.delete(this._element),this._startStyles&&(at(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(at(this._element,this._endStyles),this._endStyles=null),Re(this._element,this._initialStyles),this._state=3)}}return i})();function Si(i){let t=null;return i.forEach((e,n)=>{Ll(n)&&(t=t||new Map,t.set(n,e))}),t}function Ll(i){return i==="display"||i==="position"}var Qn=class{element;keyframes;options;_specialStyles;_onDoneFns=[];_onStartFns=[];_onDestroyFns=[];_duration;_delay;_initialized=!1;_finished=!1;_started=!1;_destroyed=!1;_finalKeyframe;_originalOnDoneFns=[];_originalOnStartFns=[];domPlayer;time=0;parentPlayer=null;currentSnapshot=new Map;constructor(t,e,n,r){this.element=t,this.keyframes=e,this.options=n,this._specialStyles=r,this._duration=n.duration,this._delay=n.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;let t=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,t,this.options),this._finalKeyframe=t.length?t[t.length-1]:new Map;let e=()=>this._onFinish();this.domPlayer.addEventListener("finish",e),this.onDestroy(()=>{this.domPlayer.removeEventListener("finish",e)})}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(t){let e=[];return t.forEach(n=>{e.push(Object.fromEntries(n))}),e}_triggerWebAnimation(t,e,n){return t.animate(this._convertKeyframesToObject(e),n)}onStart(t){this._originalOnStartFns.push(t),this._onStartFns.push(t)}onDone(t){this._originalOnDoneFns.push(t),this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(t=>t()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}setPosition(t){this.domPlayer===void 0&&this.init(),this.domPlayer.currentTime=t*this.time}getPosition(){return+(this.domPlayer.currentTime??0)/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){let t=new Map;this.hasStarted()&&this._finalKeyframe.forEach((n,r)=>{r!=="offset"&&t.set(r,this._finished?n:zn(this.element,r))}),this.currentSnapshot=t}triggerCallback(t){let e=t==="start"?this._onStartFns:this._onDoneFns;e.forEach(n=>n()),e.length=0}},Wn=class{validateStyleProperty(t){return!0}validateAnimatableStyleProperty(t){return!0}containsElement(t,e){return fi(t,e)}getParentElement(t){return Dn(t)}query(t,e,n){return gi(t,e,n)}computeStyle(t,e,n){return zn(t,e)}animate(t,e,n,r,o,l=[]){let d=r==0?"both":"forwards",p={duration:n,delay:r,fill:d};o&&(p.easing=o);let f=new Map,b=l.filter(T=>T instanceof Qn);no(n,r)&&b.forEach(T=>{T.currentSnapshot.forEach((S,P)=>f.set(P,S))});let v=eo(e).map(T=>new Map(T));v=io(t,v,f);let I=Nl(t,v);return new Qn(t,v,p,I)}};var jn="@",Co="@.disabled",Yn=class{namespaceId;delegate;engine;_onDestroy;\u0275type=0;constructor(t,e,n,r){this.namespaceId=t,this.delegate=e,this.engine=n,this._onDestroy=r}get data(){return this.delegate.data}destroyNode(t){this.delegate.destroyNode?.(t)}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.engine.afterFlushAnimationsDone(()=>{queueMicrotask(()=>{this.delegate.destroy()})}),this._onDestroy?.()}createElement(t,e){return this.delegate.createElement(t,e)}createComment(t){return this.delegate.createComment(t)}createText(t){return this.delegate.createText(t)}appendChild(t,e){this.delegate.appendChild(t,e),this.engine.onInsert(this.namespaceId,e,t,!1)}insertBefore(t,e,n,r=!0){this.delegate.insertBefore(t,e,n),this.engine.onInsert(this.namespaceId,e,t,r)}removeChild(t,e,n){this.parentNode(e)&&this.engine.onRemove(this.namespaceId,e,this.delegate)}selectRootElement(t,e){return this.delegate.selectRootElement(t,e)}parentNode(t){return this.delegate.parentNode(t)}nextSibling(t){return this.delegate.nextSibling(t)}setAttribute(t,e,n,r){this.delegate.setAttribute(t,e,n,r)}removeAttribute(t,e,n){this.delegate.removeAttribute(t,e,n)}addClass(t,e){this.delegate.addClass(t,e)}removeClass(t,e){this.delegate.removeClass(t,e)}setStyle(t,e,n,r){this.delegate.setStyle(t,e,n,r)}removeStyle(t,e,n){this.delegate.removeStyle(t,e,n)}setProperty(t,e,n){e.charAt(0)==jn&&e==Co?this.disableAnimations(t,!!n):this.delegate.setProperty(t,e,n)}setValue(t,e){this.delegate.setValue(t,e)}listen(t,e,n,r){return this.delegate.listen(t,e,n,r)}disableAnimations(t,e){this.engine.disableAnimations(t,e)}},Ri=class extends Yn{factory;constructor(t,e,n,r,o){super(e,n,r,o),this.factory=t,this.namespaceId=e}setProperty(t,e,n){e.charAt(0)==jn?e.charAt(1)=="."&&e==Co?(n=n===void 0?!0:!!n,this.disableAnimations(t,n)):this.engine.process(this.namespaceId,t,e.slice(1),n):this.delegate.setProperty(t,e,n)}listen(t,e,n,r){if(e.charAt(0)==jn){let o=Vl(t),l=e.slice(1),d="";return l.charAt(0)!=jn&&([l,d]=Bl(l)),this.engine.listen(this.namespaceId,o,l,d,p=>{let f=p._data||-1;this.factory.scheduleListenerCallback(f,n,p)})}return this.delegate.listen(t,e,n,r)}};function Vl(i){switch(i){case"body":return document.body;case"document":return document;case"window":return window;default:return i}}function Bl(i){let t=i.indexOf("."),e=i.substring(0,t),n=i.slice(t+1);return[e,n]}var Zn=class{delegate;engine;_zone;_currentId=0;_microtaskId=1;_animationCallbacksBuffer=[];_rendererCache=new Map;_cdRecurDepth=0;constructor(t,e,n){this.delegate=t,this.engine=e,this._zone=n,e.onRemovalComplete=(r,o)=>{o?.removeChild(null,r)}}createRenderer(t,e){let n="",r=this.delegate.createRenderer(t,e);if(!t||!e?.data?.animation){let f=this._rendererCache,b=f.get(r);if(!b){let v=()=>f.delete(r);b=new Yn(n,r,this.engine,v),f.set(r,b)}return b}let o=e.id,l=e.id+"-"+this._currentId;this._currentId++,this.engine.register(l,t);let d=f=>{Array.isArray(f)?f.forEach(d):this.engine.registerTrigger(o,l,t,f.name,f)};return e.data.animation.forEach(d),new Ri(this,l,r,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){queueMicrotask(()=>{this._microtaskId++})}scheduleListenerCallback(t,e,n){if(t>=0&&t<this._microtaskId){this._zone.run(()=>e(n));return}let r=this._animationCallbacksBuffer;r.length==0&&queueMicrotask(()=>{this._zone.run(()=>{r.forEach(o=>{let[l,d]=o;l(d)}),this._animationCallbacksBuffer=[]})}),r.push([e,n])}end(){this._cdRecurDepth--,this._cdRecurDepth==0&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}componentReplaced(t){this.engine.flush(),this.delegate.componentReplaced?.(t)}};var ql=(()=>{class i extends Ut{constructor(e,n,r){super(e,n,r)}ngOnDestroy(){this.flush()}static \u0275fac=function(n){return new(n||i)(q(qt),q(ft),q(gt))};static \u0275prov=Y({token:i,factory:i.\u0275fac})}return i})();function Gl(){return new qn}function Hl(i,t,e){return new Zn(i,t,e)}var xo=[{provide:gt,useFactory:Gl},{provide:Ut,useClass:ql},{provide:Zi,useFactory:Hl,deps:[rr,Ut,zt]}],Wm=[{provide:ft,useClass:Ui},{provide:ei,useValue:"NoopAnimations"},...xo],Kl=[{provide:ft,useFactory:()=>new Wn},{provide:ei,useFactory:()=>"BrowserAnimations"},...xo];function wo(){return Qi("NgEagerAnimations"),[...Kl]}or(pn,{providers:[dr(br),Ki(cn),ar(sr([vr])),wo(),Er({positionClass:"toast-top-right",timeOut:5e3,closeButton:!0,progressBar:!0,newestOnTop:!0,preventDuplicates:!0})]}).catch(i=>console.error(i));
