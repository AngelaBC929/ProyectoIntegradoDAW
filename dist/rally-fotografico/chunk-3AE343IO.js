import{a as L}from"./chunk-A4WZEE76.js";import{a as q}from"./chunk-A32AXAJB.js";import{b as D,d as I,e as z,f as T,g as V,h as R,u as N}from"./chunk-F5A45TTZ.js";import{$a as k,A as g,L as w,N as l,Na as y,R as _,Ra as E,S,W as b,_ as m,a as O,aa as f,ab as F,ca as e,cb as A,da as t,ea as x,eb as U,ha as M,ja as p,ka as c,qa as n,ua as h,va as C,wa as P,ya as v,z as u}from"./chunk-BWXDRC3P.js";var j=()=>["/mis-rallies"],B=()=>["/mis-fotos"],G=()=>["/faqs"];function Q(s,a){if(s&1){let o=M();e(0,"div",18)(1,"h2"),n(2,"Mis datos"),t(),e(3,"label"),n(4,"Nombre"),t(),e(5,"input",19),P("ngModelChange",function(i){u(o);let d=c(2);return C(d.usuario.name,i)||(d.usuario.name=i),g(i)}),t(),e(6,"label"),n(7,"Apellidos"),t(),e(8,"input",19),P("ngModelChange",function(i){u(o);let d=c(2);return C(d.usuario.lastName,i)||(d.usuario.lastName=i),g(i)}),t(),e(9,"label"),n(10,"Correo Electr\xF3nico"),t(),e(11,"input",20),P("ngModelChange",function(i){u(o);let d=c(2);return C(d.usuario.email,i)||(d.usuario.email=i),g(i)}),t(),e(12,"button",21),p("click",function(){u(o);let i=c(2);return g(i.modificarPerfil())}),n(13,"Guardar cambios"),t()()}if(s&2){let o=c(2);l(5),h("ngModel",o.usuario.name),l(3),h("ngModel",o.usuario.lastName),l(3),h("ngModel",o.usuario.email)}}function Y(s,a){if(s&1&&(e(0,"section",14),b(1,Q,14,3,"div",15),e(2,"div",16)(3,"h2"),n(4,"Subida de Fotos"),t(),e(5,"p"),n(6,"Puedes subir hasta "),e(7,"strong"),n(8,"3 fotos"),t(),n(9," por rally. Aseg\xFArate de que sigan la tem\xE1tica y cumplan las normas."),t(),e(10,"p"),n(11,"Tu foto puede ser "),e(12,"strong"),n(13,"admitida"),t(),n(14,", quedar "),e(15,"strong"),n(16,"pendiente"),t(),n(17," o ser "),e(18,"strong"),n(19,"rechazada"),t(),n(20," tras revisi\xF3n del administrador."),t(),e(21,"p"),n(22,"Podr\xE1s modificar tus fotos mientras no hayas subido las 3 fotos m\xE1ximas al rally y podr\xE1s votar tus fotos favoritas mientras el rally este "),e(23,"strong"),n(24,"activo"),t(),n(25,"."),t(),e(26,"p"),n(27,"Consulta las "),e(28,"a",17),n(29,"FAQs"),t(),n(30," para m\xE1s detalles."),t()()()),s&2){let o=c();l(),m("ngIf",o.usuario)}}function H(s,a){if(s&1&&(e(0,"div",30)(1,"h3"),n(2,"Vista previa:"),t(),x(3,"img",31),t()),s&2){let o=c(2);l(3),m("src",o.imagePreview,w)}}function J(s,a){if(s&1){let o=M();e(0,"div",22)(1,"div",23)(2,"span",24),p("click",function(){u(o);let i=c();return g(i.closeModal())}),n(3,"\xD7"),t(),e(4,"h2"),n(5,"Sube tu foto"),t(),e(6,"form",25),p("ngSubmit",function(){u(o);let i=c();return g(i.onSubmit())}),e(7,"label",26),n(8,"Selecciona una foto:"),t(),e(9,"input",27),p("change",function(i){u(o);let d=c();return g(d.onFileSelected(i))}),t(),b(10,H,4,1,"div",28),e(11,"button",29),n(12,"Subir Foto"),t()()()()}if(s&2){let o=c();l(10),m("ngIf",o.imagePreview),l(),m("disabled",!o.selectedFile)}}var W=class s{constructor(a,o,r,i){this.router=a;this.userService=o;this.photoService=r;this.sweetAlert=i}tabActivo="perfil";usuario=null;tituloFoto="";isModalOpen=!1;selectedFile=null;imagePreview=null;ngOnInit(){let a=localStorage.getItem("userId");a?this.userService.getUserById(+a).subscribe({next:o=>{this.usuario=o},error:o=>{console.error("Error cargando el usuario:",o)}}):this.router.navigate(["/login"])}seleccionarTab(a){this.tabActivo=a}openModal(){console.log("Abriendo el modal"),this.isModalOpen=!0}closeModal(){this.isModalOpen=!1,this.selectedFile=null,this.imagePreview=null}onFileSelected(a){let o=a.target.files[0];if(o){this.selectedFile=o;let r=new FileReader;r.onload=i=>{this.imagePreview=i.target.result},r.readAsDataURL(o)}}onSubmit(){if(this.selectedFile&&this.usuario){let a=this.usuario.id,o=456,r=this.tituloFoto||"Sin t\xEDtulo";this.photoService.uploadPhoto(this.selectedFile,a,o,r).subscribe({next:i=>{console.log("Foto subida con \xE9xito:",i),this.sweetAlert.success("Foto subida correctamente"),this.closeModal()},error:i=>{console.error("Error al subir la foto:",i),this.sweetAlert.error("Error","Error al subir la foto")}})}else alert("Por favor selecciona una foto."),this.sweetAlert.info("Por favor selecciona una foto.")}modificarPerfil(){if(this.usuario){let a=O({},this.usuario);this.userService.updateUser(this.usuario.id,a).subscribe({next:()=>{this.sweetAlert.success("Perfil actualizado correctamente")},error:o=>{this.sweetAlert.error("Error","No se pudo actualizar el perfil")}})}}entrarProximosRallies(){this.router.navigate(["/proximos-rallies"])}entrarRalliesActuales(){this.router.navigate(["/rallies-actuales"])}entrarRalliesPasados(){this.router.navigate(["/rallies-pasados"])}entrarGaleria(){this.router.navigate(["/gallery"],{queryParams:{from:"dashboard"}})}goBackToUserPanel(){this.router.navigate(["user/dashboard"])}static \u0275fac=function(o){return new(o||s)(_(k),_(U),_(L),_(q))};static \u0275cmp=S({type:s,selectors:[["app-dashboard"]],decls:44,vars:18,consts:[[1,"dashboard"],[1,"dashboard-header"],[1,"tabs"],[3,"click"],[3,"routerLink"],[1,"user-dashboard"],[1,"card-container"],[1,"card"],["src","images/carrete.png","alt","carrete",1,"icono-rally-carrete"],[1,"btn-enter",3,"click"],["src","images/camara.png","alt","camara",1,"icono-rally-camara"],["src","images/foto.png","alt","foto",1,"icono-rally-foto"],["class","perfil-container",4,"ngIf"],["id","uploadModal","class","modal",4,"ngIf"],[1,"perfil-container"],["class","perfil-card",4,"ngIf"],[1,"fotos-card"],["routerLink","/faqs"],[1,"perfil-card"],["type","text",3,"ngModelChange","ngModel"],["type","email",3,"ngModelChange","ngModel"],[1,"btn-guardar",3,"click"],["id","uploadModal",1,"modal"],[1,"modal-content"],[1,"close",3,"click"],[3,"ngSubmit"],["for","photoInput"],["type","file","id","photoInput","name","photo","accept","image/*",3,"change"],["id","previewContainer",4,"ngIf"],["type","submit",3,"disabled"],["id","previewContainer"],["alt","Vista previa",3,"src"]],template:function(o,r){o&1&&(e(0,"div",0)(1,"header",1)(2,"h1"),n(3,"Bienvenido a tu Panel de Usuario"),t(),e(4,"nav",2)(5,"button",3),p("click",function(){return r.seleccionarTab("perfil")}),n(6,"Perfil"),t(),e(7,"button",4),n(8,"Mis Rallies"),t(),e(9,"button",4),n(10,"Mis Fotos"),t(),e(11,"button",3),p("click",function(){return r.entrarGaleria()}),n(12,"Galer\xEDa"),t(),e(13,"button",4),n(14,"FAQs"),t()()(),e(15,"div",5)(16,"div",6)(17,"div",7)(18,"h2"),n(19,"Pr\xF3ximos Rallies "),x(20,"img",8),t(),e(21,"p"),n(22,"Participa en los pr\xF3ximos rallies fotogr\xE1ficos que tenemos preparados para ti."),t(),e(23,"button",9),p("click",function(){return r.entrarProximosRallies()}),n(24,"Entrar"),t()(),e(25,"div",7)(26,"h2"),n(27,"Rallies Actuales "),x(28,"img",10),t(),e(29,"p"),n(30,"\xDAnete a los rallies en los que est\xE1s participando actualmente."),t(),e(31,"button",9),p("click",function(){return r.entrarRalliesActuales()}),n(32,"Entrar"),t()(),e(33,"div",7)(34,"h2"),n(35,"Rallies Finalizados "),x(36,"img",11),t(),e(37,"p"),n(38,"Revive los rallies pasados y mira las fotos que tomaste."),t(),e(39,"button",9),p("click",function(){return r.entrarRalliesPasados()}),n(40,"Entrar"),t()()()(),e(41,"main"),b(42,Y,31,1,"section",12),t(),b(43,J,13,2,"div",13),t()),o&2&&(l(5),f("active",r.tabActivo==="perfil"),l(2),f("active",r.tabActivo==="misrallies"),m("routerLink",v(15,j)),l(2),f("active",r.tabActivo==="misfotos"),m("routerLink",v(16,B)),l(2),f("active",r.tabActivo==="gallery"),l(2),f("active",r.tabActivo==="faqs"),m("routerLink",v(17,G)),l(29),m("ngIf",r.tabActivo==="perfil"),l(),m("ngIf",r.isModalOpen))},dependencies:[E,y,N,R,D,I,z,V,T,A,F],styles:[".dashboard[_ngcontent-%COMP%]{font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif;background:url(/images/fondo3.jpg) no-repeat center top;background-size:cover;color:#4b2e05;min-height:90vh;padding:1rem 2rem 3rem}.dashboard-header[_ngcontent-%COMP%]{background-color:#7b4f24;color:#f9f4e6;padding:1.5rem 2rem;border-radius:8px;box-shadow:0 4px 10px #7b4f2480;margin-bottom:1.5rem;-webkit-user-select:none;user-select:none}.dashboard-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0 0 .8rem;font-weight:700;font-size:2rem;text-shadow:1px 1px 4px #3c2608}.tabs[_ngcontent-%COMP%]{display:flex;gap:1rem}.tabs[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:transparent;border:none;color:#e0cda9;font-weight:600;font-size:1rem;padding:.5rem 1rem;border-bottom:3px solid transparent;cursor:pointer;transition:color .3s ease,border-bottom-color .3s ease}.tabs[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{color:#fff6d6}.tabs[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{border-bottom-color:#f2d388;color:#f9f4e6;font-weight:700}.card-container[_ngcontent-%COMP%]{display:flex;gap:2rem;margin-bottom:2rem}.card[_ngcontent-%COMP%]{flex:1;background:#f2d388;padding:1.8rem;border-radius:12px;box-shadow:0 6px 14px #d2a04673;color:#4b2e05;display:flex;flex-direction:column;justify-content:space-between;transition:transform .3s ease;cursor:pointer}.card[_ngcontent-%COMP%]:hover{transform:translateY(-5px);box-shadow:0 10px 20px #d2a04699}.card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{text-align:center;margin-top:-1rem;font-weight:700;font-size:1.4rem;text-shadow:1px 1px 2px #7b4f24}.card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:.8rem 0 1.5rem;font-size:1rem;line-height:1.3}.btn-enter[_ngcontent-%COMP%], .btn-guardar[_ngcontent-%COMP%]{background-color:#7b4f24;color:#f9f4e6;border:none;padding:.6rem 1.4rem;font-size:1rem;font-weight:700;border-radius:8px;transition:background-color .3s ease;cursor:pointer;align-items:center}.btn-enter[_ngcontent-%COMP%]:hover, .btn-guardar[_ngcontent-%COMP%]:hover{background-color:#a06937}.perfil-container[_ngcontent-%COMP%]{display:flex;gap:1.5rem;flex-wrap:nowrap;justify-content:space-between;padding:1rem 0}.perfil-card[_ngcontent-%COMP%], .fotos-card[_ngcontent-%COMP%]{flex:0 0 48%;background:#fdf7e3;border-radius:12px;padding:1rem 1.2rem;box-shadow:0 4px 10px #7b4f2440;color:#4b2e05;display:flex;flex-direction:column;font-size:.95rem}.perfil-card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .fotos-card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-weight:700;margin-bottom:1rem;text-shadow:1px 1px 3px #7b4f24}.perfil-card[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin-top:1rem;font-weight:600;font-size:1rem}.perfil-card[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{margin-top:.4rem;margin-bottom:.2rem;padding:.5rem .7rem;font-size:1rem;border:1.5px solid #d6a643;border-radius:6px;outline:none;transition:border-color .3s ease;color:#4b2e05;background-color:#fef9e7}.perfil-card[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:#b68c2f}.fotos-card[_ngcontent-%COMP%]{flex:0 0 48%;background:#fff9ec;border-radius:14px;padding:2rem;box-shadow:0 6px 14px #d2a04666;color:#4b2e05;display:flex;flex-direction:column;font-size:1.05rem;line-height:1.6;transition:box-shadow .3s ease}.fotos-card[_ngcontent-%COMP%]:hover{box-shadow:0 10px 22px #d2a0468c}.fotos-card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:2rem;font-weight:700;margin-bottom:1.2rem;color:#4b2e05;text-shadow:1px 1px 3px #7b4f24;display:flex;align-items:center;gap:.5rem}.fotos-card[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;padding-left:0}.fotos-card[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{position:relative;padding-left:1.5rem;margin-bottom:1rem;color:#5e3c10;font-size:1rem}.fotos-card[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{margin-top:.5rem;margin-left:1rem;list-style:disc;color:#5e3c10;font-size:.95rem}.fotos-card[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:.3rem;padding-left:1rem}.fotos-card[_ngcontent-%COMP%]   .btn-accion[_ngcontent-%COMP%]{margin-top:auto;align-self:flex-start;background-color:#7b4f24;color:#f9f4e6;padding:.6rem 1.4rem;font-size:1rem;font-weight:700;border:none;border-radius:8px;cursor:pointer;transition:background-color .3s ease;margin-top:2rem}.fotos-card[_ngcontent-%COMP%]   .btn-accion[_ngcontent-%COMP%]:hover{background-color:#a06937}.modal[_ngcontent-%COMP%]{position:fixed;z-index:1000;left:0;top:0;width:100%;height:100%;overflow:auto;background-color:#00000080;display:flex;justify-content:center;align-items:center}.modal-content[_ngcontent-%COMP%]{background-color:#fff9ef;padding:2rem;border:2px solid #7b4f24;border-radius:10px;width:90%;max-width:500px;box-shadow:0 6px 20px #0006;position:relative;color:#4b2e05}.icono-rally-carrete[_ngcontent-%COMP%]{width:85px;height:auto;vertical-align:middle}.icono-rally-foto[_ngcontent-%COMP%]{width:80px;height:auto;margin:0 auto 0 10px;vertical-align:middle}.icono-rally-camara[_ngcontent-%COMP%]{width:85px;height:auto;margin:0 auto 0 10px;vertical-align:middle}.close[_ngcontent-%COMP%]{position:absolute;top:1rem;right:1rem;color:#a4423b;font-size:1.5rem;font-weight:700;cursor:pointer}.close[_ngcontent-%COMP%]:hover{color:#721c24}#previewContainer[_ngcontent-%COMP%]{margin:1rem 0}#previewContainer[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100%;border-radius:6px;border:2px solid #d6a643;box-shadow:0 2px 6px #7b4f244d}@media (max-width: 1024px){.card-container[_ngcontent-%COMP%]{flex-direction:column;gap:1.5rem}.perfil-container[_ngcontent-%COMP%]{flex-direction:column;gap:1rem}.perfil-card[_ngcontent-%COMP%], .fotos-card[_ngcontent-%COMP%]{flex:1 1 100%}.dashboard-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.5rem}.tabs[_ngcontent-%COMP%]{flex-wrap:wrap}.tabs[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1 1 45%;margin-bottom:.5rem}}@media (max-width: 600px){.dashboard[_ngcontent-%COMP%], .dashboard-header[_ngcontent-%COMP%]{padding:1rem}.card[_ngcontent-%COMP%]{padding:1.2rem}.card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.2rem}.btn-enter[_ngcontent-%COMP%], .btn-guardar[_ngcontent-%COMP%]{padding:.5rem 1rem;font-size:.9rem}.fotos-card[_ngcontent-%COMP%]{padding:1.5rem;font-size:.95rem}.icono-rally-carrete[_ngcontent-%COMP%], .icono-rally-camara[_ngcontent-%COMP%], .icono-rally-foto[_ngcontent-%COMP%]{width:50px}}"]})};export{W as DashboardComponent};
